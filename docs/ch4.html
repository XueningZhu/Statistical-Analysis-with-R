<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第4章：描述分析 | 统计分析与R语言（辅助材料）</title>
  <meta name="description" content="第4章：描述分析 | 统计分析与R语言（辅助材料）" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="第4章：描述分析 | 统计分析与R语言（辅助材料）" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="XueningZhu/Statistical-Analysis-with-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第4章：描述分析 | 统计分析与R语言（辅助材料）" />
  
  
  

<meta name="author" content="朱雪宁 &amp; 任怡萌" />


<meta name="date" content="2020-11-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch3.html"/>
<link rel="next" href="ch5.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i>第1章：统计分析与R语言</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i>第2章：R语言中的数据管理与预处理</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#案例引入"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#基本数据类型"><i class="fa fa-check"></i>2.1 基本数据类型</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数值型"><i class="fa fa-check"></i>2.1.1 数值型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#字符型"><i class="fa fa-check"></i>2.1.2 字符型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#逻辑型"><i class="fa fa-check"></i>2.1.3 逻辑型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#因子型数据"><i class="fa fa-check"></i>2.1.4 因子型数据</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据结构"><i class="fa fa-check"></i>2.2 数据结构</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#向量"><i class="fa fa-check"></i>2.2.1 向量</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#矩阵"><i class="fa fa-check"></i>2.2.2 矩阵</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数组"><i class="fa fa-check"></i>2.2.3 数组</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据框"><i class="fa fa-check"></i>2.2.4 数据框</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#列表"><i class="fa fa-check"></i>2.2.5 列表</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据的读入与写出"><i class="fa fa-check"></i>2.3 数据的读入与写出</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#使用键盘输入数据"><i class="fa fa-check"></i>2.3.1 使用键盘输入数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#从带分隔符的文本文件导入数据"><i class="fa fa-check"></i>2.3.2 从带分隔符的文本文件导入数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#导入excel数据"><i class="fa fa-check"></i>2.3.3 导入Excel数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#逐行读入数据"><i class="fa fa-check"></i>2.3.4 逐行读入数据</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据集管理及预处理"><i class="fa fa-check"></i>2.4 数据集管理及预处理</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#了解数据概况"><i class="fa fa-check"></i>2.4.1 了解数据概况</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#变量类型转换"><i class="fa fa-check"></i>2.4.2 变量类型转换</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#时间型数据的操作"><i class="fa fa-check"></i>2.4.3 时间型数据的操作</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据集合并"><i class="fa fa-check"></i>2.4.4 数据集合并</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据缺失异常"><i class="fa fa-check"></i>2.4.5 数据缺失、异常</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#习题答案"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.1"><i class="fa fa-check"></i>题目 2.1</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.2"><i class="fa fa-check"></i>题目 2.2</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.3"><i class="fa fa-check"></i>题目 2.3</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.4实训题目"><i class="fa fa-check"></i>题目 2.4（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.5-实训题目"><i class="fa fa-check"></i>题目 2.5 （实训题目）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i>第3章：基本统计分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#案例引入-1"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#基本描述统计量"><i class="fa fa-check"></i>3.1 基本描述统计量</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#频数统计"><i class="fa fa-check"></i>3.1.1 频数统计</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#均值"><i class="fa fa-check"></i>3.1.2 均值</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#分位数"><i class="fa fa-check"></i>3.1.3 分位数</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#方差和标准差"><i class="fa fa-check"></i>3.1.4 方差和标准差</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#最大值最小值"><i class="fa fa-check"></i>3.1.5 最大值、最小值</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#峰度和偏度"><i class="fa fa-check"></i>3.1.6 峰度和偏度</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#交叉分组下的频数分析"><i class="fa fa-check"></i>3.2 交叉分组下的频数分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#交叉列联表"><i class="fa fa-check"></i>3.2.1 交叉列联表</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#描述统计量的分组统计"><i class="fa fa-check"></i>3.2.2 描述统计量的分组统计</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#习题答案-1"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.1"><i class="fa fa-check"></i>题目 3.1</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.2"><i class="fa fa-check"></i>题目 3.2</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.3"><i class="fa fa-check"></i>题目 3.3</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.4"><i class="fa fa-check"></i>题目 3.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i>第4章：描述分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#案例引入-2"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#统计表格"><i class="fa fa-check"></i>4.1 统计表格</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#变量说明表"><i class="fa fa-check"></i>4.1.1 变量说明表</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#分组汇总统计表格"><i class="fa fa-check"></i>4.1.2 分组汇总统计表格</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#数据可视化基础"><i class="fa fa-check"></i>4.2 数据可视化基础</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#柱状图"><i class="fa fa-check"></i>4.2.2 柱状图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#饼图"><i class="fa fa-check"></i>4.2.3 饼图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#直方图"><i class="fa fa-check"></i>4.2.4 直方图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#折线图"><i class="fa fa-check"></i>4.2.5 折线图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#箱线图"><i class="fa fa-check"></i>4.2.6 箱线图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#散点图"><i class="fa fa-check"></i>4.2.7 散点图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#相关系数图"><i class="fa fa-check"></i>4.2.8 相关系数图</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#数据可视化进阶"><i class="fa fa-check"></i>4.3 数据可视化进阶</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#ggplot2-包"><i class="fa fa-check"></i>4.3.1 ggplot2 包</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#交互可视化"><i class="fa fa-check"></i>4.3.2 交互可视化</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#习题答案-2"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.3实训题目"><i class="fa fa-check"></i>题目 4.3（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.4实训题目"><i class="fa fa-check"></i>题目 4.4（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.5实训题目"><i class="fa fa-check"></i>题目 4.5（实训题目）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html"><i class="fa fa-check"></i>第5章：参数估计与假设检验</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例引入-3"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例一手机续航时间研究"><i class="fa fa-check"></i>案例一：手机续航时间研究</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例二减肥药疗效研究"><i class="fa fa-check"></i>案例二：减肥药疗效研究</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例三红楼梦作者争议"><i class="fa fa-check"></i>案例三：红楼梦作者争议</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#参数估计"><i class="fa fa-check"></i>5.2 参数估计</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#矩估计"><i class="fa fa-check"></i>5.2.1 矩估计</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#极大似然估计"><i class="fa fa-check"></i>5.2.2 极大似然估计</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#区间估计"><i class="fa fa-check"></i>5.2.3 区间估计</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#假设检验"><i class="fa fa-check"></i>5.3 假设检验</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#习题答案-3"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#题目-5.2"><i class="fa fa-check"></i>题目 5.2</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#题目-5.3"><i class="fa fa-check"></i>题目 5.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i>第6章：线性回归</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#案例引入-4"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#岗位学历要求对薪资水平是否有影响"><i class="fa fa-check"></i>岗位学历要求对薪资水平是否有影响</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#python和spss要求与否对薪资水平是否有影响"><i class="fa fa-check"></i>Python和SPSS要求与否对薪资水平是否有影响</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#模型实现"><i class="fa fa-check"></i>6.9 模型实现</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#实例分析"><i class="fa fa-check"></i>6.9.2 实例分析</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#习题答案-4"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#案例背景"><i class="fa fa-check"></i>案例背景</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.2"><i class="fa fa-check"></i>题目 6.2</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.3"><i class="fa fa-check"></i>题目 6.3</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.4"><i class="fa fa-check"></i>题目 6.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html"><i class="fa fa-check"></i>第7章：逻辑回归</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#案例引入-5"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#申请结果分布"><i class="fa fa-check"></i>申请结果分布</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#最热门的top10申请学校"><i class="fa fa-check"></i>最热门的top10申请学校</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#申请gpa对于结果的影响"><i class="fa fa-check"></i>申请GPA对于结果的影响</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#托福成绩对于申请结果的影响"><i class="fa fa-check"></i>托福成绩对于申请结果的影响</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#硬件条件对于不同学位申请的影响"><i class="fa fa-check"></i>硬件条件对于不同学位申请的影响</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#实例分析-1"><i class="fa fa-check"></i>7.5 实例分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#模型建立与选择"><i class="fa fa-check"></i>模型建立与选择</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#模型预测-1"><i class="fa fa-check"></i>模型预测</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#习题答案-5"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#案例背景-1"><i class="fa fa-check"></i>案例背景</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#题目-7.2"><i class="fa fa-check"></i>题目 7.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html"><i class="fa fa-check"></i>第8章：降维分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#案例引入-6"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#主成分分析"><i class="fa fa-check"></i>8.1 主成分分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#读入数据并绘制相关系数矩阵"><i class="fa fa-check"></i>读入数据并绘制相关系数矩阵</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#选择主成分个数"><i class="fa fa-check"></i>选择主成分个数</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#提取主成分与结果解读"><i class="fa fa-check"></i>提取主成分与结果解读</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#计算主成分得分"><i class="fa fa-check"></i>计算主成分得分</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#因子分析"><i class="fa fa-check"></i>8.2 因子分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#选择合适的公共因子数目"><i class="fa fa-check"></i>选择合适的公共因子数目</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#提取公共因子"><i class="fa fa-check"></i>提取公共因子</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#正交旋转"><i class="fa fa-check"></i>正交旋转</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#计算因子得分"><i class="fa fa-check"></i>计算因子得分</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#因子分析结果可视化选做"><i class="fa fa-check"></i>因子分析结果可视化（选做）</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#习题答案-6"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.1"><i class="fa fa-check"></i>题目 8.1</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.2"><i class="fa fa-check"></i>题目 8.2</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.3"><i class="fa fa-check"></i>题目 8.3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">统计分析与R语言（辅助材料）</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch4" class="section level1 unnumbered">
<h1>第4章：描述分析</h1>
<div id="案例引入-2" class="section level2 unnumbered">
<h2>案例引入</h2>
<p>近年来，网络小说市场正在逐渐膨胀。据相关数据表明，到2020年，我国网络文学市场规模达到120亿元，网络文学用户规模达到3.33亿，移动阅读用户规模达到3.04亿。网络小说市场迎来了前所未有的发展机遇。</p>
<p>以网络小说作者天蚕土豆的作品《斗破苍穹》以及忘语的《凡人修仙传》等为首的一系列网络小说，近些年来尤为火爆，它们在某平台上的点击量直破1亿大关。究竟有哪些因素使得这些小说如此之受欢迎？本章使用一个网络小说数据集作为案例进行简单的描述分析，来探究这一问题。</p>
<p>本章使用一个网络小说数据集作为案例数据集。该数据集收集了1549部排名较高的网络小说信息，其中包含《斗破苍穹》、《凡人修仙传》等多部热门小说的类型介绍、点击数、评分等信息。数据变量说明表如下所示：</p>
<table>
<thead>
<tr class="header">
<th align="left">变量类型</th>
<th align="left">变量名</th>
<th align="left">详细说明</th>
<th align="left">取值范围</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">因变量</td>
<td align="left">总点击数</td>
<td align="left">定量，单位：次</td>
<td align="left">12920-149800000</td>
</tr>
<tr class="even">
<td align="left">自变量</td>
<td align="left">小说信息</td>
<td align="left">小说名称</td>
<td align="left">定性</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">作者</td>
<td align="left">定性</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">小说类型</td>
<td align="left">定性，13个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">总字数</td>
<td align="left">定量，单位：个</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">小说性质</td>
<td align="left">定性，2个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">写作进程</td>
<td align="left">定性，11个水平</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">授权状态</td>
<td align="left">定性，8个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">更新时间</td>
<td align="left">单位：年／月／日／时／分</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">内容简介</td>
<td align="left">定性，1549个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">会员评价</td>
<td align="left">评分</td>
<td align="left">定量，单位：分</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">会员周点击数</td>
<td align="left">定量，单位：次</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">评论数</td>
<td align="left">定量，单位：个</td>
</tr>
</tbody>
</table>
<p>这里我们关心的核心指标是小说点击数，它对于小说而言至关重要，代表了一部小说的热度。在所收集的小说数据集中，最大值《斗破苍穹》的点击数接近1.5亿，而最小值《鸣的大冒险》仅有不到1.3万，可谓差距悬殊。那么，如何分析哪些因素与小说点击数息息相关？想要探索这个问题的答案，需要对数据进行描述分析。</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="ch4.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 数据准备 </span><span class="al">###</span></span>
<span id="cb374-2"><a href="ch4.html#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 清空工作空间</span></span>
<span id="cb374-3"><a href="ch4.html#cb374-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb374-4"><a href="ch4.html#cb374-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 载入相关包及设定路径</span></span>
<span id="cb374-5"><a href="ch4.html#cb374-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb374-6"><a href="ch4.html#cb374-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb374-7"><a href="ch4.html#cb374-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb374-8"><a href="ch4.html#cb374-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb374-9"><a href="ch4.html#cb374-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb374-10"><a href="ch4.html#cb374-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb374-11"><a href="ch4.html#cb374-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb374-12"><a href="ch4.html#cb374-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb374-13"><a href="ch4.html#cb374-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb374-14"><a href="ch4.html#cb374-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;zh_cn.utf-8&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;zh_cn.utf-8/zh_cn.utf-8/zh_cn.utf-8/C/zh_cn.utf-8/en_US.UTF-8&quot;</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="ch4.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 读入数据</span></span>
<span id="cb376-2"><a href="ch4.html#cb376-2" aria-hidden="true" tabindex="-1"></a>novel <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&#39;./data/novel.csv&#39;</span>, <span class="at">fileEncoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb376-3"><a href="ch4.html#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据查看与异常处理</span></span>
<span id="cb376-4"><a href="ch4.html#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(novel)</span></code></pre></div>
<pre><code>##   人气排序 小说名称     作者 小说类型 总点击数 会员周点击数  总字数 评论数
## 1        1 一念永恒     耳根 仙侠小说  4383898        10691 1155534 435429
## 2        2 斗战狂潮 骷髅精灵 仙侠小说  1678379        36587  422116  23159
## 3        3     天影     萧鼎 仙侠小说  1248708        32019  373763  25253
## 4        4 不朽凡人 鹅是老五 仙侠小说  2457382         9610  995669 146715
## 5        5 玄界之门     忘语 仙侠小说  3736897         6709 1784999 238113
## 6        6 龙王传说 唐家三少 玄幻小说  2968846         3080 1552654 293934
##   评分 小说性质 写作进程 授权状态         更新时间
## 1  9.8 公众作品   连载中 Ａ级签约 2016/10/23 11:50
## 2 10.0 公众作品   连载中 Ａ级签约 2016/10/22 17:05
## 3  9.8 公众作品   连载中 Ａ级签约 2016/10/23 10:40
## 4  9.9 公众作品   连载中 Ａ级签约 2016/10/22 20:50
## 5  9.8 公众作品 新书上传 Ａ级签约 2016/10/23 10:15
## 6  9.8 公众作品 新书上传 Ａ级签约  2016/10/23 7:00
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                     内容简介
## 1                                                                                                                                                                                                                                                                                                               　　一念成沧海，一念化桑田。一念斩千魔，一念诛万仙。???     唯我念……永恒???     这是耳根继《仙逆》《求魔》《我欲封天》后，创作的第四部长篇小说《一念永恒》
## 2 　　双月当空，无限可能的英魂世界 \n???     孤寂黑暗，神秘古怪的嬉命小丑 \n???     百城联邦，三大帝国，异族横行，魂兽霸幽 \n???     这是一个英雄辈出的年代，人类卧薪尝胆重掌地球主权，孕育着进军高纬度的野望！ \n???     重点是……二年级的废柴学长王同学，如何使用嬉命轮盘，撬动整个世界，学妹们，请注意，学长来了！！！ \n???     斗战一群：21222419（两千人战力群）\n???     斗战二群：12962047 \n???     骷髅的微信公共号：kuloujingling00 \n???     新浪微博：骷髅精灵
## 3                                                                         　　阴阳分天地，五行定乾坤。\n???     天穹之下岁月沧桑的中土神州，正是仙道昌盛的时代，亿万生灵欣欣向荣。\n???     纵横千万里间，总有人间一幕幕悲欢离合，在恢弘长生的仙道中上演着。\n???     有光便有暗，天穹之下光辉之中，仍有沉默的影子悄然前行着……\n???     新书上线！精彩万分！请各位书友多多投票支持！另外，大家可以添加微信公众号zhuxianxiaoding（诛仙萧鼎），QQ官方群 176378308 进行交流。
## 4                                                                                                                                                                                                                                                                                                                                              　　在这里，拥有灵根才能修仙，所有凡根注定只是凡人。\n???     莫无忌，只有凡根，一介凡人！\n???     是就此老去，还是不甘？???
## 5                                                                                                                                                                                                                         　　天降神物！异血附体！???     群仙惊惧！万魔退避！???     一名从东洲大陆走出的少年。???     一具生死相依的红粉骷髅。???     一个立志成为至强者的故事。???     一段叱咤星河，大闹三界的传说。???     忘语新书，已完本《凡人修仙传》》《魔天记》。
## 6                                                                                                                                    　　伴随着魂导科技的进步，斗罗大陆上的人类征服了海洋，又发现了两片大陆。魂兽也随着人类魂师的猎杀无度走向灭亡，沉睡无数年的魂兽之王在星斗大森林最后的净土苏醒，它要带领仅存的族人，向人类复仇！\n???     唐舞麟立志要成为一名强大的魂师，可当武魂觉醒时，苏醒的，却是……\n???     旷世之才，龙王之争，我们的龙王传说，将由此开始。\n???</code></pre>
</div>
<div id="统计表格" class="section level2 unnumbered">
<h2>4.1 统计表格</h2>
<div id="变量说明表" class="section level3 unnumbered">
<h3>4.1.1 变量说明表</h3>
<p>对于定性变量，列示其主要水平及对应频数；对于定量变量，关注其取值范围、最大值、最小值、中位数等描述性统计量。这些变量描述指标在R语言中可以通过summary()函数直接获取。</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="ch4.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 对小说数据的若干列使用summary()函数</span></span>
<span id="cb378-2"><a href="ch4.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(novel[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<pre><code>##    小说名称             作者             小说类型        
##  Length:1549        Length:1549        Length:1549       
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character</code></pre>
</div>
<div id="分组汇总统计表格" class="section level3 unnumbered">
<h3>4.1.2 分组汇总统计表格</h3>
<p>分组统计表格按照各个类别进行汇总，描述类别内部各个变量的特征。通过这种方式，可以比较各个类别之间的差异，输出所关心的汇总报表。</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="ch4.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 利用group_by()函数对小说按照小说类型分类</span></span>
<span id="cb380-2"><a href="ch4.html#cb380-2" aria-hidden="true" tabindex="-1"></a>novel.小说类型 <span class="ot">=</span> novel <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(小说类型)</span>
<span id="cb380-3"><a href="ch4.html#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 制作分组统计表</span></span>
<span id="cb380-4"><a href="ch4.html#cb380-4" aria-hidden="true" tabindex="-1"></a>novel.小说类型 <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(平均评分 <span class="ot">=</span> <span class="fu">mean</span>(评分), 最大评论数 <span class="ot">=</span> <span class="fu">max</span>(评论数))</span></code></pre></div>
<pre><code>## # A tibble: 13 x 3
##    小说类型   平均评分 最大评论数
##    &lt;chr&gt;         &lt;dbl&gt;      &lt;int&gt;
##  1 都市小说       9.13     183799
##  2 二次元小说     8.22      23428
##  3 军事小说       9.38      92845
##  4 科幻小说       8.93     369417
##  5 历史小说       9.01     222505
##  6 灵异小说       9.1       17602
##  7 奇幻小说       9.02     231883
##  8 体育小说       9.33      27316
##  9 武侠小说       8.13     196111
## 10 仙侠小说       8.95     604560
## 11 玄幻小说       9.12     569756
## 12 游戏小说       9.22     237676
## 13 职场小说       8.73     398307</code></pre>
</div>
</div>
<div id="数据可视化基础" class="section level2 unnumbered">
<h2>4.2 数据可视化基础</h2>
<p>统计表格是使用表格的形式展示汇总的统计指标，但从直观性而言，使用统计图形则更为合适。基本统计图形包括柱状图、饼图、箱线图、散点图、折线图和直方图。</p>
<div id="柱状图" class="section level3 unnumbered">
<h3>4.2.2 柱状图</h3>
<p>柱状图（barplot）是用柱子高低来表示取值大小的一种统计图形。常见的柱状图有频数柱状图及均值柱状图。频数柱状图展示的是定性变量各水平的频数统计，柱子高度代表每个水平频数大小。</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="ch4.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 统计小说类型频数</span></span>
<span id="cb382-2"><a href="ch4.html#cb382-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">table</span>(novel<span class="sc">$</span>小说类型)</span>
<span id="cb382-3"><a href="ch4.html#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 对频数排序</span></span>
<span id="cb382-4"><a href="ch4.html#cb382-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>a[<span class="fu">order</span>(a,<span class="at">decreasing =</span> T)]</span>
<span id="cb382-5"><a href="ch4.html#cb382-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制柱状图</span></span>
<span id="cb382-6"><a href="ch4.html#cb382-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>,<span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb382-7"><a href="ch4.html#cb382-7" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(a[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],<span class="at">names.arg =</span> <span class="fu">names</span>(a)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],<span class="at">family=</span><span class="st">&quot;STXihei&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;频数&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;grey&quot;</span>))</span>
<span id="cb382-8"><a href="ch4.html#cb382-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;各类型小说频数分布柱状图&quot;</span>,<span class="at">family=</span><span class="st">&quot;STXihei&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot1-1.png" width="672" />
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5mjdaslj311c0qo75z.jpg" /></p>
<p>柱状图并不仅用于展现频数，也可以展示按照分组划分后各类别的均值等指标。这种柱状图称为均值柱状图。</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="ch4.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 求得各类型小说平均点击数的均值</span></span>
<span id="cb383-2"><a href="ch4.html#cb383-2" aria-hidden="true" tabindex="-1"></a>means<span class="ot">&lt;-</span>novel<span class="sc">%&gt;%</span></span>
<span id="cb383-3"><a href="ch4.html#cb383-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(小说类型)<span class="sc">%&gt;%</span></span>
<span id="cb383-4"><a href="ch4.html#cb383-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(总点击数<span class="sc">/</span><span class="dv">10000</span>))<span class="sc">%&gt;%</span></span>
<span id="cb383-5"><a href="ch4.html#cb383-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean))</span>
<span id="cb383-6"><a href="ch4.html#cb383-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>,<span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb383-7"><a href="ch4.html#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制均值柱状图</span></span>
<span id="cb383-8"><a href="ch4.html#cb383-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(means<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">names.arg=</span>means<span class="sc">$</span>小说类型[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],<span class="at">family=</span><span class="st">&quot;STXihei&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;总点击数(万次)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;grey&quot;</span>))</span>
<span id="cb383-9"><a href="ch4.html#cb383-9" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;各类型小说平均总点击数&quot;</span>,<span class="at">family=</span><span class="st">&quot;STXihei&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot2-1.png" width="672" /></p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="ch4.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">200</span>)</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zk27nmj311c0qoq4s.jpg" /></p>
<p>对两个或多个定性变量绘制柱状图可使用分组柱状图或堆积柱状图来展现。</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="ch4.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建绘图所需数据矩阵d</span></span>
<span id="cb385-2"><a href="ch4.html#cb385-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> novel<span class="sc">%&gt;%</span><span class="fu">group_by</span>(小说类型, 小说性质)<span class="sc">%&gt;%</span></span>
<span id="cb385-3"><a href="ch4.html#cb385-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb385-4"><a href="ch4.html#cb385-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(小说性质,count)<span class="sc">%&gt;%</span></span>
<span id="cb385-5"><a href="ch4.html#cb385-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>V1)<span class="sc">%&gt;%</span></span>
<span id="cb385-6"><a href="ch4.html#cb385-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(公众作品))</span>
<span id="cb385-7"><a href="ch4.html#cb385-7" aria-hidden="true" tabindex="-1"></a>topics <span class="ot">=</span> d<span class="sc">$</span>小说类型[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb385-8"><a href="ch4.html#cb385-8" aria-hidden="true" tabindex="-1"></a>artwork_type <span class="ot">=</span> <span class="fu">colnames</span>(d)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb385-9"><a href="ch4.html#cb385-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 选取前五类小说</span></span>
<span id="cb385-10"><a href="ch4.html#cb385-10" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(<span class="fu">t</span>(d[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,])[<span class="sc">-</span><span class="dv">1</span>,]),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb385-11"><a href="ch4.html#cb385-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 对列命名</span></span>
<span id="cb385-12"><a href="ch4.html#cb385-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(d) <span class="ot">=</span> topics</span>
<span id="cb385-13"><a href="ch4.html#cb385-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 对行命名</span></span>
<span id="cb385-14"><a href="ch4.html#cb385-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(d) <span class="ot">=</span> artwork_type</span>
<span id="cb385-15"><a href="ch4.html#cb385-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-16"><a href="ch4.html#cb385-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制分组柱状图(beside = T)</span></span>
<span id="cb385-17"><a href="ch4.html#cb385-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>,<span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb385-18"><a href="ch4.html#cb385-18" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(d, <span class="at">beside =</span> T, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;grey&quot;</span>), <span class="at">ylab =</span> <span class="st">&quot;频数&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">500</span>))</span>
<span id="cb385-19"><a href="ch4.html#cb385-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb385-20"><a href="ch4.html#cb385-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">rownames</span>(d), <span class="at">fill =</span>  <span class="fu">c</span>(<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;grey&quot;</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb385-21"><a href="ch4.html#cb385-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制堆积柱状图(beside = F)</span></span>
<span id="cb385-22"><a href="ch4.html#cb385-22" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(d, <span class="at">beside =</span> F, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;grey&quot;</span>), <span class="at">ylab =</span> <span class="st">&quot;频数&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">700</span>))</span>
<span id="cb385-23"><a href="ch4.html#cb385-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb385-24"><a href="ch4.html#cb385-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">rownames</span>(d), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;gold&quot;</span>, <span class="st">&quot;grey&quot;</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot3-1.png" width="672" />
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zjyyl6j311c0qomz4.jpg" /></p>
</div>
<div id="饼图" class="section level3 unnumbered">
<h3>4.2.3 饼图</h3>
<p>饼图（pie），是用圆形及圆内扇形的度数来表示数值大小的图形，主要用于表示总体中各组成部分所占的比例。</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="ch4.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 将小说类型进行简要合并</span></span>
<span id="cb386-2"><a href="ch4.html#cb386-2" aria-hidden="true" tabindex="-1"></a>novel<span class="sc">$</span><span class="st">&#39;小说类别&#39;</span> <span class="ot">=</span> <span class="st">&quot;其他&quot;</span></span>
<span id="cb386-3"><a href="ch4.html#cb386-3" aria-hidden="true" tabindex="-1"></a>novel<span class="sc">$</span><span class="st">&#39;小说类别&#39;</span>[novel<span class="sc">$</span>小说类型 <span class="sc">==</span> <span class="st">&quot;都市小说&quot;</span> <span class="sc">|</span> novel<span class="sc">$</span>小说类型 <span class="sc">==</span> <span class="st">&quot;职场小说&quot;</span>] <span class="ot">=</span> <span class="st">&quot;都市类小说&quot;</span></span>
<span id="cb386-4"><a href="ch4.html#cb386-4" aria-hidden="true" tabindex="-1"></a>novel<span class="sc">$</span><span class="st">&#39;小说类别&#39;</span>[novel<span class="sc">$</span>小说类型 <span class="sc">==</span> <span class="st">&quot;科幻小说&quot;</span> <span class="sc">|</span> novel<span class="sc">$</span>小说类型 <span class="sc">==</span> <span class="st">&quot;玄幻小说&quot;</span> <span class="sc">|</span> novel<span class="sc">$</span>小说类型 <span class="sc">==</span> <span class="st">&quot;奇幻小说&quot;</span>] <span class="ot">=</span> <span class="st">&quot;幻想类小说&quot;</span></span>
<span id="cb386-5"><a href="ch4.html#cb386-5" aria-hidden="true" tabindex="-1"></a>novel<span class="sc">$</span><span class="st">&#39;小说类别&#39;</span>[novel<span class="sc">$</span>小说类型 <span class="sc">==</span> <span class="st">&quot;武侠小说&quot;</span> <span class="sc">|</span> novel<span class="sc">$</span>小说类型 <span class="sc">==</span> <span class="st">&quot;仙侠小说&quot;</span>] <span class="ot">=</span> <span class="st">&quot;武侠类小说&quot;</span></span>
<span id="cb386-6"><a href="ch4.html#cb386-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 求出每一类所占百分比</span></span>
<span id="cb386-7"><a href="ch4.html#cb386-7" aria-hidden="true" tabindex="-1"></a>ratio <span class="ot">=</span> <span class="fu">table</span>(novel<span class="sc">$</span><span class="st">&#39;小说类别&#39;</span>) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(novel<span class="sc">$</span><span class="st">&#39;小说类别&#39;</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb386-8"><a href="ch4.html#cb386-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义标签</span></span>
<span id="cb386-9"><a href="ch4.html#cb386-9" aria-hidden="true" tabindex="-1"></a>label1 <span class="ot">=</span> <span class="fu">names</span>(ratio)</span>
<span id="cb386-10"><a href="ch4.html#cb386-10" aria-hidden="true" tabindex="-1"></a>label2 <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(ratio, <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="ch4.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制饼图</span></span>
<span id="cb387-2"><a href="ch4.html#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family=</span><span class="st">&quot;STXihei&quot;</span>) </span>
<span id="cb387-3"><a href="ch4.html#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(ratio, <span class="at">col =</span> <span class="fu">heat.colors</span>(<span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>), <span class="at">labels =</span> <span class="fu">paste</span>(label1, label2, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>), <span class="at">font =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot4-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zjv53uj311c0qowgo.jpg" /></p>
</div>
<div id="直方图" class="section level3 unnumbered">
<h3>4.2.4 直方图</h3>
<p>直方图（histogram）是用于展示定量变量分布形态的一种统计图形。</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="ch4.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 随机生成1000个正态分布数</span></span>
<span id="cb388-2"><a href="ch4.html#cb388-2" aria-hidden="true" tabindex="-1"></a>r<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb388-3"><a href="ch4.html#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb388-4"><a href="ch4.html#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(r) </span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot5-1.png" width="672" />
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zjm29kj311c0qo0tu.jpg" /></p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="ch4.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 去掉异常值</span></span>
<span id="cb389-2"><a href="ch4.html#cb389-2" aria-hidden="true" tabindex="-1"></a>chara <span class="ot">=</span> <span class="fu">sort</span>(novel<span class="sc">$</span>总字数<span class="sc">/</span><span class="dv">10000</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">1500</span>] </span></code></pre></div>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="ch4.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb390-2"><a href="ch4.html#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>,<span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb390-3"><a href="ch4.html#cb390-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(chara, <span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">xlab =</span> <span class="st">&quot;总字数(万字)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频数&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;gold&quot;</span>,<span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb390-4"><a href="ch4.html#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 调整直方图组距</span></span>
<span id="cb390-5"><a href="ch4.html#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(chara, <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">xlab =</span> <span class="st">&quot;总字数(万字)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频数&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;gold&quot;</span>,<span class="at">border =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot6-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zjcbryj311c0qodha.jpg" /></p>
</div>
<div id="折线图" class="section level3 unnumbered">
<h3>4.2.5 折线图</h3>
<p>折线图（line chart），是以折线的上升或下降来表示统计数量的增减变化的统计图，一般用于反映变量随时间变化的特征。它不仅可以表示数量的多少，而且可以反映数据的变化趋势。</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="ch4.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取数据</span></span>
<span id="cb391-2"><a href="ch4.html#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AirPassengers)</span>
<span id="cb391-3"><a href="ch4.html#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 画时间序列图</span></span>
<span id="cb391-4"><a href="ch4.html#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot7-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5ziupr9j311c0qodi4.jpg" /></p>
</div>
<div id="箱线图" class="section level3 unnumbered">
<h3>4.2.6 箱线图</h3>
<p>箱线图（boxplot）主要用于描述定量变量在定性变量各个水平上的分布差异。</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="ch4.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 定性与定量变量--分组箱线图 ##</span></span>
<span id="cb392-2"><a href="ch4.html#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 不同性质的小说总点击数和评论数有差别吗</span></span>
<span id="cb392-3"><a href="ch4.html#cb392-3" aria-hidden="true" tabindex="-1"></a>novel_ <span class="ot">=</span> novel <span class="sc">%&gt;%</span></span>
<span id="cb392-4"><a href="ch4.html#cb392-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>((小说性质 <span class="sc">==</span> <span class="st">&#39;公众作品&#39;</span>)<span class="sc">|</span>(小说性质 <span class="sc">==</span> <span class="st">&#39;VIP作品&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb392-5"><a href="ch4.html#cb392-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(小说性质<span class="ot">=</span><span class="fu">factor</span>(小说性质))</span></code></pre></div>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="ch4.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 将画板分成1行2列</span></span>
<span id="cb393-2"><a href="ch4.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>)  </span>
<span id="cb393-3"><a href="ch4.html#cb393-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(总点击数) <span class="sc">~</span> 小说性质, <span class="at">data =</span> novel_, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;gold&#39;</span>,<span class="st">&#39;grey&#39;</span>), <span class="at">ylab =</span> <span class="st">&quot;总点击数对数&quot;</span>)</span>
<span id="cb393-4"><a href="ch4.html#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(总点击数) <span class="sc">~</span> 小说性质, <span class="at">data =</span> novel_, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;gold&#39;</span>,<span class="st">&#39;grey&#39;</span>), <span class="at">ylab =</span> <span class="st">&quot;总评论数对数&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot8-1.png" width="672" />
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zi29gxj311c0qo0ub.jpg" /></p>
</div>
<div id="散点图" class="section level3 unnumbered">
<h3>4.2.7 散点图</h3>
<p>散点图（scatter diagram）是用二维坐标展示两个连续变量之间关系的一种图形。散点图用坐标横轴代表变量x，纵轴代表变量y，每组数据在坐标系中用一个点表示，n个样本点就形成了n个散点。</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="ch4.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 两个定量变量--散点图 ##</span></span>
<span id="cb394-2"><a href="ch4.html#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 去除较大的异常值后画图</span></span>
<span id="cb394-3"><a href="ch4.html#cb394-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> novel[novel<span class="sc">$</span>评论数 <span class="sc">&lt;</span> <span class="dv">8000</span> <span class="sc">&amp;</span> novel<span class="sc">$</span>总点击数 <span class="sc">&lt;</span> <span class="dv">200000</span>, ]</span>
<span id="cb394-4"><a href="ch4.html#cb394-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> test<span class="sc">$</span>总点击数</span>
<span id="cb394-5"><a href="ch4.html#cb394-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> test<span class="sc">$</span>评论数</span></code></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="ch4.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>)  </span>
<span id="cb395-2"><a href="ch4.html#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">xlab =</span> <span class="st">&quot;总点击数&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;评论数&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot9-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zhxj1oj311c0qowhl.jpg" /></p>
</div>
<div id="相关系数图" class="section level3 unnumbered">
<h3>4.2.8 相关系数图</h3>
<p>相关系数图（corrplot）是对多变量相关关系矩阵的可视化展示。两变量间的相关系数的绝对值越大，说明两组变量的相关性越强。</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="ch4.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 选取数据</span></span>
<span id="cb396-2"><a href="ch4.html#cb396-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> novel[,<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb396-3"><a href="ch4.html#cb396-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算相关系数矩阵</span></span>
<span id="cb396-4"><a href="ch4.html#cb396-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">cor</span>(y,<span class="at">use=</span><span class="st">&quot;na.or.complete&quot;</span>)</span>
<span id="cb396-5"><a href="ch4.html#cb396-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制相关系数图 </span></span>
<span id="cb396-6"><a href="ch4.html#cb396-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>)  </span>
<span id="cb396-7"><a href="ch4.html#cb396-7" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(r, <span class="at">tl.col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot-add-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gkye5i9f2hj311c0qogou.jpg" /></p>
</div>
</div>
<div id="数据可视化进阶" class="section level2 unnumbered">
<h2>4.3 数据可视化进阶</h2>
<div id="ggplot2-包" class="section level3 unnumbered">
<h3>4.3.1 ggplot2 包</h3>
<div id="柱状图-1" class="section level4 unnumbered">
<h4>柱状图</h4>
<p>首先通过频数柱状图查看数据中小说类型的分布。</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="ch4.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算频数</span></span>
<span id="cb397-2"><a href="ch4.html#cb397-2" aria-hidden="true" tabindex="-1"></a>novel_count <span class="ot">=</span> novel<span class="sc">%&gt;%</span><span class="fu">group_by</span>(小说类型)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span></code></pre></div>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="ch4.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建坐标轴图层p,将变量按照频数排序并取前十</span></span>
<span id="cb398-2"><a href="ch4.html#cb398-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(novel_count[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,], <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(小说类型,<span class="fu">desc</span>(count)), <span class="at">y =</span> count))</span>
<span id="cb398-3"><a href="ch4.html#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制柱状图</span></span>
<span id="cb398-4"><a href="ch4.html#cb398-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>)<span class="sc">+</span></span>
<span id="cb398-5"><a href="ch4.html#cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">&#39;STXihei&#39;</span>)<span class="sc">+</span></span>
<span id="cb398-6"><a href="ch4.html#cb398-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;小说类型&quot;</span>, <span class="at">y =</span> <span class="st">&quot;频数&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot10-1.png" width="672" />
<img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zht3cej311c0qoabb.jpg" /></p>
</div>
<div id="饼图-1" class="section level4 unnumbered">
<h4>饼图</h4>
<p>如前所述，饼图可以查看定性变量分布比例。</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="ch4.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 饼图 ##</span></span>
<span id="cb399-2"><a href="ch4.html#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="do">## step 1: 统计频数（此处也可使用table()），即统计出来每一类别的频数。</span></span>
<span id="cb399-3"><a href="ch4.html#cb399-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="fu">ddply</span>(novel, .(小说类别), nrow)</span>
<span id="cb399-4"><a href="ch4.html#cb399-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> df1[<span class="fu">order</span>(df1<span class="sc">$</span>V1, <span class="at">decreasing =</span> T), ]</span>
<span id="cb399-5"><a href="ch4.html#cb399-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-6"><a href="ch4.html#cb399-6" aria-hidden="true" tabindex="-1"></a><span class="do">## step 2: 画出堆积柱状图。</span></span>
<span id="cb399-7"><a href="ch4.html#cb399-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算各个标签的位置 </span></span>
<span id="cb399-8"><a href="ch4.html#cb399-8" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">=</span> (<span class="fu">cumsum</span>(df1<span class="sc">$</span>V1) <span class="sc">-</span> df1<span class="sc">$</span>V1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb399-9"><a href="ch4.html#cb399-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建坐标轴图层p</span></span>
<span id="cb399-10"><a href="ch4.html#cb399-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> V1, <span class="at">fill =</span> <span class="fu">factor</span>(小说类别,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;武侠类小说&#39;</span>,<span class="st">&#39;都市类小说&#39;</span>,<span class="st">&#39;幻想类小说&#39;</span>,<span class="st">&#39;其他&#39;</span>)))) </span>
<span id="cb399-11"><a href="ch4.html#cb399-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制柱状图</span></span>
<span id="cb399-12"><a href="ch4.html#cb399-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>,<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span><span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">&#39;STXihei&#39;</span>) <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="st">&#39;&#39;</span>,<span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="ch4.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3 : 变成极坐标，并加比例标签。</span></span>
<span id="cb400-2"><a href="ch4.html#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 换到极坐标</span></span>
<span id="cb400-3"><a href="ch4.html#cb400-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> p<span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb400-4"><a href="ch4.html#cb400-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加文本信息</span></span>
<span id="cb400-5"><a href="ch4.html#cb400-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> pos, <span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(V1 <span class="sc">/</span> <span class="fu">sum</span>(V1) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>, <span class="st">&quot;&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb400-6"><a href="ch4.html#cb400-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb400-7"><a href="ch4.html#cb400-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb400-8"><a href="ch4.html#cb400-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb400-9"><a href="ch4.html#cb400-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">&#39;STXihei&#39;</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot11-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zhk710j311c0qoju3.jpg" /></p>
</div>
<div id="直方图-1" class="section level4 unnumbered">
<h4>直方图</h4>
<p>频数柱状图和饼图往往用于展示定性变量的分布频率，对于连续变量（如：小说总点击数）分布则需用直方图展示。</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="ch4.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建坐标轴图层p</span></span>
<span id="cb401-2"><a href="ch4.html#cb401-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(novel, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(总点击数)))</span>
<span id="cb401-3"><a href="ch4.html#cb401-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb401-4"><a href="ch4.html#cb401-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> <span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">&#39;STXihei&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;对数总点击数&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;频数&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot12-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zhfubij311c0qo0tq.jpg" /></p>
</div>
<div id="折线图-1" class="section level4 unnumbered">
<h4>折线图</h4>
<p>对于连续变量的时间序列数据，可以通过折线图形式展示。</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="ch4.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 折线图 ##</span></span>
<span id="cb402-2"><a href="ch4.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建坐标轴图层p</span></span>
<span id="cb402-3"><a href="ch4.html#cb402-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy))</span>
<span id="cb402-4"><a href="ch4.html#cb402-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制折线图</span></span>
<span id="cb402-5"><a href="ch4.html#cb402-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot13-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zhbxwqj311c0qoq57.jpg" /></p>
</div>
<div id="箱线图-1" class="section level4 unnumbered">
<h4>箱线图</h4>
<p>分组箱线图可用于比较组别之间变量分布差异。</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="ch4.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建坐标轴图层p</span></span>
<span id="cb403-2"><a href="ch4.html#cb403-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(novel_, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> 小说性质, <span class="at">y =</span> <span class="fu">log</span>(总点击数)))</span>
<span id="cb403-3"><a href="ch4.html#cb403-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制分组箱线图</span></span>
<span id="cb403-4"><a href="ch4.html#cb403-4" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&#39;gold&#39;</span>,<span class="st">&#39;grey&#39;</span>)) <span class="sc">+</span> <span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">&#39;STXihei&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;小说性质&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;对数总点击数&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot14-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zh7o6oj311c0qodh1.jpg" /></p>
</div>
<div id="散点图-1" class="section level4 unnumbered">
<h4>散点图</h4>
<p>对于两个定量变量，可以用散点图展示其关系。</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="ch4.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建坐标轴图层p</span></span>
<span id="cb404-2"><a href="ch4.html#cb404-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> novel[novel<span class="sc">$</span>评论数 <span class="sc">&lt;</span> <span class="dv">8000</span> <span class="sc">&amp;</span> novel<span class="sc">$</span>总点击数 <span class="sc">&lt;</span> <span class="dv">200000</span>, ]</span></code></pre></div>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="ch4.html#cb405-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(data , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> 总点击数, <span class="at">y =</span> 评论数))</span>
<span id="cb405-2"><a href="ch4.html#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制散点图</span></span>
<span id="cb405-3"><a href="ch4.html#cb405-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">&#39;STXihei&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;总点击数&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;评论数&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot15-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zh26s9j311c0qoacz.jpg" /></p>
<p>利用ggplot2包，也可以将其它变量映射到散点图当中，例如将不同性质的小说用不同的颜色来表示。</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="ch4.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建坐标轴图层p</span></span>
<span id="cb406-2"><a href="ch4.html#cb406-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">na.omit</span>(data) , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> 总点击数, <span class="at">y =</span> 评论数 , <span class="at">col =</span> 小说性质))</span>
<span id="cb406-3"><a href="ch4.html#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制散点图</span></span>
<span id="cb406-4"><a href="ch4.html#cb406-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">&#39;STXihei&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;总点击数&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;评论数&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot16-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky5zgvlsqj311c0qotcd.jpg" /></p>
</div>
</div>
<div id="交互可视化" class="section level3 unnumbered">
<h3>4.3.2 交互可视化</h3>
<div id="柱状图-2" class="section level4 unnumbered">
<h4>柱状图</h4>
<p>此处将type设置为bar就可以绘出柱状图，当把鼠标移动到任何一根柱子上面，就会实时显示出它的数值和对应的小说类型。</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="ch4.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 均值柱状图 </span><span class="al">###</span></span>
<span id="cb407-2"><a href="ch4.html#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(novel, <span class="at">y=</span> <span class="sc">~</span> 总点击数, <span class="at">x =</span> <span class="sc">~</span> 小说类型, <span class="at">type =</span> <span class="st">&quot;bar&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-790dc308672b399d70d5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-790dc308672b399d70d5">{"x":{"visdat":{"58c1e2aac7c":["function () ","plotlyVisDat"]},"cur_data":"58c1e2aac7c","attrs":{"58c1e2aac7c":{"y":{},"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"小说类型","type":"category","categoryorder":"array","categoryarray":["都市小说","二次元小说","军事小说","科幻小说","历史小说","灵异小说","奇幻小说","体育小说","武侠小说","仙侠小说","玄幻小说","游戏小说","职场小说"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"总点击数"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"y":[4383898,1678379,1248708,2457382,3736897,2968846,1033427,157094,8665859,25181363,22676983,8252764,29202959,3700009,2168304,11605672,4675394,2350638,20995002,3249420,29547476,7739383,1745962,4389937,8258082,13376750,13374766,916633,3686750,2085735,5216628,61606412,7290531,2683274,8923378,3611916,1792565,1189871,3262103,2789491,11549161,2377622,1832175,7616667,1709065,2400121,1026519,699405,1570534,1025458,1855854,1182451,2067297,1954882,1520053,2097389,3827134,5550317,845547,6049594,7814790,1919592,2151735,1418374,1344818,1461043,1744381,4238532,1129263,991751,1450629,264065,2796948,1648689,1052332,5321276,1234546,1321315,25070251,877423,2262767,7917248,566286,318905,870558,1324854,963201,556726,5264156,9334153,1422699,1878446,1428172,960120,696026,799677,1654384,1410992,1024929,804770,5804426,850909,939298,633008,3374819,811625,1100955,2922230,3618814,696891,856488,5652868,669115,778579,15754507,1047401,1796678,975637,2860706,1086726,907876,3308688,615169,861790,6728365,670301,3784546,896909,6178767,2074301,942502,312629,752667,2108350,393415,552550,854822,3809151,850584,8954083,627378,1182429,587032,947756,1665798,688970,3172246,4062421,461751,741285,1431397,779552,1599333,3000486,625813,714489,648149,689870,894973,666598,1644809,691111,2019706,1050422,5339644,1012424,3906984,315983,3691267,8033902,1010173,6159239,672636,629299,942194,6895923,749488,1028552,848425,794160,2116062,1973814,2395515,1166675,431552,527278,421232,581493,1327773,1808239,982636,1532196,1156171,476852,1032663,531722,2778700,517852,1772955,2252698,2700662,1100024,880397,693139,29340031,14229464,2823957,2539365,11101023,4797175,920066,17996764,3234276,711233,593483,8096430,455346,1634080,3298517,816391,5358459,3115070,1294736,538585,1903770,1489487,951776,1662337,1602024,456252,2401181,3150704,3791840,270830,1654914,780788,23359161,322671,1184805,839989,270353,1103152,41472313,1133807,712168,1046328,2243955,758791,62836820,1248767,303070,645111,660591,429097,516997,470862,1448832,1078524,667050,414854,990995,1507888,342324,844630,630987,964936,8964990,678511,64727312,293648,1825714,721659,220187,730733,1933611,1812068,755726,787566,1095118,776262,241570,757104,3239396,1046047,1057684,1898486,476884,887637,1179801,534433,18257068,815019,483673,739741,595880,562598,1064708,486007,285666,995211,450446,1101971,478200,779350,5348145,630452,710365,3071609,100792102,1335091,2530279,447245,264677,1605164,33422581,294352,11982691,84602916,477812,465024,789758,368439,2087357,1179787,812032,551836,1054998,997972,1058987,19702719,500243,996578,1146262,1081161,1272811,5284832,264625,189592,369039,638275,7120278,66737049,574746,223464,2566451,12066161,1062334,1219050,211358,233909,127360,713050,1227944,30444142,353510,26588971,678024,1026115,11762015,1063991,15557325,521870,794250,886763,516801,718024,661848,500787,2556738,2931867,34858849,1315840,1177675,310176,648605,323520,142186,309886,22504098,626259,828658,729821,519812,1594403,526617,2012760,233718,1217343,3293119,1178409,814039,1519336,1267086,489133,19760557,539652,583448,629592,911903,3971449,404620,104686,34757,539507,149842883,254299,609456,542409,628127,1181495,306931,174567,543834,3156963,3349615,539779,719837,400464,20361700,437086,1760049,1175534,581328,677001,959179,613508,443541,395117,958290,275028,609415,1437777,368652,18688475,464300,403874,3288814,1040295,195704,236940,281455,1647745,414517,2069829,7663530,177291,166154,791087,815639,3073993,1444437,747633,300401,259887,703147,1862798,219604,543227,566865,401165,6799760,866633,238288,349333,5960346,437183,900903,716571,1059586,252981,810274,255316,793054,11006694,639502,946759,917101,912866,382073,187086,1071596,1575023,20269710,326969,641271,724573,364552,752322,1046623,484705,135510,170351,312155,272400,1218413,16732564,58219,881110,306054,253149,778088,444591,393091,521664,304770,63125594,1281501,545445,181307,303516,2708561,512718,215948,236150,58291,156102,472382,575206,516063,233810,664161,179553,465929,564903,288617,211947,685041,134453,1894762,344773,109911,874768,791221,900401,1977102,20124665,116845,251516,1052049,904052,159520,1497143,647242,450267,1056294,94527049,353269,388556,212516,264039,1858664,213678,1033978,1379272,2147772,563520,318352,426566,134950,228695,1215770,183484,376263,17197535,957238,326740,330636,558992,385223,603510,493850,270255,280622,593221,406719,432468,1434899,413052,465449,342484,663413,659990,271526,431188,354735,83318,190255,109266,1333677,285683,1127829,253109,200032,305849,25203056,206063,467932,863581,624845,244234,677908,953966,289785,426748,22011430,428868,1107801,339594,691243,615022,1026524,360968,315150,1650341,927627,1200070,364751,527083,128606,550364,492952,167758,111162,202047,891815,676090,601432,212542,484597,469853,3244327,316645,116782,15921445,205547,299249,242149,265543,1520043,703834,2265500,1777732,376027,87651,250019,429972,321535,145832,451138,232320,345648,911803,331874,249969,489764,545676,301232,211070,124097,375867,323912,236487,422057,390007,363524,305957,5738138,304033,429337,82632,562748,1167285,626044,548758,316461,959692,9621228,492110,232470,379309,430286,1471592,216518,772133,73288,16795642,611374,334227,942917,805093,219472,48174,213412,984901,890922,21009697,569477,34047269,896644,4991483,704678,767722,179662,542303,485220,1767907,107416,586985,5549228,4538353,400594,438281,406404,421155,359892,651514,81690,153104,192276,352155,1148372,11142762,318781,4542875,1480740,251059,164406,1938266,57702,2204276,961965,1221093,2022915,179535,194797,49876681,3889771,581037,408651,349161,1162821,463173,1695867,238956,359443,870475,289880,434342,475310,451070,111593,275556,1482290,619189,223774,412446,60228,158428,504073,380314,14714511,1566088,234660,410012,2339135,628487,2730319,1090496,330937,205822,3288612,492203,172509,80301,93189,350537,162858,245433,81342,384865,469515,161981,4588670,442056,555340,284365,103665,307104,221964,4333751,248043,240447,159856,399019,1023677,821604,271388,599308,1556976,161862,1286345,48722,462495,451088,86816,380011,604018,412300,366143,352253,191468,699408,594183,19465468,79016,260320,137401,327166,139983,577879,241720,340437,319125,319021,424743,202563,156710,73621,400145,117486,360794,381658,544756,2308359,67244,52780201,602555,540795,412253,107828,454823,247802,344772,354287,158226,72989,1298858,515481,1004378,257470,689290,31688,95463,472399,94489,4284235,24177210,747065,201685,175145,34396,1193626,133413,572012,389965,902365,269297,259972,515554,379413,431462,38257138,346153,353763,1287813,259858,249402,717863,657556,222127,596128,1576190,539732,714471,333543,1716331,1316305,1925171,60348,593220,290154,467383,350576,77680,93567,145707,449947,445974,293371,1126246,229944,167260,1802757,324257,212190,4040203,752612,358522,66283,16203,1417219,1432398,349572,230363,863734,273680,3334618,498267,12349529,172988,19676291,5145177,204198,80516,312093,695712,173845,4742656,274462,530141,156967,5827768,172706,105761,201000,237519,253381,1714822,277741,119780,462591,290581,248971,338635,95793,657663,309831,154333,129124,78696,284332,66861,645684,188132,181840,817511,351666,156618,300243,101472,496390,227835,101419,294436,1926319,213521,115934,145257,6802091,33838252,2231525,215005,77716,57693,307621,28933,220315,3195414,216326,24495643,104520,117695,115645,137736,209746,123870,60093,324495,216033,1292826,648733,4324309,1436836,1180639,382836,2395073,2260649,189828,45373,186448,765062,94655,216808,433534,30432671,4179262,450208,351287,118473,169882,57023648,138729,164173,110402,44451,70531,138399,385139,672006,325590,35272481,542315,211062,648094,577308,146667,45267,599622,699276,151984,492202,522814,824234,184056,249635,60023,139521,19550414,138210,105094,273013,323827,269950,639692,10698387,44639,301430,408828,1822365,211263,8575450,156805,133593,138214,115743,343836,496250,3571521,1509253,184533,108973,312793,22195025,229704,102175,163673,93675,141928,539671,202143,88411,1247259,172370,174343,7446638,718957,1048514,53032,272459,171727,187693,108050,448951,353307,368797,122764,2278797,649001,86746,151212,83507,61460,239226,54983,195564,632761,1055580,865432,116627,385353,296330,126451,155248,1948067,106365,79454,138512,79043,97491,363323,620679,307101,139447,230438,152321,116625,1527125,562584,53799,31418,1027012,124214,518312,273430,98904,1494576,204815,203267,135649,18368936,240157,508253,448857,24036,87113,75062,41929,630779,99591,2833672,203648,187580,325051,131803,121075,38266,138480,3717675,166796,128512,48316,612210,249003,192161,628018,77387,590318,196861,412508,969698,189813,145514,246661,142462,7763105,216010,41680,295195,10058025,287116,4724495,1140136,484139,440392,967248,59644,46816,1317035,77701,260060,1959712,70676,86751,159973,172335,187857,118842,1392539,216187,402803,501707,221307,398099,729827,123623,172441,52794,64032,377031,277540,145036,217199,246951,152030,282297,126956,52816,449793,133463,176076,281477,81901,302640,56665,467054,1114263,222910,105868,57000,1445742,65432,558779,8710454,497480,35172894,317938,92563,345404,128627,1291508,9211333,127892,2433681,303302,55572,921052,117972,482743,436440,81490,155997,8719054,61307,174742,71180,1975072,301944,1526883,95396,28752,234819,79649,122481,30458030,257463,97521,90012,614888,185599,469614,16374132,762817,977661,520940,333082,757888,3774841,149790,322889,124514,429468,1334394,210541,50512,86995,120081,27751,484718,105130,182902,510265,191853,503100,169451,133912,1158157,700457,180896,192695,43069,85660,93224,427331,352560,130847,280507,384983,641267,143017,75944,93962,55870,70682,4775940,1072129,233651,228833,131812,95530,77484,184698,24810558,141299,555758,479143,2632184,483432,1150618,39010,10333029,413003,82744,465890,1436597,217999,30852,9657771,42729,59075,720059,781305,20084503,12023885,5326197,564077,76203,104577,131358,68899,80925,189598,144202,6263875,330073,61937,31042,228090,67987,130825,91440,13665814,1371579,192767,74869,358471,17481696,797659,179291,480590,157353,29372,685417,8745649,233433,598475,544332,18770195,5851288,707867,459551,64295,575743,52026,50446,384023,468924,223293,2030014,145089,52996,55700,491825,56693,52260,1959072,59395,28016,1202900,349801,1799940,17250,481596,654359,82476,99701,39259,3446883,48123,113997,5120348,5999280,444621,3504477,198403,262325,83028,408010,74833,66076,8287578,75764,87770,331476,5464638,30964,298552,30512,235547,5998753,261721,278317,498051,54874,461848,372733,191840,295636,95137,84798,8223765,1481363,88563,356008,219967,158002,28021,81217,246328,81817,501352,1119706,1446689,165395,107259,5236450,320895,203001,4053106,241810,755348,22071,6647997,257999,7328043,34884,83923,40724,273823,255351,23701,14838232,781605,463316,125291,2778246,158246,1332027,2538127,138620,160722,200001,164060,13212,131870,76689,43505,52967,4558086,123783,210619,82196,94368,185535,414867,109712,8335537,183348,530187,2980148,258931,23523591,132482,49136,128069,103669,69465,158719,129400,505173,87263,23887,62369,23611,573459,41029,250646,155914,255892,1406209,21939200,3448823,189342,315799,2715088,79166,65643,1183201,204335,685959,52350,2768421,4230332,1903935,3553490,75176,55114,1460444,9883831,12915,225049,84645,35602,118515,51858,201418,49854843,5131757,741534,11801119,41458,24067,42685,390859,68896,487063,718265,293059],"x":["仙侠小说","仙侠小说","仙侠小说","仙侠小说","仙侠小说","玄幻小说","都市小说","玄幻小说","仙侠小说","科幻小说","科幻小说","都市小说","玄幻小说","历史小说","都市小说","仙侠小说","玄幻小说","科幻小说","仙侠小说","历史小说","玄幻小说","职场小说","历史小说","玄幻小说","玄幻小说","仙侠小说","玄幻小说","科幻小说","游戏小说","都市小说","游戏小说","仙侠小说","历史小说","仙侠小说","历史小说","奇幻小说","游戏小说","玄幻小说","玄幻小说","都市小说","都市小说","都市小说","玄幻小说","玄幻小说","职场小说","玄幻小说","都市小说","体育小说","军事小说","都市小说","历史小说","都市小说","职场小说","历史小说","历史小说","游戏小说","玄幻小说","仙侠小说","历史小说","玄幻小说","仙侠小说","历史小说","历史小说","仙侠小说","都市小说","都市小说","都市小说","玄幻小说","玄幻小说","职场小说","仙侠小说","体育小说","都市小说","历史小说","游戏小说","仙侠小说","玄幻小说","军事小说","都市小说","军事小说","玄幻小说","玄幻小说","仙侠小说","历史小说","都市小说","都市小说","都市小说","历史小说","职场小说","玄幻小说","二次元小说","玄幻小说","科幻小说","都市小说","都市小说","科幻小说","玄幻小说","都市小说","历史小说","历史小说","仙侠小说","都市小说","科幻小说","都市小说","玄幻小说","职场小说","历史小说","历史小说","都市小说","游戏小说","都市小说","都市小说","历史小说","都市小说","仙侠小说","玄幻小说","科幻小说","科幻小说","都市小说","历史小说","玄幻小说","仙侠小说","历史小说","都市小说","历史小说","都市小说","仙侠小说","历史小说","都市小说","玄幻小说","都市小说","玄幻小说","科幻小说","科幻小说","仙侠小说","体育小说","历史小说","灵异小说","仙侠小说","游戏小说","职场小说","历史小说","玄幻小说","都市小说","历史小说","玄幻小说","玄幻小说","都市小说","二次元小说","二次元小说","都市小说","科幻小说","历史小说","玄幻小说","玄幻小说","都市小说","玄幻小说","历史小说","玄幻小说","历史小说","都市小说","科幻小说","都市小说","游戏小说","仙侠小说","科幻小说","都市小说","仙侠小说","历史小说","游戏小说","都市小说","玄幻小说","都市小说","体育小说","科幻小说","玄幻小说","游戏小说","都市小说","都市小说","仙侠小说","都市小说","科幻小说","仙侠小说","仙侠小说","仙侠小说","都市小说","二次元小说","都市小说","玄幻小说","游戏小说","科幻小说","都市小说","科幻小说","历史小说","仙侠小说","都市小说","都市小说","都市小说","游戏小说","奇幻小说","都市小说","历史小说","科幻小说","仙侠小说","奇幻小说","历史小说","玄幻小说","游戏小说","科幻小说","都市小说","历史小说","历史小说","科幻小说","都市小说","都市小说","玄幻小说","军事小说","奇幻小说","仙侠小说","职场小说","科幻小说","玄幻小说","玄幻小说","科幻小说","职场小说","武侠小说","都市小说","仙侠小说","历史小说","游戏小说","都市小说","玄幻小说","仙侠小说","玄幻小说","仙侠小说","科幻小说","游戏小说","都市小说","玄幻小说","都市小说","都市小说","玄幻小说","仙侠小说","玄幻小说","科幻小说","游戏小说","玄幻小说","历史小说","仙侠小说","都市小说","游戏小说","都市小说","二次元小说","历史小说","玄幻小说","玄幻小说","仙侠小说","科幻小说","科幻小说","都市小说","都市小说","历史小说","科幻小说","都市小说","历史小说","都市小说","都市小说","科幻小说","游戏小说","历史小说","都市小说","历史小说","游戏小说","历史小说","游戏小说","科幻小说","科幻小说","仙侠小说","历史小说","都市小说","历史小说","科幻小说","玄幻小说","仙侠小说","都市小说","历史小说","二次元小说","游戏小说","仙侠小说","都市小说","都市小说","历史小说","二次元小说","历史小说","科幻小说","二次元小说","科幻小说","都市小说","游戏小说","都市小说","历史小说","玄幻小说","体育小说","玄幻小说","仙侠小说","游戏小说","武侠小说","都市小说","仙侠小说","都市小说","二次元小说","体育小说","玄幻小说","二次元小说","玄幻小说","科幻小说","都市小说","科幻小说","都市小说","游戏小说","历史小说","二次元小说","游戏小说","游戏小说","科幻小说","玄幻小说","科幻小说","都市小说","武侠小说","仙侠小说","体育小说","玄幻小说","玄幻小说","科幻小说","历史小说","都市小说","职场小说","玄幻小说","玄幻小说","武侠小说","都市小说","玄幻小说","都市小说","游戏小说","玄幻小说","历史小说","科幻小说","都市小说","军事小说","仙侠小说","都市小说","都市小说","科幻小说","玄幻小说","二次元小说","历史小说","灵异小说","二次元小说","职场小说","奇幻小说","历史小说","职场小说","游戏小说","都市小说","都市小说","职场小说","历史小说","历史小说","都市小说","都市小说","玄幻小说","科幻小说","都市小说","仙侠小说","历史小说","体育小说","科幻小说","都市小说","都市小说","科幻小说","都市小说","玄幻小说","都市小说","玄幻小说","历史小说","玄幻小说","玄幻小说","灵异小说","都市小说","都市小说","游戏小说","都市小说","都市小说","历史小说","历史小说","仙侠小说","游戏小说","游戏小说","二次元小说","游戏小说","游戏小说","玄幻小说","玄幻小说","二次元小说","玄幻小说","仙侠小说","游戏小说","历史小说","科幻小说","都市小说","二次元小说","职场小说","历史小说","游戏小说","仙侠小说","都市小说","科幻小说","二次元小说","仙侠小说","游戏小说","玄幻小说","玄幻小说","游戏小说","都市小说","都市小说","都市小说","科幻小说","历史小说","都市小说","二次元小说","历史小说","科幻小说","职场小说","玄幻小说","都市小说","玄幻小说","科幻小说","都市小说","科幻小说","奇幻小说","二次元小说","历史小说","都市小说","都市小说","仙侠小说","体育小说","职场小说","职场小说","都市小说","都市小说","体育小说","历史小说","玄幻小说","科幻小说","都市小说","玄幻小说","游戏小说","都市小说","历史小说","体育小说","玄幻小说","都市小说","都市小说","都市小说","玄幻小说","科幻小说","职场小说","都市小说","历史小说","历史小说","二次元小说","游戏小说","游戏小说","游戏小说","仙侠小说","奇幻小说","历史小说","游戏小说","游戏小说","都市小说","游戏小说","科幻小说","都市小说","奇幻小说","二次元小说","玄幻小说","游戏小说","历史小说","武侠小说","历史小说","仙侠小说","科幻小说","都市小说","二次元小说","科幻小说","玄幻小说","都市小说","都市小说","科幻小说","武侠小说","科幻小说","二次元小说","历史小说","都市小说","都市小说","玄幻小说","都市小说","历史小说","都市小说","玄幻小说","历史小说","都市小说","游戏小说","都市小说","二次元小说","玄幻小说","都市小说","仙侠小说","都市小说","二次元小说","科幻小说","科幻小说","都市小说","体育小说","二次元小说","军事小说","玄幻小说","二次元小说","玄幻小说","体育小说","二次元小说","都市小说","都市小说","都市小说","都市小说","玄幻小说","二次元小说","游戏小说","都市小说","游戏小说","游戏小说","二次元小说","历史小说","都市小说","科幻小说","奇幻小说","游戏小说","职场小说","二次元小说","武侠小说","二次元小说","科幻小说","玄幻小说","科幻小说","仙侠小说","职场小说","都市小说","科幻小说","二次元小说","游戏小说","仙侠小说","二次元小说","玄幻小说","仙侠小说","都市小说","历史小说","历史小说","仙侠小说","二次元小说","游戏小说","奇幻小说","职场小说","二次元小说","玄幻小说","科幻小说","都市小说","科幻小说","历史小说","科幻小说","历史小说","都市小说","都市小说","都市小说","二次元小说","历史小说","科幻小说","二次元小说","二次元小说","游戏小说","都市小说","科幻小说","科幻小说","二次元小说","玄幻小说","历史小说","游戏小说","职场小说","职场小说","科幻小说","科幻小说","历史小说","玄幻小说","仙侠小说","科幻小说","历史小说","历史小说","都市小说","科幻小说","玄幻小说","都市小说","历史小说","玄幻小说","玄幻小说","武侠小说","都市小说","都市小说","都市小说","都市小说","仙侠小说","都市小说","科幻小说","奇幻小说","科幻小说","游戏小说","科幻小说","科幻小说","都市小说","都市小说","历史小说","仙侠小说","都市小说","科幻小说","二次元小说","玄幻小说","都市小说","历史小说","历史小说","游戏小说","玄幻小说","游戏小说","都市小说","科幻小说","历史小说","科幻小说","二次元小说","都市小说","职场小说","职场小说","都市小说","二次元小说","都市小说","科幻小说","科幻小说","都市小说","灵异小说","灵异小说","科幻小说","二次元小说","二次元小说","奇幻小说","二次元小说","都市小说","玄幻小说","玄幻小说","二次元小说","科幻小说","武侠小说","仙侠小说","二次元小说","职场小说","都市小说","仙侠小说","玄幻小说","历史小说","游戏小说","科幻小说","都市小说","历史小说","游戏小说","科幻小说","都市小说","科幻小说","体育小说","武侠小说","二次元小说","科幻小说","仙侠小说","仙侠小说","历史小说","仙侠小说","历史小说","游戏小说","历史小说","都市小说","科幻小说","灵异小说","科幻小说","玄幻小说","玄幻小说","都市小说","二次元小说","游戏小说","都市小说","体育小说","二次元小说","历史小说","二次元小说","历史小说","都市小说","玄幻小说","二次元小说","科幻小说","游戏小说","灵异小说","科幻小说","职场小说","二次元小说","都市小说","游戏小说","历史小说","二次元小说","都市小说","科幻小说","游戏小说","科幻小说","科幻小说","二次元小说","玄幻小说","游戏小说","武侠小说","科幻小说","历史小说","玄幻小说","奇幻小说","仙侠小说","仙侠小说","科幻小说","科幻小说","都市小说","历史小说","玄幻小说","游戏小说","科幻小说","科幻小说","科幻小说","科幻小说","都市小说","都市小说","体育小说","武侠小说","职场小说","都市小说","科幻小说","历史小说","职场小说","二次元小说","二次元小说","历史小说","玄幻小说","游戏小说","玄幻小说","都市小说","二次元小说","二次元小说","科幻小说","玄幻小说","游戏小说","都市小说","科幻小说","都市小说","仙侠小说","玄幻小说","游戏小说","二次元小说","二次元小说","历史小说","玄幻小说","仙侠小说","玄幻小说","历史小说","仙侠小说","二次元小说","都市小说","仙侠小说","二次元小说","二次元小说","都市小说","都市小说","仙侠小说","历史小说","都市小说","二次元小说","二次元小说","游戏小说","二次元小说","都市小说","武侠小说","都市小说","都市小说","科幻小说","奇幻小说","二次元小说","都市小说","奇幻小说","二次元小说","科幻小说","科幻小说","仙侠小说","历史小说","二次元小说","二次元小说","科幻小说","职场小说","玄幻小说","二次元小说","都市小说","科幻小说","都市小说","玄幻小说","科幻小说","科幻小说","历史小说","职场小说","科幻小说","历史小说","仙侠小说","二次元小说","二次元小说","科幻小说","科幻小说","二次元小说","科幻小说","都市小说","历史小说","科幻小说","玄幻小说","武侠小说","二次元小说","科幻小说","二次元小说","游戏小说","玄幻小说","都市小说","职场小说","都市小说","玄幻小说","游戏小说","都市小说","奇幻小说","灵异小说","科幻小说","都市小说","职场小说","科幻小说","游戏小说","仙侠小说","游戏小说","二次元小说","二次元小说","科幻小说","科幻小说","玄幻小说","奇幻小说","科幻小说","玄幻小说","都市小说","历史小说","玄幻小说","历史小说","都市小说","科幻小说","玄幻小说","游戏小说","都市小说","武侠小说","军事小说","武侠小说","职场小说","历史小说","游戏小说","科幻小说","科幻小说","都市小说","都市小说","科幻小说","玄幻小说","玄幻小说","玄幻小说","二次元小说","仙侠小说","都市小说","都市小说","都市小说","科幻小说","科幻小说","职场小说","游戏小说","仙侠小说","游戏小说","都市小说","历史小说","历史小说","科幻小说","科幻小说","科幻小说","玄幻小说","玄幻小说","仙侠小说","二次元小说","奇幻小说","科幻小说","玄幻小说","二次元小说","仙侠小说","游戏小说","灵异小说","游戏小说","游戏小说","历史小说","二次元小说","玄幻小说","科幻小说","科幻小说","都市小说","都市小说","职场小说","历史小说","历史小说","游戏小说","科幻小说","职场小说","二次元小说","二次元小说","都市小说","科幻小说","都市小说","职场小说","游戏小说","历史小说","历史小说","游戏小说","职场小说","玄幻小说","都市小说","职场小说","二次元小说","灵异小说","科幻小说","历史小说","职场小说","二次元小说","二次元小说","军事小说","仙侠小说","仙侠小说","二次元小说","都市小说","灵异小说","仙侠小说","都市小说","仙侠小说","都市小说","体育小说","玄幻小说","科幻小说","二次元小说","二次元小说","二次元小说","都市小说","历史小说","都市小说","历史小说","历史小说","二次元小说","历史小说","二次元小说","仙侠小说","科幻小说","都市小说","玄幻小说","二次元小说","科幻小说","科幻小说","科幻小说","科幻小说","二次元小说","二次元小说","职场小说","科幻小说","历史小说","都市小说","游戏小说","都市小说","二次元小说","游戏小说","历史小说","二次元小说","历史小说","二次元小说","职场小说","都市小说","科幻小说","游戏小说","科幻小说","玄幻小说","职场小说","玄幻小说","科幻小说","职场小说","职场小说","武侠小说","历史小说","都市小说","都市小说","二次元小说","玄幻小说","科幻小说","都市小说","历史小说","玄幻小说","奇幻小说","玄幻小说","科幻小说","仙侠小说","科幻小说","奇幻小说","玄幻小说","科幻小说","游戏小说","职场小说","游戏小说","都市小说","都市小说","都市小说","都市小说","二次元小说","体育小说","游戏小说","体育小说","玄幻小说","都市小说","玄幻小说","二次元小说","玄幻小说","玄幻小说","职场小说","二次元小说","都市小说","都市小说","历史小说","仙侠小说","游戏小说","仙侠小说","二次元小说","科幻小说","武侠小说","历史小说","玄幻小说","玄幻小说","职场小说","历史小说","武侠小说","科幻小说","灵异小说","武侠小说","二次元小说","仙侠小说","游戏小说","二次元小说","仙侠小说","体育小说","都市小说","二次元小说","二次元小说","二次元小说","科幻小说","奇幻小说","二次元小说","游戏小说","科幻小说","体育小说","都市小说","职场小说","玄幻小说","游戏小说","二次元小说","都市小说","都市小说","历史小说","游戏小说","二次元小说","都市小说","科幻小说","玄幻小说","奇幻小说","科幻小说","历史小说","仙侠小说","都市小说","仙侠小说","科幻小说","科幻小说","历史小说","历史小说","科幻小说","二次元小说","二次元小说","玄幻小说","二次元小说","历史小说","科幻小说","都市小说","奇幻小说","二次元小说","仙侠小说","都市小说","职场小说","都市小说","科幻小说","科幻小说","都市小说","玄幻小说","历史小说","二次元小说","游戏小说","科幻小说","都市小说","游戏小说","仙侠小说","科幻小说","历史小说","二次元小说","历史小说","科幻小说","玄幻小说","都市小说","二次元小说","二次元小说","二次元小说","仙侠小说","二次元小说","二次元小说","科幻小说","都市小说","职场小说","都市小说","历史小说","都市小说","灵异小说","游戏小说","奇幻小说","都市小说","都市小说","都市小说","都市小说","游戏小说","历史小说","科幻小说","玄幻小说","玄幻小说","二次元小说","科幻小说","职场小说","职场小说","玄幻小说","科幻小说","历史小说","职场小说","灵异小说","二次元小说","军事小说","都市小说","职场小说","科幻小说","仙侠小说","二次元小说","二次元小说","都市小说","二次元小说","二次元小说","历史小说","职场小说","仙侠小说","二次元小说","军事小说","游戏小说","二次元小说","科幻小说","科幻小说","游戏小说","科幻小说","游戏小说","玄幻小说","科幻小说","奇幻小说","二次元小说","职场小说","灵异小说","职场小说","仙侠小说","游戏小说","职场小说","历史小说","历史小说","科幻小说","仙侠小说","二次元小说","二次元小说","仙侠小说","武侠小说","仙侠小说","都市小说","都市小说","二次元小说","都市小说","二次元小说","科幻小说","游戏小说","科幻小说","玄幻小说","二次元小说","科幻小说","历史小说","灵异小说","玄幻小说","仙侠小说","玄幻小说","都市小说","仙侠小说","职场小说","仙侠小说","科幻小说","灵异小说","武侠小说","二次元小说","玄幻小说","历史小说","奇幻小说","游戏小说","二次元小说","都市小说","游戏小说","游戏小说","仙侠小说","体育小说","二次元小说","体育小说","二次元小说","二次元小说","游戏小说","科幻小说","仙侠小说","历史小说","玄幻小说","二次元小说","二次元小说","奇幻小说","都市小说","科幻小说","游戏小说","玄幻小说","武侠小说","游戏小说","游戏小说","科幻小说","玄幻小说","二次元小说","科幻小说","二次元小说","科幻小说","武侠小说","二次元小说","科幻小说","二次元小说","仙侠小说","历史小说","二次元小说","仙侠小说","科幻小说","游戏小说","游戏小说","玄幻小说","二次元小说","游戏小说","体育小说","玄幻小说","都市小说","玄幻小说","职场小说","二次元小说","二次元小说","仙侠小说","武侠小说","都市小说","都市小说","都市小说","科幻小说","玄幻小说","职场小说","玄幻小说","游戏小说","都市小说","二次元小说","玄幻小说","都市小说","都市小说","二次元小说","玄幻小说","科幻小说","二次元小说","玄幻小说","玄幻小说","玄幻小说","科幻小说","二次元小说","科幻小说","都市小说","玄幻小说","都市小说","都市小说","都市小说","二次元小说","玄幻小说","职场小说","都市小说","二次元小说","历史小说","科幻小说","二次元小说","二次元小说","科幻小说","灵异小说","历史小说","历史小说","都市小说","奇幻小说","科幻小说","科幻小说","武侠小说","都市小说","职场小说","科幻小说","仙侠小说","玄幻小说","科幻小说","二次元小说","二次元小说","二次元小说","奇幻小说","武侠小说","玄幻小说","都市小说","二次元小说","二次元小说","职场小说","奇幻小说","都市小说","游戏小说","历史小说","科幻小说","二次元小说","都市小说","玄幻小说","二次元小说","历史小说","历史小说","都市小说","历史小说","奇幻小说","仙侠小说","职场小说","科幻小说","二次元小说","科幻小说","仙侠小说","科幻小说","二次元小说","科幻小说","都市小说","二次元小说","科幻小说","都市小说","玄幻小说","仙侠小说","仙侠小说","玄幻小说","职场小说","科幻小说","历史小说","都市小说","科幻小说","奇幻小说","二次元小说","都市小说","都市小说","游戏小说","游戏小说","都市小说","游戏小说","历史小说","历史小说","科幻小说","历史小说","都市小说","仙侠小说","二次元小说","二次元小说","职场小说","二次元小说","历史小说","游戏小说","奇幻小说","都市小说","仙侠小说","二次元小说","职场小说","二次元小说","游戏小说","玄幻小说","二次元小说","玄幻小说","都市小说","奇幻小说","职场小说","科幻小说","体育小说","玄幻小说","玄幻小说","体育小说","历史小说","游戏小说","职场小说","科幻小说","都市小说","仙侠小说","二次元小说","仙侠小说","军事小说","历史小说","仙侠小说","都市小说","都市小说","历史小说","二次元小说","灵异小说","游戏小说","二次元小说","奇幻小说","都市小说","仙侠小说","职场小说","仙侠小说","都市小说","都市小说","科幻小说","二次元小说","仙侠小说","武侠小说","职场小说","奇幻小说","科幻小说","都市小说","仙侠小说","二次元小说","历史小说","军事小说","二次元小说","仙侠小说","科幻小说","二次元小说","仙侠小说","科幻小说","二次元小说","都市小说","科幻小说","仙侠小说","科幻小说","都市小说","武侠小说","仙侠小说","仙侠小说","科幻小说","科幻小说","科幻小说","游戏小说","历史小说","体育小说","都市小说","武侠小说","历史小说","奇幻小说","灵异小说","科幻小说","玄幻小说","科幻小说","武侠小说","仙侠小说","玄幻小说","游戏小说","奇幻小说","二次元小说","仙侠小说","都市小说","都市小说","仙侠小说","科幻小说","科幻小说","都市小说","都市小说","都市小说","游戏小说","奇幻小说","二次元小说","都市小说","二次元小说","都市小说","仙侠小说","二次元小说","科幻小说","职场小说","历史小说","历史小说","体育小说","都市小说","灵异小说","历史小说","历史小说","都市小说","科幻小说","体育小说","历史小说","历史小说","科幻小说","都市小说","科幻小说","仙侠小说","历史小说","二次元小说","仙侠小说","历史小说","二次元小说","都市小说","仙侠小说","游戏小说","仙侠小说","科幻小说","玄幻小说"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="饼图-2" class="section level4 unnumbered">
<h4>饼图</h4>
<p>交互式饼图可以展现每个组成部分更多的数据细节。</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="ch4.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 动态饼图 ##</span></span>
<span id="cb408-2"><a href="ch4.html#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 读取数据</span></span>
<span id="cb408-3"><a href="ch4.html#cb408-3" aria-hidden="true" tabindex="-1"></a>piedata <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">c</span>(<span class="fl">29.05</span>, <span class="fl">24.08</span>, <span class="fl">10.85</span>, <span class="fl">36.23</span>), <span class="at">group =</span> <span class="fu">c</span>(<span class="st">&quot;幻想类小说&quot;</span>, <span class="st">&quot;都市类小说&quot;</span>, <span class="st">&quot;武侠小说&quot;</span>, <span class="st">&quot;其他&quot;</span>))</span>
<span id="cb408-4"><a href="ch4.html#cb408-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制图形</span></span>
<span id="cb408-5"><a href="ch4.html#cb408-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(piedata, <span class="at">values =</span> <span class="sc">~</span>value, <span class="at">labels =</span> <span class="sc">~</span>group, <span class="at">type =</span> <span class="st">&quot;pie&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-56e95cf49908cfc41b27" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-56e95cf49908cfc41b27">{"x":{"visdat":{"58c4e04b88":["function () ","plotlyVisDat"]},"cur_data":"58c4e04b88","attrs":{"58c4e04b88":{"values":{},"labels":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"values":[29.05,24.08,10.85,36.23],"labels":["幻想类小说","都市类小说","武侠小说","其他"],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="直方图-2" class="section level4 unnumbered">
<h4>直方图</h4>
<p>在表现定量变量的分布时，直方图是必不可少的工具。</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="ch4.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 直方图 ##</span></span>
<span id="cb409-2"><a href="ch4.html#cb409-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">plot_ly</span>(novel, <span class="at">x =</span> <span class="sc">~</span> <span class="fu">log10</span>(总点击数), <span class="at">type =</span> <span class="st">&quot;histogram&quot;</span>)</span>
<span id="cb409-3"><a href="ch4.html#cb409-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 增加坐标轴及标题信息</span></span>
<span id="cb409-4"><a href="ch4.html#cb409-4" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(p,</span>
<span id="cb409-5"><a href="ch4.html#cb409-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;对数点击数分布直方图&quot;</span>, </span>
<span id="cb409-6"><a href="ch4.html#cb409-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xaxis =</span> <span class="fu">list</span>( <span class="at">title =</span> <span class="st">&quot;对数点击数&quot;</span>, <span class="at">showgrid =</span> F),     </span>
<span id="cb409-7"><a href="ch4.html#cb409-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">yaxis =</span> <span class="fu">list</span>( <span class="at">title =</span> <span class="st">&quot;频数&quot;</span>),    </span>
<span id="cb409-8"><a href="ch4.html#cb409-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">l =</span> <span class="dv">50</span>, <span class="at">r =</span> <span class="dv">50</span>, <span class="at">b =</span> <span class="dv">50</span>, <span class="at">t =</span> <span class="dv">50</span>, <span class="at">pad =</span> <span class="dv">4</span>))</span></code></pre></div>
<div id="htmlwidget-f3da7e7c40480455bb25" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f3da7e7c40480455bb25">{"x":{"visdat":{"58cc981db6":["function () ","plotlyVisDat"]},"cur_data":"58cc981db6","attrs":{"58cc981db6":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"layout":{"margin":{"b":50,"l":50,"t":50,"r":50,"pad":4},"title":"对数点击数分布直方图","xaxis":{"domain":[0,1],"automargin":true,"title":"对数点击数","showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"频数"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[6.64186044087949,6.22489003695936,6.0964608940869,6.3904726727995,6.57251112756649,6.47258767045397,6.01427980402388,5.19615959804664,6.93781161846017,7.40107923360975,7.35558527448857,6.91659942599349,7.46542685871774,6.56820278045769,6.33612017097842,7.06467029235267,6.66981821516913,6.37118575260116,7.32211592034519,6.51180584920085,7.47052038856452,6.88870633918726,6.24203478726766,6.64245828772534,6.91687919095945,7.12635061055323,7.12628619250278,5.9621954883658,6.56664368892111,6.31925912894738,6.71738986809912,7.78962591591925,6.86275916096153,6.42866502250877,6.95052929036772,6.55773764165235,6.25347491252924,6.07549987985893,6.5134976696489,6.44552496454307,7.06255043563032,6.37614281060101,6.2629669529042,6.88176496869253,6.23275858033601,6.3802331368398,6.01136699220519,5.8447287327268,6.19604734274188,6.01091787753542,6.2685438072878,6.072783152902,6.31540287439956,6.29112054776999,6.18185873084363,6.32167898596649,6.58287366850664,6.74431778806308,5.92713775300217,6.7817262292845,6.89291731209717,6.2832089313192,6.33278878412989,6.15179076167914,6.12866351337636,6.16466299785621,6.24164134764133,6.62721546633513,6.05279509883119,5.99640264705318,6.1615563553359,5.42171084227406,6.44668439217668,6.21713874034913,6.02215277690996,6.72601578517325,6.0915072766689,6.12100636527062,7.39915868207825,5.94320901443428,6.35463983640105,6.89857424899991,5.75303582491824,5.50366132844768,5.93979771082478,6.12216802130077,5.98371692480064,5.74564150403167,6.72132875084437,6.97007491530971,6.15311302624974,6.27379871484305,6.1547805142697,5.98232551645716,5.84262546295198,5.90291460518729,6.21863632125348,6.14952455141154,6.01069378151255,5.9056717785005,6.76375927879326,5.92988311718089,5.97280339761616,5.8014091986965,6.52825048549026,5.90935541588081,6.04176956815333,6.46571439496577,6.55856626179028,5.84316485585929,5.93272128257264,6.75226884437734,5.82550076585942,5.89130268565608,7.19740481750497,6.02011298420579,6.25447024997836,5.9892882621123,6.45647322685855,6.03612005771251,5.95802653553293,6.51965581633883,5.78899444209221,5.93540145033483,6.82790954301372,5.82626986730385,6.57801378832204,5.95274838194859,6.79090181837007,6.31687177671747,5.97428228045665,5.49502926144968,5.87660287520515,6.32394270827258,5.59485091453867,5.7423715832469,5.93187569079158,6.58082818903452,5.9297172091127,6.95202111576497,5.79752928540712,6.07277507259467,5.76866177594034,5.97669654251408,6.22162233632396,5.83820031172169,6.50136685843749,6.60878492854751,5.66440784465156,5.86998521220438,6.15576010266079,5.89184509009552,6.20393889839641,6.47719160472753,5.79644458049382,5.85399554694634,5.81167485531397,5.83876725943023,5.95180993349704,5.82386400630881,6.21611547367683,5.83954780542922,6.30528815564943,6.02136380902444,6.72751230309795,6.00536243176874,6.59184163269242,5.49966371804627,6.56717546010566,6.90492652977071,6.00439575646725,6.789527056561,5.82778010737789,5.79885704162381,5.9741403342737,6.83859240350375,5.87476468378136,6.01222625299932,5.92861345711242,5.89990800887146,6.32552838825134,6.29530622504103,6.37939889462511,6.06694989172298,5.63503313366053,5.72203965132782,5.62452135609258,5.76454449106847,6.12312383310874,6.25725583184805,5.9923926709681,6.18531432422204,6.06302207185632,5.67838360848066,6.01395861666099,5.72568462962195,6.44384166107116,5.71420565787786,6.24869771275845,6.35270297347053,6.43147023368012,6.04140216057083,5.94467855400209,5.84082033544828,7.46746056837304,7.15318854124897,6.45085807948851,6.4047251294255,7.04536300246082,6.68098556173212,5.96381898213654,7.2551944215874,6.50977707808196,5.85201189895402,5.7734082833379,6.90829356541323,5.65834152585628,6.21327331456363,6.51831872670271,5.91189820835187,6.72903991207721,6.49346781031209,6.1121812236825,5.73125425381381,6.27961447883603,6.17303671711608,5.97853474942368,6.22071907143614,6.20466901798386,5.65920478121699,6.38042489822381,6.49840760431492,6.57885000361774,5.4326967697355,6.21877542995713,5.89253312999953,7.36845723999799,5.50875993501678,6.07364687828478,5.924273598835,5.43193119313198,6.04263535669512,7.61775825757583,6.0545391339497,5.85258245552801,6.01966784730423,6.35101414338286,5.8801221710918,7.79821419846536,6.09648141351107,5.4815429489731,5.80963444725534,5.81993265249654,5.63255547820548,5.7134880230026,5.6728936429672,6.16101802956853,6.03282981374231,5.82415838850462,5.61789528189163,5.9960714632866,6.1783690850428,5.53443734816558,5.9266665028562,5.80002041172207,5.98449850943853,6.9525498094646,5.83155689282196,7.81108757198307,5.46782704726336,6.26143274584341,5.85833203219321,5.34279167433179,5.86375872058497,6.28636910803763,6.2581744910619,5.87836436394371,5.89628695895019,6.03946091733853,5.89000832686386,5.38304299930574,5.87915554069401,6.51046404158922,6.01955119828085,6.0243559346603,6.27840739887104,5.67841275160502,5.94823539694091,6.07180875994154,5.72789326697389,7.26143103312913,5.91116773327859,5.68455184451417,5.86907969005556,5.77515880909419,5.75019818394275,6.02723051728018,5.68664252448756,5.45585855367964,5.99791516760086,5.65364273469868,6.04217016556323,5.67960957177976,5.8917325397417,6.7282031734303,5.79965202678748,5.85148155541508,6.48736593142787,8.00342650242495,6.12551086828558,6.40316841108883,5.65054549404758,5.42271620345822,6.20551941098164,7.52403998447947,5.46886699100945,7.07855436022464,7.92738533208021,5.67925705263098,5.66747536751058,5.8974940338659,5.56636559489161,6.3195967326643,6.07180360639545,5.90957314395742,5.74181002903799,6.02325163632586,5.99911835650172,6.02489062879217,7.29452616348207,5.69918102018153,5.99851129565456,6.05928389524864,6.03389037129391,6.104763919953,6.72303118603651,5.42263087102747,5.27782000795376,5.56707226477637,5.80500783428618,6.85249695030947,7.82436699897219,5.75947595743767,5.34920756835992,6.40933297690274,7.08156911585401,6.02626108129523,6.08602151880851,5.32501869072714,5.36904693226294,5.10503305039359,5.85311998421757,6.08917856139347,7.48350373894511,5.54840170351734,7.4247015303489,5.83124506685097,6.01119603627934,7.07048172891852,6.02693795439994,7.19193492442676,5.71756233190253,5.89995722349919,5.94780756397441,5.71332334533931,5.85613896080688,5.82075826082805,5.69965304643731,6.40768622627268,6.46714426526097,7.54231304309523,6.11920308430713,6.07102545583254,5.49160819105721,5.81198029226178,5.50990113391091,5.15285683674488,5.49120195616801,7.35226161041055,5.79675398018828,5.91837532746385,5.86321635567553,5.71584630108579,6.20259810285388,5.72149487468464,6.30379199302596,5.36869216125675,6.08541296279812,6.51760742464132,6.07129605073496,5.91064521211163,6.18165382837849,6.10280609243508,5.6894269640571,7.29579918208446,5.73211379093496,5.76600215546382,5.79905920096167,5.95994864446308,6.5989489898589,5.6070473457481,5.01988860594545,4.54104228389653,5.73199708394321,8.17563612033986,5.40534465236865,5.7849423569651,5.73432688701297,5.79804746192658,6.07243188806995,5.48704075434589,5.24196214846207,5.73546635579064,6.49926949193657,6.5249948927132,5.7322159844044,5.85723416585517,5.60256348095941,7.3088140344603,5.64056689612562,6.24552475879903,6.07023519475304,5.76442124150556,5.83058931018317,5.98189966187149,5.78782023019783,5.64693377129459,5.59672571570362,5.98149695619846,5.43937691065378,5.78491313964224,6.1576915319581,5.56661659436717,7.27157386391996,5.66679868366617,5.60624589570532,6.51703931250429,6.01715651113068,5.29159970230682,5.37463838412019,5.44940896823204,6.21689000246927,5.61754234635745,6.3159344674743,6.88442886185003,5.2486866896362,5.22051080096843,5.89822424777355,5.91149798351102,6.48770287420314,6.1596986045748,5.87368846258588,5.47770137405037,5.41478455587858,5.84704612817066,6.27016576297906,5.34164024635231,5.73498134753828,5.75347964313295,5.60332303558983,6.8324935843952,5.93783522225321,5.37710217216179,5.54323961352472,6.7752714714062,5.64066326592694,5.95467803311831,5.85525922806282,6.0251362114571,5.40308790495046,5.90863190352801,5.40707803178027,5.89930275995767,7.04165689270812,5.80584190704392,5.97623944226581,5.96241716699743,5.96040703193558,5.58214634843083,5.27204128963665,6.03003108382646,6.19728690015746,7.30684753525933,5.51450657906047,5.80704160039634,5.86008214674312,5.56175948519811,5.87640376199053,6.01979027432045,5.68547749973351,5.13197134528106,5.23134468732102,5.49437029571459,5.43520710324075,6.08579452410847,7.22356249480171,4.76506474149764,5.94503013021781,5.48579805992269,5.40337621615762,5.89102871749502,5.64796066688772,5.59449310056117,5.71739086712144,5.48397221504393,7.80020547777557,6.10771894941555,5.73675096500548,5.25841457189852,5.48218159006879,6.43273862085919,5.70987856449219,5.33434918618863,5.37318794991272,4.76560150583852,5.19340846733788,5.67429334057228,5.75982340754399,5.7127027227168,5.36886308189829,5.82227336993434,5.25419266578379,5.66831974231776,5.75197388112681,5.46032190814608,5.32622727373431,5.83571656498279,5.12857049691938,6.2775546662418,5.53753324784252,5.04104115921364,5.94189288767423,5.8982978054636,5.95443596866327,6.29602907543125,7.30372865972998,5.0676101329125,5.40056561758553,6.02203596789189,5.95619341129789,5.20281514096758,6.17526328407376,5.81106669120065,5.65347011875268,6.02378481290138,7.97555610004937,5.54810552897283,5.58945361963198,5.32739163297515,5.42166807927079,6.26920088727876,5.329759810089,6.0145112983515,6.13964991987459,6.33198817628383,5.75090933428718,5.50290758260016,5.62998623648415,5.13017288889254,5.35925666965202,6.08485142265164,5.26359819929836,5.5754915138663,7.23546620198798,5.98101993070899,5.5142023047108,5.51935013825588,5.7474055925363,5.58571220907265,5.78068447063691,5.69359505810462,5.43177373760156,5.44812171553079,5.773216516636,5.60929446107539,5.63595397784113,6.15682133292619,5.61600472935971,5.66787210157518,5.53464028714517,5.82178397754365,5.81953735527259,5.43381142182872,5.6346666658932,5.54990404033823,4.92073883641507,5.27933607907665,5.03848504475395,6.1250506615873,5.45588439780012,6.0522432574611,5.40330758799051,5.30109947722271,5.48550706487243,7.40145320441124,5.31400001827905,5.67018274587227,5.93630307867617,5.79577229895493,5.38780612228103,5.83117075905379,5.97953289642787,5.46207590154293,5.63017149442415,7.3426482579525,5.63232364255083,6.04446175284378,5.53096000845675,5.83963074637168,5.78889065123511,6.01136910757482,5.55746870318153,5.49851731146163,6.21757368913351,5.96737338095383,6.07920657915353,5.56199649122728,5.72187900914751,5.10926123068856,5.74065001840937,5.69280463296887,5.22468323985749,5.04595635189762,5.30545240640887,5.95027477274833,5.83000451236425,5.77918653160237,5.32744476293174,5.68538072121816,5.67196200415995,6.51112462085923,5.50057263466697,5.06737590867453,7.20198248092977,5.3129111425469,5.47603270779956,5.38408267988523,5.4241348574349,6.18185587373331,5.84747024240217,6.3551640665152,6.24986628998971,5.57521902984793,4.94275687527299,5.39797301379848,5.63344017501813,5.50722825402397,5.16385283192811,5.65430940988478,5.36608659902,5.53863404829649,5.95990101677722,5.52097322981496,5.39788615281715,5.68998685923716,5.73693485300107,5.47890110526183,5.32442651014173,5.09376128271393,5.57503419762915,5.51042703765897,5.37380727199374,5.62537110762942,5.59107240198571,5.56053308843712,5.48566039388369,6.75877098864993,5.48292072485904,5.63279831732502,4.91714826441628,5.75031396019764,6.06717690473091,5.79660485762844,5.73938086460422,5.50032019609612,5.98213187453667,6.98323050650639,5.69206219027426,5.36636691561264,5.57899314748519,5.63375721589046,6.16778741821502,5.33549400681282,5.88769211405481,4.86503287013333,7.22519660905464,5.78630696547181,5.52404153076793,5.97447346577186,5.90584605062122,5.34137912129269,4.68281270829917,5.32921883583475,5.99339257840165,5.94983968332709,7.32241978909434,5.75547618851206,7.53208228201101,5.95262004669611,6.69822959633087,5.84799071306425,5.88520398601743,5.25445622994442,5.734242006943,5.68593869349426,6.2474594154004,5.03106897590885,5.76862700329112,6.74423256894962,6.65689827294816,5.60270444024861,5.64175264388231,5.60895797380681,5.62444196105159,5.55617219287555,5.81392375244679,4.91216889605963,5.184986537238,5.28392507873642,5.54673385901259,6.06008259483654,7.04699285445366,5.50349242865551,6.65733078709922,6.17047880836719,5.39977579464196,5.21591766307838,6.28741337767084,4.76119086642975,6.34326597210917,5.98315927101558,6.08674874162607,6.30597763472013,5.25414912603487,5.28958226417772,7.69789754602255,6.58992403413706,5.76420378881751,5.61135256600766,5.54302572864554,6.06551286632316,5.66574323488868,6.22939178929391,5.37831793979164,5.55563003032904,5.93975630271589,5.46221825264624,5.63783182679789,5.67697695146946,5.65424394377314,5.04763695305389,5.4402098718613,6.1709331787302,5.79182323242656,5.34980962503199,5.61536709606851,4.77979844172968,5.19983193969571,5.70249343565468,5.58014231281846,7.16774583398368,6.19481616183472,5.37043906633577,5.61279656759173,6.36905528724872,5.79829629890876,6.43621339130675,6.03762407690132,5.51974532562923,5.31349179398303,6.51701263718013,5.69214425641976,5.23681175766075,4.90472095364453,4.96936465139645,5.54473386552021,5.21180909707663,5.38993295592304,4.91031484643451,5.58530841772486,5.67164947160355,5.20946407578285,6.66168682598136,5.64547728959898,5.74455895593904,5.4538761418388,5.01563215202465,5.48728547312368,5.34628254260759,6.63686395487661,5.39452697535822,5.38101936285473,5.20372894162734,5.60099357588398,6.0101629456573,5.91466254496811,5.43359064049026,5.77765007501447,6.19228191818925,5.20914490232119,6.10935746275765,4.6877251074396,5.66510704197419,5.65426127399839,4.9385997720815,5.57979616811723,5.78104988097907,5.61521333480136,5.56365073561766,5.54685470051212,5.28209620083888,5.84473059556829,5.77392022217009,7.28926484973793,4.89771504076055,5.41550753559278,5.13798989351612,5.51476816425472,5.14607529671765,5.761836912584,5.38331258557642,5.53203675476914,5.50396082781231,5.50381927203505,5.62812623018635,5.30656012037615,5.19509671061186,4.8670017122078,5.60221739455004,5.06998611779928,5.5572593066178,5.58167437013552,5.73620202230983,6.36330335196833,4.82765353948276,7.72247103978749,5.77999669457691,5.7330326676184,5.61516382472579,5.03273154996495,5.65784241846187,5.39410480722753,5.53753198818729,5.54935521687778,5.19927784912844,4.86325741355517,6.11356167363855,5.71221266235043,6.00189719131364,5.41072663301419,5.83840197793373,4.50089482939624,4.979835078291,5.67430896960417,4.97538125276997,6.63187328484985,7.38340618273176,5.87335839018651,5.30467359945485,5.24339774368965,4.53650794027693,6.07686827019356,5.12519815006918,5.7574051397705,5.5910256301317,5.95538224200091,5.43023151534726,5.41492657527727,5.7122741607423,5.57911220723673,5.63494255227132,7.58271247752352,5.53926809985848,5.54871240817765,6.10985280482177,5.41473609157402,5.39689993184293,5.85604156956108,5.81793274492658,5.34660135115687,5.77533952102409,6.19760856783499,5.73217816757685,5.85398460570141,5.52315183063311,6.23460104668935,6.11935653097225,6.28446931101756,4.78066288166855,5.77321578453979,5.46262856203118,5.66967291186352,5.54478218151153,4.89030921689995,4.97112270509578,5.16348041648068,5.65316136052395,5.64930954035862,5.4674171812099,6.05163326154005,5.36162208187749,5.22339209244877,6.25593719057631,5.51088936032608,5.32672491280211,6.6064031867851,5.8765711386347,5.55451581045138,4.82140215656626,4.20959543200086,6.15143696608553,6.15606370595228,5.54353663925846,5.36241272567903,5.93638001548955,5.43724306117701,6.52304609012838,5.69746212499469,7.0916503943081,5.23801597761123,7.29394323687772,6.71140031958457,5.31005148411124,4.90588219119081,5.49428402789165,5.84242949435785,5.2401622043455,6.67602162502721,5.43848222371247,5.72439139295534,5.19580835798685,6.76550225443541,5.23730742570659,5.02432554853745,5.30319605742049,5.37569835612977,5.40377404580975,6.23421904657717,5.44363999483643,5.07838430874819,5.66519717904342,5.46326721400563,5.39614876366823,5.52973184308573,4.98133377450187,5.81800340921848,5.49112486873433,5.18845879829624,5.11100697114984,4.89595265838097,5.45382573989217,4.82517286778802,5.81002002475522,5.27446267243195,5.25968942271691,5.91249360501081,5.54613038160619,5.19484167375921,5.47747289085659,5.00634622034699,5.69582302385698,5.35762044116218,5.00611932405229,5.4689909090809,6.28472820826511,5.32944059475034,5.06421082032043,5.1621370704126,6.832642437731,7.52940792037284,6.34860175664875,5.33244855966984,4.8905104396036,4.76112312258738,5.48801597961058,4.46139346703536,5.34304406680787,6.5045271336267,5.33510871998433,7.38908884398368,5.01919940105529,5.07075801323822,5.06312686045855,5.13904746645856,5.32169368728623,5.09296613759436,4.77882388567281,5.51120800933627,5.33452009662885,6.11154007760671,5.81206599035104,6.63591671955513,6.15740720073016,6.07211712515406,5.58301276992567,6.37931875491719,6.35423313678294,5.27836027209875,4.65679749516578,5.27055772910992,5.8836966314501,4.9761435598218,5.33607530319732,5.63702316278883,7.48334007097974,6.62109959813275,5.65341320795678,5.54566207824995,5.07361938589817,5.23014736524454,7.75605499718235,5.14216725576325,5.21530173429872,5.04297694097557,4.64788153560087,4.84838004138612,5.14113295214349,5.58561749843889,5.82737315066582,5.51267105772972,7.54743600819923,5.73425161684028,5.32441004914917,5.8116380008098,5.7614075757418,5.16633240879832,4.65578171325783,5.77787755863809,5.84464862298294,5.18179787032992,5.69214337407056,5.71834720867388,5.91605052538856,5.26494997948124,5.39730547540638,4.77831769803461,5.14463958035315,7.29115595845883,5.14053946697234,5.02157792210556,5.43618332723799,5.51031305646848,5.43128333180726,5.80597091945669,7.02931830387163,4.64971445700151,5.47918647354625,5.61154063230539,6.26063536583685,5.3248234426137,6.93325691908088,5.1953599068037,5.12578370259298,5.14055203590939,5.06349473486666,5.53635134583224,5.69570051977117,6.55285320805354,6.17876204779015,5.26607404223685,5.03731890708239,5.49525702541278,7.34625563854165,5.36116855794123,5.00934464638363,5.21397704277094,4.97162370176584,5.1520680828846,5.7321290812515,5.30565870676784,4.94650630281962,6.09595664641457,5.23646168162681,5.24140451481837,6.87196024219792,5.85670291650087,6.02057423363985,4.72453800600947,5.43530115830649,5.23483858304181,5.27344807593481,5.03362477121926,5.65219894325081,5.54815224210866,5.566787379603,5.08907103053875,6.35770563904324,5.81224536597471,4.93824945789543,5.17958625761351,4.92172288187825,4.78859255592036,5.37880837867297,4.74022843226811,5.29128891159528,5.801239703728,6.02349115307897,5.93723294952516,5.06679910439885,5.58585874434804,5.4717756210208,5.10192226818232,5.19102601403665,6.28960388951893,5.02679874443022,4.90011576603929,5.14148740017321,4.89786341511602,4.98896452512677,5.56029289155088,5.79286705175175,5.48728123062013,5.14440917548654,5.36255409727514,5.18275978222906,5.06679165675456,6.18387458688511,5.75018737658403,4.73077420320323,4.49717853536311,6.01157551808933,5.0941705473711,5.71459126377577,5.43684616246182,4.99521385623619,6.1745180040467,5.31136175981686,5.30806687750079,5.13241659650467,7.26408400101395,5.380495249801,5.70607995077215,5.65210800246737,4.3808621953412,4.94008297024275,4.87542013185154,4.62251450467257,5.79987722629299,4.99822009317326,6.45234957885639,5.30888014929445,5.27318653152347,5.51195150645861,5.11992529545236,5.08305447771858,4.58281306717043,5.14138705486734,6.57027142097221,5.22218563144106,5.10894368245687,4.68409097259497,5.78690041920014,5.39620457952785,5.28366525011999,5.79797209148982,4.88866801103883,5.77108602594776,5.2941596868724,5.61543237548513,5.98663649987966,5.27832595327001,5.16290477909685,5.39210048786132,5.15369903703836,6.89003546026006,5.33447385691154,4.61992771029147,5.47010899715236,7.00251271075881,5.45805739492804,6.67435539370573,6.05695665881603,5.68497006880609,5.64383942113665,5.98553784039394,4.77556676153607,4.67039430444522,6.11959731642336,4.89042660814052,5.41507355821206,6.29219225196821,4.84927196207007,4.93827448971051,5.2040466892778,5.23637348849403,5.27382738254943,5.07496995196413,6.14380736703974,5.33482957491788,5.60509269643618,5.70045016050586,5.34499515099592,5.59999108666466,5.86321992608002,5.09209927855072,5.23664053269973,4.72258456808386,4.80639706695612,5.57637705995498,5.44332558395374,5.16147581368892,5.33685782139802,5.39261078912726,5.18192929550323,5.45070626287817,5.10365323065531,4.72276550698624,5.65301269235122,5.12536088275664,5.24570016358857,5.44944291364146,4.91328920446897,5.48092632828469,4.75331489310365,5.66936709586854,6.04698770966001,5.34812955186921,5.02476470870475,4.75587485567249,6.16009079781778,4.8157901951828,5.74724007611878,6.94004079158129,5.69677562565615,7.5462081032195,5.50234243796209,4.96643742181158,5.53832736266939,5.10933214059623,6.11109710067201,6.96432248281945,5.10684337900158,6.38626365153618,5.48187527409602,4.74485602704152,5.96428414993143,5.07177894214966,5.68371598502333,5.63992454710234,4.91110431780404,5.19311624645719,6.94046936740196,4.7875100648579,5.24239730209792,4.85235798366783,6.29558293218159,5.47992640406263,6.18380575977998,4.9795301649101,4.4586680597649,5.37073323423365,4.90118032756705,5.08806872351572,7.4837018101032,5.41071482541447,4.98909814597636,4.95430041151019,5.78879601754516,5.26857563192782,5.67174103549705,7.21415828713089,5.88242036308913,5.99018829103362,5.71678770569977,5.52255116372721,5.87960503072987,6.57689866344153,5.17548282077477,5.50905324997017,5.09521818501343,5.63293080974779,6.12528408052632,5.32333668135886,4.70339456454814,4.93949429244838,5.0794742959297,4.44327863742832,5.68548914754517,5.02172666441378,5.26221845443331,5.70779578030918,5.28296859463811,5.70165431732575,5.2290441361312,5.12681949635682,6.06376743643107,5.8453814797561,5.25742896378002,5.28487044584081,4.6341647881888,4.93277807006055,4.96952773344594,5.63076439911394,5.54723303750186,5.11676376978536,5.44794370346541,5.58544155244565,5.80703889142721,5.15538766381036,4.88049346786538,4.97295225224903,4.74717867136016,4.84930882969544,6.67905886212621,6.03024704339555,5.36856764409584,5.35951865423141,5.11995494968553,4.98013977774575,4.88921203245346,5.2664621927133,7.39463653184963,5.15013908827447,5.74488572297849,5.68046514774132,6.42031624489313,5.68433539444452,6.06093116374435,4.59117595031179,7.01422764825329,5.61595320632641,4.91773651167598,5.66828338872376,6.15733495517482,5.33845450142351,4.48928332269049,6.98487690342347,4.63072272900807,4.77140373030441,5.85736808299327,5.89282060360749,7.30286108938967,7.08004481387757,6.72641722564605,5.75133839191344,4.88197206921098,5.01943617906819,5.11845652744607,4.8382129186038,4.90808270807461,5.27783375181246,5.15897128384347,6.79684308248669,5.51861000045697,4.79195016590616,4.49194969457655,5.35810624520642,4.83242587788259,5.1166907434117,4.96113621738723,7.13563550541613,6.13722082708891,5.28503268856803,4.87430203244175,5.55445402736949,7.24258356375096,5.90181726971029,5.25355848951512,5.68177472986779,5.19687502733202,4.46793351953578,5.83595487178138,6.94179204327844,5.36816225147298,5.77704601340773,5.73586386622028,7.27346878444788,6.76725147458185,5.84995166645802,5.66233371548166,4.80817720065608,5.7602286664281,4.71622043660703,4.70282673555215,5.58435723601845,5.67110246093426,5.34887510861096,6.30749903303724,5.16163448741781,4.72424309142183,4.74585519517373,5.69181060062494,4.75352943898026,4.71816940539131,6.29205039752005,4.77374988666795,4.44740612873937,6.08022952488487,5.54382104669172,6.2552580283793,4.23678909940929,5.68268287113776,5.81581608004043,4.91632758995669,4.99869951430267,4.59393923311389,6.5374265420918,4.68235269353967,5.05689342238394,6.70929947842578,6.77809913191864,5.64798997111317,6.54462321403968,5.29754823472136,5.41883968153457,4.91922457665112,5.61067080743203,4.87409315611879,4.8200437445044,6.91842762887107,4.87946289540479,4.94334609835659,5.52045208946812,6.73756139779357,4.49085705878464,5.4750199848665,4.48447067570193,5.37207757729961,6.77806098013291,5.41783857100907,5.44453973447168,5.69727381642341,4.73936661892783,5.66449906728151,5.57139784481569,5.28293916575477,5.47075731757592,4.97834945248658,4.92838560934154,6.91507069155132,6.17066149307884,4.94725231949418,5.55145975728978,5.34235753176362,5.19866258431813,4.44748363011936,4.90964694344621,5.39151378071585,4.91284355109328,5.70014275177414,6.04910400540326,6.16037517928725,5.21852237640618,5.0304337436199,6.71903696104894,5.50636295022319,5.30749817728963,6.60778796189938,5.38347425705005,5.87814708362841,4.34382201076216,6.82269081479475,5.41161802264802,6.86498800905061,4.54262627781805,4.92388100021122,4.60985042877394,5.43746992427118,5.40713756296944,4.3747666702852,7.17138215711643,5.89298732894186,5.66587729824271,5.0979198755375,6.44377069774159,5.19933274112299,6.12451302801159,6.40451334905076,5.14182589451107,5.20607532806796,5.30103216713096,5.21500270721495,4.12096856501938,5.12014600618811,4.88473307474559,4.63853917299192,4.7240053756099,6.65878251500256,5.09266100402861,5.32349754644565,4.9148506834744,4.9748247508717,5.2684258485767,5.61790889087167,5.0402541321213,6.92093358360306,5.26327617694347,5.72442907477866,6.47423783252836,5.4131840485924,7.37150361980383,5.12215687576936,4.69139979909899,5.10744401843922,5.01564890931412,4.84176604004958,5.20062891857113,5.11193427633268,5.70344013075035,4.9408301394444,4.37816160955491,4.79496878080015,4.37311438120346,5.75850237304762,4.61309093203456,5.39906077820186,5.19288511358372,5.40805670866888,6.14804987317395,7.34122078723505,6.53767090614013,5.27724696021337,5.49941075045008,6.43378391027663,4.89853870200913,4.81718842085262,6.07305852803946,5.31034276215365,5.83629815855532,4.71891668601486,6.44223213494436,6.62637445250741,6.27965211756569,6.55065509761693,4.87607921384729,4.74126193189077,6.16448490882257,6.99492531095152,4.11109441050934,5.35227708750135,4.92760130932572,4.55147439585395,5.0737733208521,4.71481576338372,5.30409827928295,7.69770735293882,6.71026608338923,5.87013106861304,7.07192318972003,4.61760834720515,4.38142195796735,4.63027528575769,5.59202011656264,4.83819400814339,5.68758513941337,5.85628470441575,5.46695506334029],"type":"histogram","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="习题答案-2" class="section level2 unnumbered">
<h2>习题答案</h2>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="ch4.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)          <span class="co"># 读取.xlsx数据</span></span>
<span id="cb410-2"><a href="ch4.html#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)             <span class="co"># 用导管运算</span></span>
<span id="cb410-3"><a href="ch4.html#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)           <span class="co"># 画ggplot图</span></span>
<span id="cb410-4"><a href="ch4.html#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)           <span class="co"># 处理字符串</span></span>
<span id="cb410-5"><a href="ch4.html#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)             <span class="co"># 使用map函数</span></span>
<span id="cb410-6"><a href="ch4.html#cb410-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)        <span class="co"># 读入较大的csv文件</span></span>
<span id="cb410-7"><a href="ch4.html#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)          <span class="co"># 管道操作符</span></span>
<span id="cb410-8"><a href="ch4.html#cb410-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;zh_cn.utf-8&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;zh_cn.utf-8/zh_cn.utf-8/zh_cn.utf-8/C/zh_cn.utf-8/en_US.UTF-8&quot;</code></pre>
<div id="题目-4.3实训题目" class="section level3 unnumbered">
<h3>题目 4.3（实训题目）</h3>
<p>实训题目：使用“北美旅游产品数据集”，该案例数据提供了2926条北美旅游数据观测。其中包括产品名称、旅游方式、供应商、等级、景点个数、交通情况、用餐情况、是否有自由活动、客户评分、出游人数、评价人数、报价信息、旅游线路等。尝试完成以下分析。</p>
<p>a.读入数据，筛选出产品名称、旅游方式、供应商、等级、景点个数、交通、用餐、自由活动、总评价、出游人数、出发地、每日报价、旅游线路变量并重命名为英文变量名。</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="ch4.html#cb412-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">&quot;./data/data_4_3.xlsx&quot;</span>)                                                         <span class="co"># 原始数据</span></span>
<span id="cb412-2"><a href="ch4.html#cb412-2" aria-hidden="true" tabindex="-1"></a>travel_dat <span class="ot">=</span> dat[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">12</span><span class="sc">:</span><span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">17</span><span class="sc">:</span><span class="dv">23</span>,<span class="dv">25</span>)]                                               <span class="co"># 筛选出需要用到的变量</span></span>
<span id="cb412-3"><a href="ch4.html#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(travel_dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Product&quot;</span>, <span class="st">&quot;TravelMethod&quot;</span>, <span class="st">&quot;Agency&quot;</span>, <span class="st">&quot;Star&quot;</span>,</span>
<span id="cb412-4"><a href="ch4.html#cb412-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Place&quot;</span>, <span class="st">&quot;Traffic&quot;</span>, <span class="st">&quot;Meal&quot;</span>,<span class="st">&quot;FreeActivitie&quot;</span>,</span>
<span id="cb412-5"><a href="ch4.html#cb412-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Evaluate&quot;</span>,<span class="st">&quot;Sale&quot;</span>,<span class="st">&quot;Depart&quot;</span>,<span class="st">&quot;SunPrice&quot;</span>,<span class="st">&quot;MonPrice&quot;</span>,</span>
<span id="cb412-6"><a href="ch4.html#cb412-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Tuesprice&quot;</span>,<span class="st">&quot;WedPrice&quot;</span>,<span class="st">&quot;ThusPrice&quot;</span>,</span>
<span id="cb412-7"><a href="ch4.html#cb412-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;Friprice&quot;</span>,<span class="st">&quot;Satprice&quot;</span>,<span class="st">&quot;Routine&quot;</span>)                                 <span class="co"># 将变量名改为英文</span></span></code></pre></div>
<p>b.提取周一到周日报价中的数值部分，计算一周报价的均值（若一周7天均无报价则缺失），并以新变量“Price”存入数据集travel_dat中，剔除平均价格缺失的样本。绘制价格的对数分布直方图并进行简要解读。</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="ch4.html#cb413-1" aria-hidden="true" tabindex="-1"></a>allPrice <span class="ot">=</span> travel_dat[,<span class="dv">12</span><span class="sc">:</span><span class="dv">18</span>]                              <span class="co"># 取出周一到周日的数据</span></span>
<span id="cb413-2"><a href="ch4.html#cb413-2" aria-hidden="true" tabindex="-1"></a>allPrice[allPrice<span class="sc">==</span><span class="st">&quot;&quot;</span>] <span class="ot">=</span> <span class="cn">NA</span>                                <span class="co"># 处理缺失值</span></span>
<span id="cb413-3"><a href="ch4.html#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="ch4.html#cb413-4" aria-hidden="true" tabindex="-1"></a>PriceToNum <span class="ot">=</span> <span class="cf">function</span>(price)                               <span class="co"># 自定义函数，提取价格的数值部分</span></span>
<span id="cb413-5"><a href="ch4.html#cb413-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb413-6"><a href="ch4.html#cb413-6" aria-hidden="true" tabindex="-1"></a>  price <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">D&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">as.character</span>(price)) <span class="sc">%&gt;%</span> </span>
<span id="cb413-7"><a href="ch4.html#cb413-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()                                            <span class="co"># 去字符串中的价格部分</span></span>
<span id="cb413-8"><a href="ch4.html#cb413-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(price)</span>
<span id="cb413-9"><a href="ch4.html#cb413-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb413-10"><a href="ch4.html#cb413-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-11"><a href="ch4.html#cb413-11" aria-hidden="true" tabindex="-1"></a>price <span class="ot">=</span> allPrice <span class="sc">%&gt;%</span> <span class="fu">apply</span>(<span class="dv">2</span>, PriceToNum)                  <span class="co"># 得到价格的数值部分</span></span>
<span id="cb413-12"><a href="ch4.html#cb413-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-13"><a href="ch4.html#cb413-13" aria-hidden="true" tabindex="-1"></a>avgprice <span class="ot">=</span> <span class="fu">apply</span>(price, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T)) <span class="co"># 平均价格</span></span>
<span id="cb413-14"><a href="ch4.html#cb413-14" aria-hidden="true" tabindex="-1"></a>travel_dat<span class="sc">$</span>Price <span class="ot">=</span> avgprice                                <span class="co"># 建立新变量价格</span></span>
<span id="cb413-15"><a href="ch4.html#cb413-15" aria-hidden="true" tabindex="-1"></a>travel_dat <span class="ot">=</span> travel_dat[<span class="sc">!</span><span class="fu">is.na</span>(travel_dat<span class="sc">$</span>Price),]         <span class="co"># 去除缺失价格的观测</span></span></code></pre></div>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="ch4.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(travel_dat)<span class="sc">+</span></span>
<span id="cb414-2"><a href="ch4.html#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Price),<span class="at">fill =</span> <span class="st">&quot;gold&quot;</span>,<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb414-3"><a href="ch4.html#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;产品价格（对数变换）&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-4"><a href="ch4.html#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;频数&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-5"><a href="ch4.html#cb414-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">&quot;STXihei&quot;</span>)<span class="sc">+</span>                         <span class="co">#设置背景颜色和字体</span></span>
<span id="cb414-6"><a href="ch4.html#cb414-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">10000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1千&quot;</span>,<span class="st">&quot;1万&quot;</span>))<span class="sc">+</span><span class="co">#对数变换</span></span>
<span id="cb414-7"><a href="ch4.html#cb414-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb414-8"><a href="ch4.html#cb414-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb414-9"><a href="ch4.html#cb414-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb414-10"><a href="ch4.html#cb414-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))         <span class="co">#设置网格，取消边框</span></span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot17-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky63y3eybj311c0qoab1.jpg" /></p>
<p>c.提取“Star”变量中的“*钻”字符来表示产品等级，当一个产品包含多个钻级时取最大钻级，并将产品钻级以新变量“Star2”存入数据集travel_dat中，变量类型为因子型。</p>
<p>绘制价格的对数对产品等级的分组箱线图，并按每一等级的平均价格由低到高进行排列，对箱线图结果作出简要解读。</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="ch4.html#cb415-1" aria-hidden="true" tabindex="-1"></a>star <span class="ot">=</span> <span class="fu">strsplit</span>(<span class="fu">as.character</span>(travel_dat<span class="sc">$</span>Star), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">,&quot;</span>)         <span class="co"># 按“,”分开等级</span></span>
<span id="cb415-2"><a href="ch4.html#cb415-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-3"><a href="ch4.html#cb415-3" aria-hidden="true" tabindex="-1"></a>StarNum <span class="ot">=</span> <span class="cf">function</span>(x)                                          <span class="co"># 自定义函数，提取产品等级</span></span>
<span id="cb415-4"><a href="ch4.html#cb415-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb415-5"><a href="ch4.html#cb415-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;暂无酒店信息&quot;</span> <span class="sc">%in%</span> x){</span>
<span id="cb415-6"><a href="ch4.html#cb415-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;无&quot;</span>)</span>
<span id="cb415-7"><a href="ch4.html#cb415-7" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb415-8"><a href="ch4.html#cb415-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> x <span class="sc">%&gt;%</span> <span class="fu">strsplit</span>(<span class="st">&quot;晚|钻&quot;</span>)                                <span class="co"># 得到几晚几钻的信息</span></span>
<span id="cb415-9"><a href="ch4.html#cb415-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> x <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb415-10"><a href="ch4.html#cb415-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ceiling</span>() <span class="sc">%&gt;%</span> <span class="fu">max</span>(<span class="at">na.rm=</span>T)                                <span class="co"># 用最大的钻级表示该产品的等级</span></span>
<span id="cb415-11"><a href="ch4.html#cb415-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb415-12"><a href="ch4.html#cb415-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb415-13"><a href="ch4.html#cb415-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb415-14"><a href="ch4.html#cb415-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb415-15"><a href="ch4.html#cb415-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-16"><a href="ch4.html#cb415-16" aria-hidden="true" tabindex="-1"></a>star1<span class="ot">=</span> star  <span class="sc">%&gt;%</span> <span class="fu">lapply</span>(StarNum) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()                  <span class="co"># 得到产品等级</span></span>
<span id="cb415-17"><a href="ch4.html#cb415-17" aria-hidden="true" tabindex="-1"></a>star1[star1<span class="sc">==-</span><span class="cn">Inf</span>] <span class="ot">=</span> <span class="st">&quot;无&quot;</span>                                      <span class="co"># 将-Inf表示为无产品等级信息</span></span>
<span id="cb415-18"><a href="ch4.html#cb415-18" aria-hidden="true" tabindex="-1"></a>travel_dat<span class="sc">$</span>Star2 <span class="ot">=</span> <span class="fu">as.factor</span>(star1)                            <span class="co"># 变成因子变量并保存至travel_dat中</span></span>
<span id="cb415-19"><a href="ch4.html#cb415-19" aria-hidden="true" tabindex="-1"></a>travel_dat<span class="sc">$</span>Star2 <span class="ot">=</span> <span class="fu">factor</span>(travel_dat<span class="sc">$</span>Star2,                    <span class="co"># 按照均价重新排序水平</span></span>
<span id="cb415-20"><a href="ch4.html#cb415-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">levels</span>(travel_dat<span class="sc">$</span>Star2)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)], </span>
<span id="cb415-21"><a href="ch4.html#cb415-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;2钻&quot;</span>,<span class="st">&quot;无信息&quot;</span>,<span class="st">&quot;3钻&quot;</span>,<span class="st">&quot;4钻&quot;</span>,<span class="st">&quot;5钻&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="ch4.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(travel_dat, <span class="fu">aes_string</span>(<span class="at">x=</span><span class="st">&quot;Star2&quot;</span>, <span class="at">y=</span><span class="st">&quot;Price&quot;</span>)) <span class="sc">+</span>          <span class="co"># 箱线图</span></span>
<span id="cb416-2"><a href="ch4.html#cb416-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">&quot;STXihei&quot;</span>)<span class="sc">+</span></span>
<span id="cb416-3"><a href="ch4.html#cb416-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">varwidth=</span>T, <span class="at">color =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;#8CE52E&quot;</span>), <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;#8CE52E&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb416-4"><a href="ch4.html#cb416-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="fl">2e3</span>,<span class="fl">1e4</span>,<span class="fl">8e4</span>),                          <span class="co"># 对价格取对数</span></span>
<span id="cb416-5"><a href="ch4.html#cb416-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;2千&quot;</span>, <span class="st">&quot;1万&quot;</span>, <span class="st">&quot;8万&quot;</span>)) <span class="sc">+</span></span>
<span id="cb416-6"><a href="ch4.html#cb416-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;产品价格（对数变换）&quot;</span>) <span class="sc">+</span></span>
<span id="cb416-7"><a href="ch4.html#cb416-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb416-8"><a href="ch4.html#cb416-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),  <span class="co"># 背景透明</span></span>
<span id="cb416-9"><a href="ch4.html#cb416-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),                     <span class="co"># 去掉背景网格</span></span>
<span id="cb416-10"><a href="ch4.html#cb416-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb416-11"><a href="ch4.html#cb416-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())                        <span class="co"># 去掉坐标轴</span></span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot18-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky63xvnxuj311c0qo3zu.jpg" /></p>
</div>
<div id="题目-4.4实训题目" class="section level3 unnumbered">
<h3>题目 4.4（实训题目）</h3>
<p>实训题目：RTB（Real Time Bidding，实时竞拍）是目前一种重要的广告投放方式。当前的各种APP都有许多广告位，等待广告主的投放。对于投放广告的广告主，他们通过竞拍获得广告位，自然希望自己的广告能有更高的点击量。使用RTB数据集，本数据包括了来自某广告外包承包商（DPS）的4695条观测值，因变量为是否点击（1-点击/0-未点击），正样本大约占总样本的20%，请对以下自变量进行分析。</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="ch4.html#cb417-1" aria-hidden="true" tabindex="-1"></a>rtb_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/data_4_4.csv&quot;</span>)</span>
<span id="cb417-2"><a href="ch4.html#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="co">#将定性变量转为因子性变量，并设置标签</span></span>
<span id="cb417-3"><a href="ch4.html#cb417-3" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>dc <span class="ot">=</span> <span class="fu">factor</span>(rtb_data<span class="sc">$</span>dc,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb417-4"><a href="ch4.html#cb417-4" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>atype <span class="ot">=</span> <span class="fu">factor</span>(rtb_data<span class="sc">$</span>atype,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">13</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Inmobi&quot;</span>,<span class="st">&quot;Zplay&quot;</span>,<span class="st">&quot;Baidu&quot;</span>,<span class="st">&quot;Iflytek&quot;</span>))</span>
<span id="cb417-5"><a href="ch4.html#cb417-5" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>instl <span class="ot">=</span> <span class="fu">factor</span>(rtb_data<span class="sc">$</span>instl,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;是&quot;</span>,<span class="st">&quot;否&quot;</span>))</span>
<span id="cb417-6"><a href="ch4.html#cb417-6" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>isp <span class="ot">=</span> <span class="fu">factor</span>(rtb_data<span class="sc">$</span>isp,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;未知&quot;</span>,<span class="st">&quot;中国移动&quot;</span>,<span class="st">&quot;中国联通&quot;</span>,<span class="st">&quot;中国电信&quot;</span>))</span>
<span id="cb417-7"><a href="ch4.html#cb417-7" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>nt <span class="ot">=</span> <span class="fu">factor</span>(rtb_data<span class="sc">$</span>nt,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;未知&quot;</span>,<span class="st">&quot;WIFI&quot;</span>,<span class="st">&quot;2G&quot;</span>,<span class="st">&quot;3G&quot;</span>,<span class="st">&quot;4G&quot;</span>,<span class="st">&quot;5G&quot;</span>))</span>
<span id="cb417-8"><a href="ch4.html#cb417-8" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>mfr <span class="ot">=</span> <span class="fu">as.factor</span>(rtb_data<span class="sc">$</span>mfr)</span>
<span id="cb417-9"><a href="ch4.html#cb417-9" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>period <span class="ot">=</span> <span class="fu">as.factor</span>(rtb_data<span class="sc">$</span>period)</span>
<span id="cb417-10"><a href="ch4.html#cb417-10" aria-hidden="true" tabindex="-1"></a><span class="co">#计算不同ADX平台的点击率</span></span>
<span id="cb417-11"><a href="ch4.html#cb417-11" aria-hidden="true" tabindex="-1"></a>ratio_atype <span class="ot">=</span> rtb_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(atype) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">ratio=</span><span class="fu">sum</span>(dc<span class="sc">==</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">n</span>())</span>
<span id="cb417-12"><a href="ch4.html#cb417-12" aria-hidden="true" tabindex="-1"></a>list <span class="ot">=</span> ratio_atype<span class="sc">$</span>atype[<span class="fu">order</span>(ratio_atype<span class="sc">$</span>ratio,<span class="at">decreasing =</span> T)]</span>
<span id="cb417-13"><a href="ch4.html#cb417-13" aria-hidden="true" tabindex="-1"></a><span class="co">#将ADX平台类型按照点击率降序排序</span></span>
<span id="cb417-14"><a href="ch4.html#cb417-14" aria-hidden="true" tabindex="-1"></a>rtb_data<span class="sc">$</span>atype <span class="ot">=</span> <span class="fu">factor</span>(rtb_data<span class="sc">$</span>atype,<span class="at">levels =</span> list)</span></code></pre></div>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="ch4.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">las =</span> <span class="dv">2</span>,<span class="at">mai =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>)</span>
<span id="cb418-2"><a href="ch4.html#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spineplot</span>(dc<span class="sc">~</span>atype,rtb_data,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;gold&#39;</span>,<span class="st">&#39;grey&#39;</span>),<span class="at">xlab =</span> <span class="st">&#39;&#39;</span>,<span class="at">yaxlabels =</span> <span class="fu">c</span>(<span class="st">&#39;点击&#39;</span>,<span class="st">&#39;不点击&#39;</span>),<span class="at">ylab =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot19-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky63xpng9j311c0qowfm.jpg" /></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="ch4.html#cb419-1" aria-hidden="true" tabindex="-1"></a>bidf_plot <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">subset</span>(rtb_data,<span class="at">select =</span> <span class="fu">c</span>(<span class="st">&#39;dc&#39;</span>,<span class="st">&#39;bidf&#39;</span>)))</span>
<span id="cb419-2"><a href="ch4.html#cb419-2" aria-hidden="true" tabindex="-1"></a>bidf_plot<span class="sc">$</span>dc <span class="ot">=</span> <span class="fu">factor</span>(bidf_plot<span class="sc">$</span>dc,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;点击&#39;</span>,<span class="st">&#39;不点击&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="ch4.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bidf_plot)<span class="sc">+</span></span>
<span id="cb420-2"><a href="ch4.html#cb420-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dc,<span class="at">y =</span> bidf,<span class="at">fill =</span> dc),<span class="at">varwidth =</span> T)<span class="sc">+</span> <span class="co">#将箱线图按每一等级的平均价格由低到高进行排列，并调节图像的颜色</span></span>
<span id="cb420-3"><a href="ch4.html#cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;竞标底价（对数变换）&quot;</span>)<span class="sc">+</span> </span>
<span id="cb420-4"><a href="ch4.html#cb420-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="co">#添加坐标轴信息</span></span>
<span id="cb420-5"><a href="ch4.html#cb420-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;是否点击广告&quot;</span>)<span class="sc">+</span></span>
<span id="cb420-6"><a href="ch4.html#cb420-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()<span class="sc">+</span><span class="co">#对纵坐标轴做对数变化</span></span>
<span id="cb420-7"><a href="ch4.html#cb420-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;gold&quot;</span>, <span class="st">&quot;grey&quot;</span>))<span class="sc">+</span></span>
<span id="cb420-8"><a href="ch4.html#cb420-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">&quot;STXihei&quot;</span>)<span class="sc">+</span></span>
<span id="cb420-9"><a href="ch4.html#cb420-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb420-10"><a href="ch4.html#cb420-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb420-11"><a href="ch4.html#cb420-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb420-12"><a href="ch4.html#cb420-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="co">#调整主题样式</span></span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot20-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky63xmmi2j311c0qota1.jpg" /></p>
</div>
<div id="题目-4.5实训题目" class="section level3 unnumbered">
<h3>题目 4.5（实训题目）</h3>
<p>实训题目：使用“数据分析招聘数据集”，该数据集包括某网站数据分析岗位2018-2019年招聘情况。该数据共7493条招聘信息，覆盖北京、上海、深圳、山西、陕西以及河北六个地区。</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="ch4.html#cb421-1" aria-hidden="true" tabindex="-1"></a>fin_data <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;./data/data_4_5.csv&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb421-2"><a href="ch4.html#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fin_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb421-3"><a href="ch4.html#cb421-3" aria-hidden="true" tabindex="-1"></a><span class="do">###提取工资的函数</span></span>
<span id="cb421-4"><a href="ch4.html#cb421-4" aria-hidden="true" tabindex="-1"></a>fun_wage <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb421-5"><a href="ch4.html#cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x <span class="sc">==</span> <span class="st">&quot;面议&quot;</span>){<span class="co">#面议，工资12000</span></span>
<span id="cb421-6"><a href="ch4.html#cb421-6" aria-hidden="true" tabindex="-1"></a>    wage <span class="ot">=</span> <span class="dv">12000</span></span>
<span id="cb421-7"><a href="ch4.html#cb421-7" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">str_extract</span>(x,<span class="st">&quot;-&quot;</span>))){<span class="co">#提取中间点</span></span>
<span id="cb421-8"><a href="ch4.html#cb421-8" aria-hidden="true" tabindex="-1"></a>    wage1 <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">str_split</span>(x, <span class="st">&quot;-&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])</span>
<span id="cb421-9"><a href="ch4.html#cb421-9" aria-hidden="true" tabindex="-1"></a>    wage2 <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">str_split</span>(x, <span class="st">&quot;-&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])</span>
<span id="cb421-10"><a href="ch4.html#cb421-10" aria-hidden="true" tabindex="-1"></a>    wage<span class="ot">=</span><span class="fl">0.5</span><span class="sc">*</span>(wage1<span class="sc">+</span>wage2)</span>
<span id="cb421-11"><a href="ch4.html#cb421-11" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{<span class="co">#提取xxx以上，以下</span></span>
<span id="cb421-12"><a href="ch4.html#cb421-12" aria-hidden="true" tabindex="-1"></a>    wage<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">D&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">as.character</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb421-13"><a href="ch4.html#cb421-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb421-14"><a href="ch4.html#cb421-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb421-15"><a href="ch4.html#cb421-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(wage)</span>
<span id="cb421-16"><a href="ch4.html#cb421-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb421-17"><a href="ch4.html#cb421-17" aria-hidden="true" tabindex="-1"></a>fin_data<span class="sc">$</span>wage <span class="ot">=</span> fin_data<span class="sc">$</span>X6<span class="sc">%&gt;%</span></span>
<span id="cb421-18"><a href="ch4.html#cb421-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(fun_wage) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="do">###提取工资</span></span>
<span id="cb421-19"><a href="ch4.html#cb421-19" aria-hidden="true" tabindex="-1"></a>fin_data<span class="ot">=</span>fin_data[<span class="fu">which</span>(fin_data<span class="sc">$</span>wage <span class="sc">&lt;=</span> <span class="dv">40000</span> <span class="sc">&amp;</span> fin_data<span class="sc">$</span>wage <span class="sc">&gt;=</span> <span class="dv">3000</span>),]<span class="co">#筛选工资在3000-40000的</span></span></code></pre></div>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="ch4.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fin_data)<span class="sc">+</span></span>
<span id="cb422-2"><a href="ch4.html#cb422-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> wage),<span class="at">fill =</span> <span class="st">&quot;gold&quot;</span>,<span class="at">bins =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb422-3"><a href="ch4.html#cb422-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;薪资水平（元／月）&quot;</span>) <span class="sc">+</span></span>
<span id="cb422-4"><a href="ch4.html#cb422-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;频数&quot;</span>) <span class="sc">+</span></span>
<span id="cb422-5"><a href="ch4.html#cb422-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">&quot;STXihei&quot;</span>)<span class="sc">+</span>                         <span class="co">#设置背景颜色和字体</span></span>
<span id="cb422-6"><a href="ch4.html#cb422-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb422-7"><a href="ch4.html#cb422-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb422-8"><a href="ch4.html#cb422-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb422-9"><a href="ch4.html#cb422-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))         <span class="co">#设置网格，取消边框</span></span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot21-1.png" width="672" /></p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="ch4.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fin_data<span class="sc">$</span>wage)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    3000    6500    9000    9563   12500   40000</code></pre>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky63xfx9ij311c0qo0tq.jpg" /></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="ch4.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="do">###对岗位进行分类</span></span>
<span id="cb425-2"><a href="ch4.html#cb425-2" aria-hidden="true" tabindex="-1"></a>fin_data<span class="sc">$</span>is_tech <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb425-3"><a href="ch4.html#cb425-3" aria-hidden="true" tabindex="-1"></a>fin_data[<span class="fu">str_detect</span>(fin_data<span class="sc">$</span>X3,<span class="st">&quot;数据|IT|量化|工程师&quot;</span>),]<span class="sc">$</span>is_tech <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb425-4"><a href="ch4.html#cb425-4" aria-hidden="true" tabindex="-1"></a><span class="do">###计算各个城市按照岗位类别分类的平均工资和岗位个数</span></span>
<span id="cb425-5"><a href="ch4.html#cb425-5" aria-hidden="true" tabindex="-1"></a>fin_data_city<span class="ot">=</span>fin_data<span class="sc">%&gt;%</span></span>
<span id="cb425-6"><a href="ch4.html#cb425-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(X0,is_tech)<span class="sc">%&gt;%</span></span>
<span id="cb425-7"><a href="ch4.html#cb425-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanwage=</span><span class="fu">mean</span>(wage,<span class="at">na.rm =</span> T),<span class="co">#计算平均工资</span></span>
<span id="cb425-8"><a href="ch4.html#cb425-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">countwage=</span><span class="fu">length</span>(wage))<span class="co">#计算岗位个数</span></span></code></pre></div>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="ch4.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="do">###绘制并列柱状图</span></span>
<span id="cb426-2"><a href="ch4.html#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fin_data_city)<span class="sc">+</span></span>
<span id="cb426-3"><a href="ch4.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(X0,<span class="at">X =</span> <span class="sc">-</span>meanwage,<span class="at">FUN =</span> median),<span class="co">#将城市按照工资均值排序</span></span>
<span id="cb426-4"><a href="ch4.html#cb426-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> meanwage<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb426-5"><a href="ch4.html#cb426-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">factor</span>(is_tech,</span>
<span id="cb426-6"><a href="ch4.html#cb426-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb426-7"><a href="ch4.html#cb426-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;传统金融&quot;</span>,<span class="st">&quot;金融科技&quot;</span>))),</span>
<span id="cb426-8"><a href="ch4.html#cb426-8" aria-hidden="true" tabindex="-1"></a>           <span class="co">#is_tech对应传统金融和金融科技</span></span>
<span id="cb426-9"><a href="ch4.html#cb426-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span><span class="co">#position = &quot;dodge&quot;设置为并列柱状图</span></span>
<span id="cb426-10"><a href="ch4.html#cb426-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">&quot;STXihei&quot;</span>)<span class="sc">+</span><span class="co">#背景设置为白色，字体为宋体</span></span>
<span id="cb426-11"><a href="ch4.html#cb426-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;岗位类别&quot;</span>)<span class="sc">+</span><span class="co">#设置图例</span></span>
<span id="cb426-12"><a href="ch4.html#cb426-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;DimGrey&quot;</span>,<span class="st">&quot;gold&quot;</span>))<span class="sc">+</span><span class="co">#填充颜色</span></span>
<span id="cb426-13"><a href="ch4.html#cb426-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;城市&quot;</span>)<span class="sc">+</span><span class="co">#设置横轴名称</span></span>
<span id="cb426-14"><a href="ch4.html#cb426-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;薪资平均水平（千元）&quot;</span>)<span class="sc">+</span><span class="co">#设置纵轴名称</span></span>
<span id="cb426-15"><a href="ch4.html#cb426-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb426-16"><a href="ch4.html#cb426-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb426-17"><a href="ch4.html#cb426-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb426-18"><a href="ch4.html#cb426-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="co">#设置背景和坐标轴</span></span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot22-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky63xcpdsj311c0qo0u6.jpg" /></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="ch4.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="do">###提取工作经验要求的函数</span></span>
<span id="cb427-2"><a href="ch4.html#cb427-2" aria-hidden="true" tabindex="-1"></a>fun_work <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb427-3"><a href="ch4.html#cb427-3" aria-hidden="true" tabindex="-1"></a>  str_list0 <span class="ot">=</span> <span class="fu">str_split</span>(x,<span class="st">&quot;[|]&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb427-4"><a href="ch4.html#cb427-4" aria-hidden="true" tabindex="-1"></a>  work0 <span class="ot">=</span> str_list0[<span class="fu">str_detect</span>(str_list0,<span class="st">&quot;经验&quot;</span>)]</span>
<span id="cb427-5"><a href="ch4.html#cb427-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(work0) <span class="sc">==</span> <span class="dv">1</span>){<span class="co">#提取有经验要求的</span></span>
<span id="cb427-6"><a href="ch4.html#cb427-6" aria-hidden="true" tabindex="-1"></a>    work <span class="ot">=</span> <span class="fu">substring</span>(work0, <span class="dv">4</span>)</span>
<span id="cb427-7"><a href="ch4.html#cb427-7" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{<span class="co">#提取无经验要求的</span></span>
<span id="cb427-8"><a href="ch4.html#cb427-8" aria-hidden="true" tabindex="-1"></a>    work <span class="ot">=</span> <span class="st">&quot;不限&quot;</span></span>
<span id="cb427-9"><a href="ch4.html#cb427-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb427-10"><a href="ch4.html#cb427-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(work)</span>
<span id="cb427-11"><a href="ch4.html#cb427-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb427-12"><a href="ch4.html#cb427-12" aria-hidden="true" tabindex="-1"></a><span class="co">#提取工作经验要求</span></span>
<span id="cb427-13"><a href="ch4.html#cb427-13" aria-hidden="true" tabindex="-1"></a>fin_data<span class="sc">$</span>work <span class="ot">=</span> fin_data<span class="sc">$</span>X7<span class="sc">%&gt;%</span></span>
<span id="cb427-14"><a href="ch4.html#cb427-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(fun_work) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() </span>
<span id="cb427-15"><a href="ch4.html#cb427-15" aria-hidden="true" tabindex="-1"></a>fin_data[<span class="fu">which</span>(fin_data<span class="sc">$</span>work <span class="sc">==</span> <span class="st">&quot;无经验&quot;</span>),]<span class="sc">$</span>work <span class="ot">=</span> <span class="st">&quot;不限&quot;</span><span class="co">#将无经验变为不限</span></span>
<span id="cb427-16"><a href="ch4.html#cb427-16" aria-hidden="true" tabindex="-1"></a><span class="co">#设置标签wage0，将不限排在最后</span></span>
<span id="cb427-17"><a href="ch4.html#cb427-17" aria-hidden="true" tabindex="-1"></a>fin_data<span class="sc">$</span>wage0<span class="ot">=</span>fin_data<span class="sc">$</span>wage</span>
<span id="cb427-18"><a href="ch4.html#cb427-18" aria-hidden="true" tabindex="-1"></a>fin_data[<span class="fu">which</span>(fin_data<span class="sc">$</span>work <span class="sc">==</span> <span class="st">&quot;不限&quot;</span>),]<span class="sc">$</span>wage0 <span class="ot">=</span> <span class="dv">0</span></span></code></pre></div>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="ch4.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co">#绘制箱线图</span></span>
<span id="cb428-2"><a href="ch4.html#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fin_data)<span class="sc">+</span></span>
<span id="cb428-3"><a href="ch4.html#cb428-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(work,<span class="at">X =</span> <span class="sc">-</span>wage0),<span class="co">#按照wage0对work排序，“不限”排在最后</span></span>
<span id="cb428-4"><a href="ch4.html#cb428-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> wage<span class="sc">/</span><span class="dv">10000</span>,</span>
<span id="cb428-5"><a href="ch4.html#cb428-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="fu">factor</span>(is_tech,<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;传统金融&quot;</span>,<span class="st">&quot;金融科技&quot;</span>))),<span class="co">#设置is_tech标签</span></span>
<span id="cb428-6"><a href="ch4.html#cb428-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">varwidth =</span> T)<span class="sc">+</span></span>
<span id="cb428-7"><a href="ch4.html#cb428-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;岗位类别&quot;</span>)<span class="sc">+</span><span class="co">#设置图例</span></span>
<span id="cb428-8"><a href="ch4.html#cb428-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;DimGrey&quot;</span>,<span class="st">&quot;gold&quot;</span>))<span class="sc">+</span><span class="co">#填充颜色</span></span>
<span id="cb428-9"><a href="ch4.html#cb428-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;岗位类别&quot;</span>)<span class="sc">+</span><span class="co">#设置横轴名称</span></span>
<span id="cb428-10"><a href="ch4.html#cb428-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;岗位工资（万元）&quot;</span>)<span class="sc">+</span><span class="co">#设置纵轴名称</span></span>
<span id="cb428-11"><a href="ch4.html#cb428-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_family =</span> <span class="st">&quot;STXihei&quot;</span>)<span class="sc">+</span><span class="co">#背景设置为白色，字体为宋体</span></span>
<span id="cb428-12"><a href="ch4.html#cb428-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb428-13"><a href="ch4.html#cb428-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb428-14"><a href="ch4.html#cb428-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb428-15"><a href="ch4.html#cb428-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="co">#设置背景和坐标轴</span></span></code></pre></div>
<p><img src="_main_files/figure-html/ch4-plot23-1.png" width="672" /></p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky63x7ljgj311c0qowge.jpg" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-ch4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
