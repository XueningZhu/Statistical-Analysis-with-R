<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第6章：线性回归 | 统计分析与R语言（辅助材料）</title>
  <meta name="description" content="第6章：线性回归 | 统计分析与R语言（辅助材料）" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="第6章：线性回归 | 统计分析与R语言（辅助材料）" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="XueningZhu/Statistical-Analysis-with-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第6章：线性回归 | 统计分析与R语言（辅助材料）" />
  
  
  

<meta name="author" content="朱雪宁 &amp; 任怡萌" />


<meta name="date" content="2020-11-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch5.html"/>
<link rel="next" href="ch7.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i>第1章：统计分析与R语言</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i>第2章：R语言中的数据管理与预处理</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#案例引入"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#基本数据类型"><i class="fa fa-check"></i>2.1 基本数据类型</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数值型"><i class="fa fa-check"></i>2.1.1 数值型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#字符型"><i class="fa fa-check"></i>2.1.2 字符型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#逻辑型"><i class="fa fa-check"></i>2.1.3 逻辑型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#因子型数据"><i class="fa fa-check"></i>2.1.4 因子型数据</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据结构"><i class="fa fa-check"></i>2.2 数据结构</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#向量"><i class="fa fa-check"></i>2.2.1 向量</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#矩阵"><i class="fa fa-check"></i>2.2.2 矩阵</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数组"><i class="fa fa-check"></i>2.2.3 数组</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据框"><i class="fa fa-check"></i>2.2.4 数据框</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#列表"><i class="fa fa-check"></i>2.2.5 列表</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据的读入与写出"><i class="fa fa-check"></i>2.3 数据的读入与写出</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#使用键盘输入数据"><i class="fa fa-check"></i>2.3.1 使用键盘输入数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#从带分隔符的文本文件导入数据"><i class="fa fa-check"></i>2.3.2 从带分隔符的文本文件导入数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#导入excel数据"><i class="fa fa-check"></i>2.3.3 导入Excel数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#逐行读入数据"><i class="fa fa-check"></i>2.3.4 逐行读入数据</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据集管理及预处理"><i class="fa fa-check"></i>2.4 数据集管理及预处理</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#了解数据概况"><i class="fa fa-check"></i>2.4.1 了解数据概况</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#变量类型转换"><i class="fa fa-check"></i>2.4.2 变量类型转换</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#时间型数据的操作"><i class="fa fa-check"></i>2.4.3 时间型数据的操作</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据集合并"><i class="fa fa-check"></i>2.4.4 数据集合并</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据缺失异常"><i class="fa fa-check"></i>2.4.5 数据缺失、异常</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#习题答案"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.1"><i class="fa fa-check"></i>题目 2.1</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.2"><i class="fa fa-check"></i>题目 2.2</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.3"><i class="fa fa-check"></i>题目 2.3</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.4实训题目"><i class="fa fa-check"></i>题目 2.4（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.5-实训题目"><i class="fa fa-check"></i>题目 2.5 （实训题目）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i>第3章：基本统计分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#案例引入-1"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#基本描述统计量"><i class="fa fa-check"></i>3.1 基本描述统计量</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#频数统计"><i class="fa fa-check"></i>3.1.1 频数统计</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#均值"><i class="fa fa-check"></i>3.1.2 均值</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#分位数"><i class="fa fa-check"></i>3.1.3 分位数</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#方差和标准差"><i class="fa fa-check"></i>3.1.4 方差和标准差</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#最大值最小值"><i class="fa fa-check"></i>3.1.5 最大值、最小值</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#峰度和偏度"><i class="fa fa-check"></i>3.1.6 峰度和偏度</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#交叉分组下的频数分析"><i class="fa fa-check"></i>3.2 交叉分组下的频数分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#交叉列联表"><i class="fa fa-check"></i>3.2.1 交叉列联表</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#描述统计量的分组统计"><i class="fa fa-check"></i>3.2.2 描述统计量的分组统计</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#习题答案-1"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.1"><i class="fa fa-check"></i>题目 3.1</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.2"><i class="fa fa-check"></i>题目 3.2</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.3"><i class="fa fa-check"></i>题目 3.3</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.4"><i class="fa fa-check"></i>题目 3.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i>第4章：描述分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#案例引入-2"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#统计表格"><i class="fa fa-check"></i>4.1 统计表格</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#变量说明表"><i class="fa fa-check"></i>4.1.1 变量说明表</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#分组汇总统计表格"><i class="fa fa-check"></i>4.1.2 分组汇总统计表格</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#数据可视化基础"><i class="fa fa-check"></i>4.2 数据可视化基础</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#柱状图"><i class="fa fa-check"></i>4.2.2 柱状图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#饼图"><i class="fa fa-check"></i>4.2.3 饼图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#直方图"><i class="fa fa-check"></i>4.2.4 直方图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#折线图"><i class="fa fa-check"></i>4.2.5 折线图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#箱线图"><i class="fa fa-check"></i>4.2.6 箱线图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#散点图"><i class="fa fa-check"></i>4.2.7 散点图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#相关系数图"><i class="fa fa-check"></i>4.2.8 相关系数图</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#数据可视化进阶"><i class="fa fa-check"></i>4.3 数据可视化进阶</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#ggplot2-包"><i class="fa fa-check"></i>4.3.1 ggplot2 包</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#交互可视化"><i class="fa fa-check"></i>4.3.2 交互可视化</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#习题答案-2"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.3实训题目"><i class="fa fa-check"></i>题目 4.3（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.4实训题目"><i class="fa fa-check"></i>题目 4.4（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.5实训题目"><i class="fa fa-check"></i>题目 4.5（实训题目）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html"><i class="fa fa-check"></i>第5章：参数估计与假设检验</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例引入-3"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例一手机续航时间研究"><i class="fa fa-check"></i>案例一：手机续航时间研究</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例二减肥药疗效研究"><i class="fa fa-check"></i>案例二：减肥药疗效研究</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例三红楼梦作者争议"><i class="fa fa-check"></i>案例三：红楼梦作者争议</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#参数估计"><i class="fa fa-check"></i>5.2 参数估计</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#矩估计"><i class="fa fa-check"></i>5.2.1 矩估计</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#极大似然估计"><i class="fa fa-check"></i>5.2.2 极大似然估计</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#区间估计"><i class="fa fa-check"></i>5.2.3 区间估计</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#假设检验"><i class="fa fa-check"></i>5.3 假设检验</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#习题答案-3"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#题目-5.2"><i class="fa fa-check"></i>题目 5.2</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#题目-5.3"><i class="fa fa-check"></i>题目 5.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i>第6章：线性回归</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#案例引入-4"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#岗位学历要求对薪资水平是否有影响"><i class="fa fa-check"></i>岗位学历要求对薪资水平是否有影响</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#python和spss要求与否对薪资水平是否有影响"><i class="fa fa-check"></i>Python和SPSS要求与否对薪资水平是否有影响</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#模型实现"><i class="fa fa-check"></i>6.9 模型实现</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#实例分析"><i class="fa fa-check"></i>6.9.2 实例分析</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#习题答案-4"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#案例背景"><i class="fa fa-check"></i>案例背景</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.2"><i class="fa fa-check"></i>题目 6.2</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.3"><i class="fa fa-check"></i>题目 6.3</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.4"><i class="fa fa-check"></i>题目 6.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html"><i class="fa fa-check"></i>第7章：逻辑回归</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#案例引入-5"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#申请结果分布"><i class="fa fa-check"></i>申请结果分布</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#最热门的top10申请学校"><i class="fa fa-check"></i>最热门的top10申请学校</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#申请gpa对于结果的影响"><i class="fa fa-check"></i>申请GPA对于结果的影响</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#托福成绩对于申请结果的影响"><i class="fa fa-check"></i>托福成绩对于申请结果的影响</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#硬件条件对于不同学位申请的影响"><i class="fa fa-check"></i>硬件条件对于不同学位申请的影响</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#实例分析-1"><i class="fa fa-check"></i>7.5 实例分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#模型建立与选择"><i class="fa fa-check"></i>模型建立与选择</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#模型预测-1"><i class="fa fa-check"></i>模型预测</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#习题答案-5"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#案例背景-1"><i class="fa fa-check"></i>案例背景</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#题目-7.2"><i class="fa fa-check"></i>题目 7.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html"><i class="fa fa-check"></i>第8章：降维分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#案例引入-6"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#主成分分析"><i class="fa fa-check"></i>8.1 主成分分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#读入数据并绘制相关系数矩阵"><i class="fa fa-check"></i>读入数据并绘制相关系数矩阵</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#选择主成分个数"><i class="fa fa-check"></i>选择主成分个数</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#提取主成分与结果解读"><i class="fa fa-check"></i>提取主成分与结果解读</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#计算主成分得分"><i class="fa fa-check"></i>计算主成分得分</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#因子分析"><i class="fa fa-check"></i>8.2 因子分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#选择合适的公共因子数目"><i class="fa fa-check"></i>选择合适的公共因子数目</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#提取公共因子"><i class="fa fa-check"></i>提取公共因子</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#正交旋转"><i class="fa fa-check"></i>正交旋转</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#计算因子得分"><i class="fa fa-check"></i>计算因子得分</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#因子分析结果可视化选做"><i class="fa fa-check"></i>因子分析结果可视化（选做）</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#习题答案-6"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.1"><i class="fa fa-check"></i>题目 8.1</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.2"><i class="fa fa-check"></i>题目 8.2</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.3"><i class="fa fa-check"></i>题目 8.3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">统计分析与R语言（辅助材料）</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch6" class="section level1 unnumbered">
<h1>第6章：线性回归</h1>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="ch6.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 数据准备 </span><span class="al">###</span></span>
<span id="cb479-2"><a href="ch6.html#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 清空工作空间</span></span>
<span id="cb479-3"><a href="ch6.html#cb479-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div id="案例引入-4" class="section level2 unnumbered">
<h2>案例引入</h2>
<p>随着“互联网+”和大数据时代的到来，越来越多的数据科学公司如雨后春笋般涌现。传统行业也面临着“互联网+”时代下的创新转型，对于数据分析及相关领域有大量人才需求，各行各业与数据分析相关的招聘岗位越来越多。</p>
<p>在数据分析相关岗位的招聘中，合理定位岗位薪资，找出与岗位薪资挂钩的特殊技能尤其关键。在市场层面上，可以了解数据分析人才市场现状，合理化市场资源配置；在公司层面上，可以为公司招聘提供借鉴，为数据分析人才定制薪资提供参考；对于应聘者而言，能够更科学地进行职业测评，实现准确地自我定位；对于高校来说，能够明确学生的培养方向，优化应用统计及数据分析方向人才培养方案。</p>
<p>本案例使用数据分析岗位招聘薪酬数据集。该数据收集自各大招聘网站发布的数据分析岗位招聘的相关信息，共包含了6682条岗位招聘数据。数据集的每一列分别对应：岗位薪资、是否要求掌握R、SPSS、Excel、Python、MATLAB、Java、SQL、SAS、Stata、EViews、Spark、Hadoop、公司类别、公司规模、学历要求、工作经验、公司地点。数据变量说明表如下所示：</p>
<table>
<thead>
<tr class="header">
<th align="left">变量类型</th>
<th align="left">变量名称</th>
<th align="left">详细说明</th>
<th align="left">取值范围</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">因变量</td>
<td align="left">薪资</td>
<td align="left">单位：元／月</td>
<td align="left">1500-5000元</td>
</tr>
<tr class="even">
<td align="left">自变量</td>
<td align="left">软件要求</td>
<td align="left">R</td>
<td align="left">共2个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">SPSS</td>
<td align="left">共2个水平</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">Excel</td>
<td align="left">共2个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">Python</td>
<td align="left">共2个水平</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">MATLAB</td>
<td align="left">共2个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">Java</td>
<td align="left">共2个水平</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">SQL</td>
<td align="left">共2个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">SAS</td>
<td align="left">共2个水平</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">Stata</td>
<td align="left">共2个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">EViews</td>
<td align="left">共2个水平</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">Spark</td>
<td align="left">共2个水平</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">Hadoop</td>
<td align="left">共2个水平</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">公司类别</td>
<td align="left">共6个水平</td>
<td align="left">合资、外资、民营公司等</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">公司规模</td>
<td align="left">共6个水平</td>
<td align="left">少于50人、50-500人等</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">学历要求</td>
<td align="left">共7个水平</td>
<td align="left">无、中专、高中、大专等</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">工作经验</td>
<td align="left">单位：年</td>
<td align="left">0-10年</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">地区</td>
<td align="left">共2个水平</td>
<td align="left">北上深、非北上深</td>
</tr>
</tbody>
</table>
<p>读入数据，将数据命名为<code>jobinfo</code>，并绘制岗位薪资的频数直方图，解读图中的结果。</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="ch6.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb480-2"><a href="ch6.html#cb480-2" aria-hidden="true" tabindex="-1"></a>jobinfo <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/jobinfo_ch7.csv&quot;</span>, <span class="at">fileEncoding =</span> <span class="st">&quot;utf-8&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="ch6.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> jobinfo,<span class="fu">aes</span>(<span class="at">x=</span>aveSalary)) <span class="sc">+</span></span>
<span id="cb481-2"><a href="ch6.html#cb481-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2000</span>,<span class="at">fill=</span><span class="st">&quot;gold&quot;</span>) <span class="sc">+</span></span>
<span id="cb481-3"><a href="ch6.html#cb481-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;频数&quot;</span>,<span class="at">x =</span> <span class="st">&quot;岗位薪资&quot;</span>) <span class="sc">+</span></span>
<span id="cb481-4"><a href="ch6.html#cb481-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb481-5"><a href="ch6.html#cb481-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb481-6"><a href="ch6.html#cb481-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>),</span>
<span id="cb481-7"><a href="ch6.html#cb481-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb481-8"><a href="ch6.html#cb481-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6fivvpwj311c0qo75i.jpg" /></p>
<p>该数据中的因变量薪资呈右偏分布，如图所示。最高的月薪为19999.5元/月，对应的岗位是一个规模为1000-5000人的国企，这个岗位要求申请人有2年的工作经验。从整体情况来看，有75%的岗位月薪低于10000元。</p>
<div id="岗位学历要求对薪资水平是否有影响" class="section level3 unnumbered">
<h3>岗位学历要求对薪资水平是否有影响</h3>
<p>通过箱线图，探究岗位学历要求对薪资水平是否有影响。（提示：为了使得箱线图更加美观，可以对因变量取对数）</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="ch6.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 利用箱线图画出，学历vs对数平均薪资的分布，箱体的宽度越宽表示样本量越多</span></span>
<span id="cb482-2"><a href="ch6.html#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 将学历转化为因子型变量，便于画图</span></span>
<span id="cb482-3"><a href="ch6.html#cb482-3" aria-hidden="true" tabindex="-1"></a>jobinfo<span class="sc">$</span>学历要求 <span class="ot">=</span> <span class="fu">factor</span>(jobinfo<span class="sc">$</span>学历要求,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;中专&quot;</span>,<span class="st">&quot;高中&quot;</span>,<span class="st">&quot;大专&quot;</span>,<span class="st">&quot;无&quot;</span>,<span class="st">&quot;本科&quot;</span>,<span class="st">&quot;研究生&quot;</span>))</span>
<span id="cb482-4"><a href="ch6.html#cb482-4" aria-hidden="true" tabindex="-1"></a>jobinfo<span class="sc">$</span>对数薪资 <span class="ot">&lt;-</span> <span class="fu">log</span>(jobinfo<span class="sc">$</span>aveSalary)</span></code></pre></div>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="ch6.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制箱线图</span></span>
<span id="cb483-2"><a href="ch6.html#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jobinfo,<span class="fu">aes</span>(学历要求,对数薪资)) <span class="sc">+</span> </span>
<span id="cb483-3"><a href="ch6.html#cb483-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;grey&quot;</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="st">&quot;gold&quot;</span>,<span class="dv">2</span>))) <span class="sc">+</span> </span>
<span id="cb483-4"><a href="ch6.html#cb483-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;学历要求&quot;</span>, <span class="at">y =</span> <span class="st">&quot;对数薪资&quot;</span>)<span class="sc">+</span></span>
<span id="cb483-5"><a href="ch6.html#cb483-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb483-6"><a href="ch6.html#cb483-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb483-7"><a href="ch6.html#cb483-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>),</span>
<span id="cb483-8"><a href="ch6.html#cb483-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb483-9"><a href="ch6.html#cb483-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6fipn4uj311c0qo75l.jpg" /></p>
<p>从图中可以看到，在五种学历要求中，研究生学历的薪资中位数最高，达到了8999.75元，对应的对数薪资为9.10；其次为本科学历的岗位，达到了8999.50元；薪资水平最低的为中专学历，月薪仅有5249.50元。水平最高的学历岗位比最低的月薪高出了3750.25元，但是仅根据描述分析，我们仍然不能说明学历对薪资有统计意义上的显著影响。</p>
</div>
<div id="python和spss要求与否对薪资水平是否有影响" class="section level3 unnumbered">
<h3>Python和SPSS要求与否对薪资水平是否有影响</h3>
<p>通过箱线图，分别探究岗位对于Python和SPSS要求与否对薪资水平是否有影响。</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="ch6.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jobinfo,<span class="fu">aes</span>(<span class="fu">as.factor</span>(Python),对数薪资)) <span class="sc">+</span> </span>
<span id="cb484-2"><a href="ch6.html#cb484-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;gold&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb484-3"><a href="ch6.html#cb484-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;是否要求会使用Python&quot;</span>, <span class="at">y =</span> <span class="st">&quot;对数薪资&quot;</span>) <span class="sc">+</span></span>
<span id="cb484-4"><a href="ch6.html#cb484-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb484-5"><a href="ch6.html#cb484-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb484-6"><a href="ch6.html#cb484-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>),</span>
<span id="cb484-7"><a href="ch6.html#cb484-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb484-8"><a href="ch6.html#cb484-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6fiitvsj311c0qogmu.jpg" /></p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="ch6.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(jobinfo,<span class="fu">aes</span>(<span class="fu">as.factor</span>(SPSS),对数薪资)) <span class="sc">+</span> </span>
<span id="cb485-2"><a href="ch6.html#cb485-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;gold&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb485-3"><a href="ch6.html#cb485-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;是否要求会使用SPSS&quot;</span>, <span class="at">y =</span> <span class="st">&quot;对数薪资&quot;</span>) <span class="sc">+</span></span>
<span id="cb485-4"><a href="ch6.html#cb485-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb485-5"><a href="ch6.html#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb485-6"><a href="ch6.html#cb485-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STXihei&quot;</span>),</span>
<span id="cb485-7"><a href="ch6.html#cb485-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb485-8"><a href="ch6.html#cb485-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6fi62skj311c0qogmt.jpg" /></p>
<p>从数目上看，要求掌握Python的岗位占比为4.4%，要求掌握SPSS的岗位占比约为8.0%。从箱线图中可以看出，要求掌握这两种软件的薪资中位数均高于不要求掌握该软件的岗位。</p>
</div>
</div>
<div id="模型实现" class="section level2 unnumbered">
<h2>6.9 模型实现</h2>
<div id="实例分析" class="section level3 unnumbered">
<h3>6.9.2 实例分析</h3>
<div id="建立线性模型" class="section level4 unnumbered">
<h4>建立线性模型</h4>
<p>首先以岗位薪资为因变量，以地区、公司类别、公司规模、学历、经验要求以及12种软件需求为自变量，探求这些比变量对于薪资的影响，建立回归模型，并利用summary函数查看回归结果。</p>
<p>需要注意，在在建立回归模型之前，我们需要利用公司所在地、公司类别、公司规模、学历要求创建虚拟变量。回归时，公司类别以国企为基准，公司规模以少于50人为基准，学历以无为基准。</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="ch6.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据预处理</span></span>
<span id="cb486-2"><a href="ch6.html#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 转换为factor型变量，地区以河北为基准，公司类别以国企为基准，公司规模以少于50人为基准，学历以无为基准</span></span>
<span id="cb486-3"><a href="ch6.html#cb486-3" aria-hidden="true" tabindex="-1"></a>jobinfo<span class="sc">$</span>公司类别 <span class="ot">&lt;-</span> <span class="fu">factor</span>(jobinfo<span class="sc">$</span>公司类别, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;国企&quot;</span>,<span class="st">&quot;合资&quot;</span>,<span class="st">&quot;外资&quot;</span>,<span class="st">&quot;上市公司&quot;</span>,<span class="st">&quot;民营公司&quot;</span>,<span class="st">&quot;创业公司&quot;</span>))</span>
<span id="cb486-4"><a href="ch6.html#cb486-4" aria-hidden="true" tabindex="-1"></a>jobinfo<span class="sc">$</span>公司规模 <span class="ot">&lt;-</span> <span class="fu">factor</span>(jobinfo<span class="sc">$</span>公司规模, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;少于50人&quot;</span>,<span class="st">&quot;50-500人&quot;</span>,<span class="st">&quot;500-1000人&quot;</span>,<span class="st">&quot;1000-5000人&quot;</span>,<span class="st">&quot;5000-10000人&quot;</span>,<span class="st">&quot;10000人以上&quot;</span>))</span>
<span id="cb486-5"><a href="ch6.html#cb486-5" aria-hidden="true" tabindex="-1"></a>jobinfo<span class="sc">$</span>学历要求 <span class="ot">&lt;-</span> <span class="fu">factor</span>(jobinfo<span class="sc">$</span>学历要求, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;无&quot;</span>,<span class="st">&quot;中专&quot;</span>,<span class="st">&quot;高中&quot;</span>,<span class="st">&quot;大专&quot;</span>,<span class="st">&quot;本科&quot;</span>,<span class="st">&quot;研究生&quot;</span>))</span>
<span id="cb486-6"><a href="ch6.html#cb486-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-7"><a href="ch6.html#cb486-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 软件要求</span></span>
<span id="cb486-8"><a href="ch6.html#cb486-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>)){</span>
<span id="cb486-9"><a href="ch6.html#cb486-9" aria-hidden="true" tabindex="-1"></a>        jobinfo[,i] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(jobinfo[,i])</span>
<span id="cb486-10"><a href="ch6.html#cb486-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="ch6.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 建立线性模型</span></span>
<span id="cb487-2"><a href="ch6.html#cb487-2" aria-hidden="true" tabindex="-1"></a>lm.fit1 <span class="ot">=</span> <span class="fu">lm</span>(aveSalary <span class="sc">~</span> ., <span class="at">data =</span> jobinfo)</span>
<span id="cb487-3"><a href="ch6.html#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 查看回归结果</span></span>
<span id="cb487-4"><a href="ch6.html#cb487-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = aveSalary ~ ., data = jobinfo)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1865.1  -641.6  -195.7   273.3  5554.5 
## 
## Coefficients:
##                        Estimate Std. Error  t value Pr(&gt;|t|)    
## (Intercept)          -62896.002    276.009 -227.877  &lt; 2e-16 ***
## R1                      205.761     64.776    3.176  0.00150 ** 
## SPSS1                   -19.360     61.723   -0.314  0.75379    
## Excel1                  -34.835     29.203   -1.193  0.23297    
## Python1                  54.765     69.774    0.785  0.43255    
## MATLAB1                 -27.048     89.889   -0.301  0.76350    
## Java1                    12.031     76.836    0.157  0.87558    
## SQL1                    102.489     44.272    2.315  0.02064 *  
## SAS1                    -40.231     67.461   -0.596  0.55095    
## Stata1                  -82.045    241.677   -0.339  0.73426    
## EViews1                 102.239    250.519    0.408  0.68321    
## Spark1                  298.702    129.670    2.304  0.02128 *  
## Hadoop1                 306.007     98.323    3.112  0.00186 ** 
## 公司类别合资             30.636     70.275    0.436  0.66289    
## 公司类别外资             87.686     69.557    1.261  0.20748    
## 公司类别上市公司          4.525     78.609    0.058  0.95410    
## 公司类别民营公司         44.787     62.779    0.713  0.47562    
## 公司类别创业公司         66.105    119.654    0.552  0.58065    
## 公司规模50-500人          5.570     33.069    0.168  0.86625    
## 公司规模500-1000人      -63.772     44.522   -1.432  0.15209    
## 公司规模1000-5000人      74.593     46.486    1.605  0.10862    
## 公司规模5000-10000人    -25.742     82.536   -0.312  0.75513    
## 公司规模10000人以上     -56.940     68.158   -0.835  0.40351    
## 学历要求中专            165.548     81.233    2.038  0.04160 *  
## 学历要求高中            149.668     94.822    1.578  0.11452    
## 学历要求大专              6.266     36.342    0.172  0.86312    
## 学历要求本科             53.284     37.719    1.413  0.15780    
## 学历要求研究生          123.529     85.359    1.447  0.14790    
## 工作经验                 10.605      7.311    1.450  0.14700    
## 地区非北上深            465.629     32.353   14.392  &lt; 2e-16 ***
## 对数薪资               7958.636     30.330  262.403  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 921.6 on 6651 degrees of freedom
## Multiple R-squared:  0.9401, Adjusted R-squared:  0.9398 
## F-statistic:  3479 on 30 and 6651 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="模型诊断" class="section level4 unnumbered">
<h4>模型诊断</h4>
<p>对任务四中的模型进行诊断，找出可能存在的问题。</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="ch6.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 对线性模型进行回归诊断</span></span>
<span id="cb489-2"><a href="ch6.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 将画布分为2*2的4块</span></span>
<span id="cb489-3"><a href="ch6.html#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb489-4"><a href="ch6.html#cb489-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.fit1, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) </span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6fi1jljj311c0qoaec.jpg" /></p>
<p>左上图为残差与拟合值的散点图，若因变量和自变量呈现线性相关的关系，则残差值与拟合值没有任何的系统关联。图中所示残差并不随着拟合值的变化呈现规律性变化，因此基本满足线性假设；右上图为正态Q-Q图，当因变量服从正态分布时，图中的散点应该落在呈45度倾斜的直线上。根据图示，模型中的残差项在较大值的部分偏离直线，因此较大程度上偏离了正态分布；左下图为位置尺度图，若满足同方差假定，则水平线周围的点应呈现无规律随机分布，根据图中所示，随着拟合值增大，标准化残差呈现升高的规律，表明存在一定的异方差问题；右下图为样本点的库克距离，其最大值未超过0.05，因此认为样本中不存在异常点。</p>
</div>
<div id="模型修正与模型选择" class="section level4 unnumbered">
<h4>模型修正与模型选择</h4>
<p>可将因变量进行对数变换，重新拟合回归模型，使用BIC准则对变量进行选择，并对变量选择后的模型结果进行解读。</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="ch6.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 计算对数因变量</span></span>
<span id="cb490-2"><a href="ch6.html#cb490-2" aria-hidden="true" tabindex="-1"></a>jobinfo<span class="sc">$</span>对数薪资 <span class="ot">&lt;-</span> <span class="fu">log</span>(jobinfo<span class="sc">$</span>aveSalary)</span>
<span id="cb490-3"><a href="ch6.html#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 建立对数线性模型，剔除平均薪资变量</span></span>
<span id="cb490-4"><a href="ch6.html#cb490-4" aria-hidden="true" tabindex="-1"></a>lm.fit2 <span class="ot">=</span> <span class="fu">lm</span>(对数薪资 <span class="sc">~</span> .<span class="sc">-</span>aveSalary, <span class="at">data =</span> jobinfo)</span>
<span id="cb490-5"><a href="ch6.html#cb490-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 使用BIC准则选择模型</span></span>
<span id="cb490-6"><a href="ch6.html#cb490-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(jobinfo)</span>
<span id="cb490-7"><a href="ch6.html#cb490-7" aria-hidden="true" tabindex="-1"></a>lm.bic <span class="ot">&lt;-</span> <span class="fu">step</span>(lm.fit2, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> F)</span>
<span id="cb490-8"><a href="ch6.html#cb490-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.bic)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = 对数薪资 ~ SPSS + Excel + Python + SQL + Hadoop + 
##     学历要求 + 工作经验 + 地区, data = jobinfo)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.54248 -0.25992 -0.02571  0.25825  1.43138 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     8.827384   0.013680 645.276  &lt; 2e-16 ***
## SPSS1           0.092435   0.018706   4.941 7.94e-07 ***
## Excel1         -0.117721   0.011646 -10.108  &lt; 2e-16 ***
## Python1         0.110596   0.024510   4.512 6.53e-06 ***
## SQL1            0.160374   0.017389   9.223  &lt; 2e-16 ***
## Hadoop1         0.191131   0.030947   6.176 6.96e-10 ***
## 学历要求中专   -0.202515   0.032791  -6.176 6.97e-10 ***
## 学历要求高中   -0.223880   0.038146  -5.869 4.60e-09 ***
## 学历要求大专   -0.116834   0.014630  -7.986 1.63e-15 ***
## 学历要求本科    0.094769   0.015130   6.263 4.00e-10 ***
## 学历要求研究生  0.201863   0.034147   5.912 3.56e-09 ***
## 工作经验        0.084348   0.002766  30.496  &lt; 2e-16 ***
## 地区非北上深   -0.371999   0.011976 -31.061  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3732 on 6669 degrees of freedom
## Multiple R-squared:  0.3436, Adjusted R-squared:  0.3424 
## F-statistic: 290.9 on 12 and 6669 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li><p>在控制其他因素不变的情况下，对数据分析人员的工作经验年限要求每多一年，相应岗位的薪资就平均高出8.4%。</p></li>
<li><p>说明要求掌握Python的岗位，薪资平均比不要求掌握Python的岗位高出11.1%，这和任务三中的描述分析趋势是吻合的。</p></li>
<li><p>自变量“学历要求”的基准水平为“无”，那么“研究生”对应的系数0.202可解读为：要求研究生学历的岗位薪资平均比不要求任何学历的岗位高20.2%。</p></li>
</ul>
</div>
<div id="模型预测" class="section level4 unnumbered">
<h4>模型预测</h4>
<p>使用任务六得到的模型，对新样本的薪资水平进行预测。假设有一份北京市上市公司数据分析岗位的工作，该公司为1500人的中小型公司，这个工作要求申请人掌握R、Python、SQL和Hadoop的技能，并且有至少3年的工作经验，最低学历为硕士。希望通过模型预测该岗位的薪资。</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="ch6.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 新样本</span></span>
<span id="cb492-2"><a href="ch6.html#cb492-2" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">R =</span> <span class="dv">1</span>, <span class="at">SPSS =</span> <span class="dv">0</span>, <span class="at">Excel =</span> <span class="dv">0</span>, <span class="at">Python =</span> <span class="dv">1</span>, <span class="at">MATLAB =</span> <span class="dv">0</span>, <span class="at">Java =</span> <span class="dv">0</span>, <span class="at">SQL =</span> <span class="dv">1</span>, <span class="at">SAS =</span> <span class="dv">0</span>, <span class="at">Stata =</span> <span class="dv">0</span>, <span class="at">EViews =</span> <span class="dv">0</span>, <span class="at">Spark =</span> <span class="dv">0</span>, <span class="at">Hadoop =</span> <span class="dv">1</span>, 公司类别 <span class="ot">=</span> <span class="st">&quot;上市公司&quot;</span>, 公司规模 <span class="ot">=</span> <span class="st">&quot;1000-5000人&quot;</span>, 学历要求 <span class="ot">=</span> <span class="st">&quot;研究生&quot;</span>, 工作经验 <span class="ot">=</span> <span class="dv">3</span>, 地区 <span class="ot">=</span> <span class="st">&quot;北上深&quot;</span>)</span>
<span id="cb492-3"><a href="ch6.html#cb492-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 将软件技能转换为factor类型</span></span>
<span id="cb492-4"><a href="ch6.html#cb492-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)) {</span>
<span id="cb492-5"><a href="ch6.html#cb492-5" aria-hidden="true" tabindex="-1"></a>    testdata[,i] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testdata[,i])</span>
<span id="cb492-6"><a href="ch6.html#cb492-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb492-7"><a href="ch6.html#cb492-7" aria-hidden="true" tabindex="-1"></a>logsalary_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.bic, <span class="at">newdata =</span> testdata)  <span class="co"># 预测值</span></span>
<span id="cb492-8"><a href="ch6.html#cb492-8" aria-hidden="true" tabindex="-1"></a>sigma_hat2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(lm.bic<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>lm.bic<span class="sc">$</span>df.residual  <span class="co"># sigma^2估计值</span></span>
<span id="cb492-9"><a href="ch6.html#cb492-9" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fu">exp</span>(logsalary_hat <span class="sc">+</span> sigma_hat2<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># </span></span>
<span id="cb492-10"><a href="ch6.html#cb492-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;平均薪资水平约为&quot;</span>, <span class="fu">round</span>(y_hat, <span class="dv">2</span>), <span class="st">&quot;元/月&quot;</span>)</span></code></pre></div>
<pre><code>## 平均薪资水平约为 18288.72 元/月</code></pre>
<p>根据模型的预测结果，该工作岗位薪资约为18288.72元/月。</p>
</div>
</div>
</div>
<div id="习题答案-4" class="section level2 unnumbered">
<h2>习题答案</h2>
<div id="案例背景" class="section level3 unnumbered">
<h3>案例背景</h3>
<p>截至2016年5月25日的北京住宅年内交易数据显示，北京市已经全面进入二手房时代。二手房定价是二手房交易过程中重要的环节之一。若能根据住房的特征，更准确地估计价格，住房业主将会获得更准确的市场定位。</p>
<p>数据集<code>house.csv</code>为来自某二手房中介网站的北京在售二手房2016年5月的相关数据，共包括单位面积房价（price）、城区（CATE）、卧室数（bedrooms）、厅数（halls）、房屋面积（AREA）、楼层（floor）、是否临近地铁（subway）、是否是学区房（school）这几个变量。以房价为因变量，在R中建立普通线性回归模型，并对模型结果进行诊断。</p>
</div>
<div id="题目-6.2" class="section level3 unnumbered">
<h3>题目 6.2</h3>
<div id="数据读入与预处理" class="section level4" number="0.0.0.1">
<h4><span class="header-section-number">0.0.0.1</span> 数据读入与预处理</h4>
<p>读入数据，命名为<code>dat0</code>，并将“厅数”变量处理为“有厅”、“无厅”和“其他”三个等级。</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="ch6.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 清除工作环境</span></span>
<span id="cb494-2"><a href="ch6.html#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\014</span><span class="st">&quot;</span>)</span></code></pre></div>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="ch6.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb495-2"><a href="ch6.html#cb495-2" aria-hidden="true" tabindex="-1"></a>dat0 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/house.csv&quot;</span>,<span class="at">header=</span>T,<span class="at">fileEncoding =</span> <span class="st">&quot;utf-8&quot;</span>) <span class="co">#读入数据</span></span>
<span id="cb495-3"><a href="ch6.html#cb495-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 处理厅数</span></span>
<span id="cb495-4"><a href="ch6.html#cb495-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">dim</span>(dat0)[<span class="dv">1</span>]</span>
<span id="cb495-5"><a href="ch6.html#cb495-5" aria-hidden="true" tabindex="-1"></a>style<span class="ot">=</span><span class="fu">rep</span>(<span class="st">&quot;其他&quot;</span>,n)</span>
<span id="cb495-6"><a href="ch6.html#cb495-6" aria-hidden="true" tabindex="-1"></a>style[<span class="fu">which</span>(dat0<span class="sc">$</span>halls<span class="sc">==</span><span class="dv">0</span>)]<span class="ot">=</span><span class="st">&quot;无厅&quot;</span>        </span>
<span id="cb495-7"><a href="ch6.html#cb495-7" aria-hidden="true" tabindex="-1"></a>style[<span class="fu">which</span>(dat0<span class="sc">$</span>halls<span class="sc">&gt;</span><span class="dv">0</span>)]<span class="ot">=</span><span class="st">&quot;有厅&quot;</span>     </span>
<span id="cb495-8"><a href="ch6.html#cb495-8" aria-hidden="true" tabindex="-1"></a>style<span class="ot">=</span><span class="fu">factor</span>(style,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;无厅&quot;</span>,<span class="st">&quot;有厅&quot;</span>))</span>
<span id="cb495-9"><a href="ch6.html#cb495-9" aria-hidden="true" tabindex="-1"></a>dat0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dat0,style)  </span></code></pre></div>
</div>
<div id="模型的建立与诊断" class="section level4 unnumbered">
<h4>模型的建立与诊断</h4>
<p>以房价为因变量，建立普通线性回归模型，并对模型结果进行诊断。</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="ch6.html#cb496-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price<span class="sc">~</span>CATE<span class="sc">+</span>school<span class="sc">+</span>subway<span class="sc">+</span>style<span class="sc">+</span>floor<span class="sc">+</span>bedrooms<span class="sc">+</span>AREA,<span class="at">data=</span>dat0)</span>
<span id="cb496-2"><a href="ch6.html#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)            <span class="co">#回归结果展示</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ CATE + school + subway + style + floor + 
##     bedrooms + AREA, data = dat0)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.6695 -0.8872 -0.1489  0.7983  8.0933 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.758578   0.068679  83.848  &lt; 2e-16 ***
## CATE丰台    -2.311719   0.040003 -57.788  &lt; 2e-16 ***
## CATE朝阳    -1.567919   0.038929 -40.276  &lt; 2e-16 ***
## CATE海淀    -0.251785   0.038327  -6.569 5.21e-11 ***
## CATE石景山  -2.443042   0.045209 -54.039  &lt; 2e-16 ***
## CATE西城     1.262560   0.038791  32.548  &lt; 2e-16 ***
## school       1.183122   0.027768  42.607  &lt; 2e-16 ***
## subway       0.672102   0.030914  21.741  &lt; 2e-16 ***
## style有厅    0.171935   0.052748   3.260  0.00112 ** 
## floorlow     0.198526   0.027815   7.137 9.92e-13 ***
## floormiddle  0.152117   0.027142   5.605 2.12e-08 ***
## bedrooms     0.111101   0.020200   5.500 3.86e-08 ***
## AREA        -0.002780   0.000376  -7.393 1.51e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.427 on 16197 degrees of freedom
## Multiple R-squared:  0.5904, Adjusted R-squared:  0.5901 
## F-statistic:  1945 on 12 and 16197 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="ch6.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))           <span class="co">#画2*2的图</span></span>
<span id="cb498-2"><a href="ch6.html#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm1,<span class="at">which=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))      <span class="co">#模型诊断图，存在异方差现象，对因变量取对数</span></span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6fhsdcjj311c0qotdo.jpg" /></p>
<p>根据模型诊断结果可以看出，残差近似满足零均值假定，图中所示残差并不随着拟合值的变化呈现规律性变化，因此基本满足线性假设；右上图为正态Q-Q图，当因变量服从正态分布时，图中的散点应该落在呈45度倾斜的直线上。根据图示，模型中的残差项在较大值的部分偏离直线，因此一定程度上偏离了正态分布；左下图为位置尺度图，若满足同方差假定，则水平线周围的点应呈现无规律随机分布，根据图中所示，随着拟合值增大，标准化残差呈现升高的规律，表明存在一定的异方差问题；右下图为样本点的库克距离，其最大值未超过0.05，因此认为样本中不存在异常点。</p>
</div>
</div>
<div id="题目-6.3" class="section level3 unnumbered">
<h3>题目 6.3</h3>
<p>对于任务二中的数据，建立对数线性模型，并加入城区与学区的交互项，对系数进行解读。</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="ch6.html#cb499-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(price) <span class="sc">~</span> CATE <span class="sc">*</span> school <span class="sc">+</span> subway <span class="sc">+</span> style <span class="sc">+</span> floor <span class="sc">+</span> bedrooms <span class="sc">+</span> AREA, <span class="at">data =</span> dat0)   </span>
<span id="cb499-2"><a href="ch6.html#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)            <span class="co">#回归结果展示</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(price) ~ CATE * school + subway + style + floor + 
##     bedrooms + AREA, data = dat0)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.22784 -0.14546 -0.00519  0.14964  1.00392 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        1.687e+00  1.147e-02 147.117  &lt; 2e-16 ***
## CATE丰台          -4.037e-01  7.300e-03 -55.294  &lt; 2e-16 ***
## CATE朝阳          -2.283e-01  7.580e-03 -30.114  &lt; 2e-16 ***
## CATE海淀          -3.452e-02  8.320e-03  -4.149 3.36e-05 ***
## CATE石景山        -4.467e-01  7.988e-03 -55.915  &lt; 2e-16 ***
## CATE西城           1.710e-01  8.793e-03  19.449  &lt; 2e-16 ***
## school             1.906e-01  8.659e-03  22.009  &lt; 2e-16 ***
## subway             1.257e-01  4.934e-03  25.475  &lt; 2e-16 ***
## style有厅          2.709e-02  8.401e-03   3.225  0.00126 ** 
## floorlow           3.433e-02  4.426e-03   7.757 9.18e-15 ***
## floormiddle        2.638e-02  4.318e-03   6.110 1.02e-09 ***
## bedrooms           1.427e-02  3.216e-03   4.437 9.18e-06 ***
## AREA              -3.525e-04  5.987e-05  -5.888 3.99e-09 ***
## CATE丰台:school   -7.577e-02  2.534e-02  -2.990  0.00279 ** 
## CATE朝阳:school   -9.261e-02  1.357e-02  -6.826 9.07e-12 ***
## CATE海淀:school    1.703e-02  1.208e-02   1.410  0.15854    
## CATE石景山:school -3.706e-01  5.449e-02  -6.802 1.07e-11 ***
## CATE西城:school   -6.840e-03  1.229e-02  -0.556  0.57792    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2271 on 16192 degrees of freedom
## Multiple R-squared:  0.6112, Adjusted R-squared:  0.6108 
## F-statistic:  1497 on 17 and 16192 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>经过对数处理，异方差问题得到了极大改善；Cook距离表现正常，表明没有异常点。另外，模型仍然是显著的（F检验通过了），模型的拟合程度有略微上升（调整的<span class="math inline">\(R^2=0.6108\)</span>）。</p>
<p>当考虑了“城区×学区”的交互效应后，一个明显的变化是：学区变量系数估计变成负数。由于“城区”、“城区×学区”两个因素的基准组均为石景山区，因此对应的结论是：在石景山区，学区房比非学区房的单位面积房价低。可以从石景山区的学区房比例和学区资源等角度解释原因。</p>
<p>其他变量的解读示例：在保持其他变量不变的情况下，临近地铁的房价比不临近地铁的房价更贵；与高楼层的房源相比，中低楼层的二手房房价更高。</p>
</div>
<div id="题目-6.4" class="section level3 unnumbered">
<h3>题目 6.4</h3>
<p>使用BIC准则对任务三的模型进行选择，使用最终的模型进行新样本单位面积房价的预测。其中，预测样本为一间海淀区的两室一厅学区房，其在楼中的低楼层，并且临近地铁，房屋面积为70平方米。</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="ch6.html#cb501-1" aria-hidden="true" tabindex="-1"></a>lm3.bic <span class="ot">&lt;-</span> <span class="fu">step</span>(lm2, <span class="at">k =</span> <span class="fu">log</span>(<span class="fu">nrow</span>(dat0)), <span class="at">trace =</span> F)</span>
<span id="cb501-2"><a href="ch6.html#cb501-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CATE =</span> <span class="st">&quot;海淀&quot;</span>, <span class="at">bedrooms =</span> <span class="dv">2</span>, <span class="at">halls =</span> <span class="dv">1</span>, <span class="at">AREA =</span> <span class="dv">70</span>, <span class="at">floor =</span> <span class="st">&quot;low&quot;</span>, <span class="at">subway =</span> <span class="dv">1</span>, <span class="at">school =</span> <span class="dv">1</span>, <span class="at">style =</span> <span class="st">&quot;有厅&quot;</span>)</span>
<span id="cb501-3"><a href="ch6.html#cb501-3" aria-hidden="true" tabindex="-1"></a>logprice_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm3.bic, <span class="at">newdata =</span> newdata)  <span class="co"># 预测值</span></span>
<span id="cb501-4"><a href="ch6.html#cb501-4" aria-hidden="true" tabindex="-1"></a>sig_hat2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(lm3.bic<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>lm3.bic<span class="sc">$</span>df.residual  <span class="co"># sigma^2估计值</span></span>
<span id="cb501-5"><a href="ch6.html#cb501-5" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fu">exp</span>(logprice_hat <span class="sc">+</span> sig_hat2<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># </span></span>
<span id="cb501-6"><a href="ch6.html#cb501-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;单位面积房价约为&quot;</span>, <span class="fu">round</span>(y_hat, <span class="dv">2</span>), <span class="st">&quot;万元/平方米&quot;</span>)</span></code></pre></div>
<pre><code>## 单位面积房价约为 7.98 万元/平方米</code></pre>
<p>使用任务三中的模型可以得到，新样本的单位面积房价预测值约为7.98万元/平方米。</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch7.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-ch6.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
