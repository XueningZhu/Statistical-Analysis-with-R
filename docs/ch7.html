<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第7章：逻辑回归 | 统计分析（以R语言为工具）：辅助材料</title>
  <meta name="description" content="第7章：逻辑回归 | 统计分析（以R语言为工具）：辅助材料" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="第7章：逻辑回归 | 统计分析（以R语言为工具）：辅助材料" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="XueningZhu/Statistical-Analysis-with-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第7章：逻辑回归 | 统计分析（以R语言为工具）：辅助材料" />
  
  
  

<meta name="author" content="朱雪宁 &amp; 任怡萌" />


<meta name="date" content="2022-07-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch6.html"/>
<link rel="next" href="ch8.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i>第1章：统计分析与R语言</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i>第2章：R语言中的数据管理与预处理</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#案例引入"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#基本数据类型"><i class="fa fa-check"></i>2.1 基本数据类型</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数值型"><i class="fa fa-check"></i>2.1.1 数值型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#字符型"><i class="fa fa-check"></i>2.1.2 字符型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#逻辑型"><i class="fa fa-check"></i>2.1.3 逻辑型</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#因子型数据"><i class="fa fa-check"></i>2.1.4 因子型数据</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据结构"><i class="fa fa-check"></i>2.2 数据结构</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#向量"><i class="fa fa-check"></i>2.2.1 向量</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#矩阵"><i class="fa fa-check"></i>2.2.2 矩阵</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数组"><i class="fa fa-check"></i>2.2.3 数组</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据框"><i class="fa fa-check"></i>2.2.4 数据框</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#列表"><i class="fa fa-check"></i>2.2.5 列表</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据的读入与写出"><i class="fa fa-check"></i>2.3 数据的读入与写出</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#使用键盘输入数据"><i class="fa fa-check"></i>2.3.1 使用键盘输入数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#从带分隔符的文本文件导入数据"><i class="fa fa-check"></i>2.3.2 从带分隔符的文本文件导入数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#导入excel数据"><i class="fa fa-check"></i>2.3.3 导入Excel数据</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#逐行读入数据"><i class="fa fa-check"></i>2.3.4 逐行读入数据</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据集管理及预处理"><i class="fa fa-check"></i>2.4 数据集管理及预处理</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#了解数据概况"><i class="fa fa-check"></i>2.4.1 了解数据概况</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#变量类型转换"><i class="fa fa-check"></i>2.4.2 变量类型转换</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#时间型数据的操作"><i class="fa fa-check"></i>2.4.3 时间型数据的操作</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据集合并"><i class="fa fa-check"></i>2.4.4 数据集合并</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#数据缺失异常"><i class="fa fa-check"></i>2.4.5 数据缺失、异常</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#习题答案"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.1"><i class="fa fa-check"></i>题目 2.1</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.2"><i class="fa fa-check"></i>题目 2.2</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.3"><i class="fa fa-check"></i>题目 2.3</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.4实训题目"><i class="fa fa-check"></i>题目 2.4（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#题目-2.5-实训题目"><i class="fa fa-check"></i>题目 2.5 （实训题目）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i>第3章：基本统计分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#案例引入-1"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#基本描述统计量"><i class="fa fa-check"></i>3.1 基本描述统计量</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#频数统计"><i class="fa fa-check"></i>3.1.1 频数统计</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#均值"><i class="fa fa-check"></i>3.1.2 均值</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#分位数"><i class="fa fa-check"></i>3.1.3 分位数</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#方差和标准差"><i class="fa fa-check"></i>3.1.4 方差和标准差</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#最大值最小值"><i class="fa fa-check"></i>3.1.5 最大值、最小值</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#峰度和偏度"><i class="fa fa-check"></i>3.1.6 峰度和偏度</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#交叉分组下的频数分析"><i class="fa fa-check"></i>3.2 交叉分组下的频数分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#交叉列联表"><i class="fa fa-check"></i>3.2.1 交叉列联表</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#描述统计量的分组统计"><i class="fa fa-check"></i>3.2.2 描述统计量的分组统计</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#习题答案-1"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.1"><i class="fa fa-check"></i>题目 3.1</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.2"><i class="fa fa-check"></i>题目 3.2</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.3"><i class="fa fa-check"></i>题目 3.3</a></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#题目-3.4"><i class="fa fa-check"></i>题目 3.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i>第4章：描述分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#案例引入-2"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#统计表格"><i class="fa fa-check"></i>4.1 统计表格</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#变量说明表"><i class="fa fa-check"></i>4.1.1 变量说明表</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#分组汇总统计表格"><i class="fa fa-check"></i>4.1.2 分组汇总统计表格</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#数据可视化基础"><i class="fa fa-check"></i>4.2 数据可视化基础</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#柱状图"><i class="fa fa-check"></i>4.2.2 柱状图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#饼图"><i class="fa fa-check"></i>4.2.3 饼图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#直方图"><i class="fa fa-check"></i>4.2.4 直方图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#折线图"><i class="fa fa-check"></i>4.2.5 折线图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#箱线图"><i class="fa fa-check"></i>4.2.6 箱线图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#散点图"><i class="fa fa-check"></i>4.2.7 散点图</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#相关系数图"><i class="fa fa-check"></i>4.2.8 相关系数图</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#数据可视化进阶"><i class="fa fa-check"></i>4.3 数据可视化进阶</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#ggplot2-包"><i class="fa fa-check"></i>4.3.1 ggplot2 包</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#交互可视化"><i class="fa fa-check"></i>4.3.2 交互可视化</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#习题答案-2"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.3实训题目"><i class="fa fa-check"></i>题目 4.3（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.4实训题目"><i class="fa fa-check"></i>题目 4.4（实训题目）</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#题目-4.5实训题目"><i class="fa fa-check"></i>题目 4.5（实训题目）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html"><i class="fa fa-check"></i>第5章：参数估计与假设检验</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例引入-3"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例一手机续航时间研究"><i class="fa fa-check"></i>案例一：手机续航时间研究</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例二减肥药疗效研究"><i class="fa fa-check"></i>案例二：减肥药疗效研究</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#案例三红楼梦作者争议"><i class="fa fa-check"></i>案例三：红楼梦作者争议</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#参数估计"><i class="fa fa-check"></i>5.2 参数估计</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#矩估计"><i class="fa fa-check"></i>5.2.1 矩估计</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#极大似然估计"><i class="fa fa-check"></i>5.2.2 极大似然估计</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#区间估计"><i class="fa fa-check"></i>5.2.3 区间估计</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#假设检验"><i class="fa fa-check"></i>5.3 假设检验</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#习题答案-3"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#题目-5.2"><i class="fa fa-check"></i>题目 5.2</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#题目-5.3"><i class="fa fa-check"></i>题目 5.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i>第6章：线性回归</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#案例引入-4"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#岗位学历要求对薪资水平是否有影响"><i class="fa fa-check"></i>岗位学历要求对薪资水平是否有影响</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#python和spss要求与否对薪资水平是否有影响"><i class="fa fa-check"></i>Python和SPSS要求与否对薪资水平是否有影响</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#模型实现"><i class="fa fa-check"></i>6.9 模型实现</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#实例分析"><i class="fa fa-check"></i>6.9.2 实例分析</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#习题答案-4"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#案例背景"><i class="fa fa-check"></i>案例背景</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.2"><i class="fa fa-check"></i>题目 6.2</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.3"><i class="fa fa-check"></i>题目 6.3</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#题目-6.4"><i class="fa fa-check"></i>题目 6.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html"><i class="fa fa-check"></i>第7章：逻辑回归</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#案例引入-5"><i class="fa fa-check"></i>案例引入</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#申请结果分布"><i class="fa fa-check"></i>申请结果分布</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#最热门的top10申请学校"><i class="fa fa-check"></i>最热门的top10申请学校</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#申请gpa对于结果的影响"><i class="fa fa-check"></i>申请GPA对于结果的影响</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#托福成绩对于申请结果的影响"><i class="fa fa-check"></i>托福成绩对于申请结果的影响</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#硬件条件对于不同学位申请的影响"><i class="fa fa-check"></i>硬件条件对于不同学位申请的影响</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#实例分析-1"><i class="fa fa-check"></i>7.5 实例分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#模型建立与选择"><i class="fa fa-check"></i>模型建立与选择</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#模型预测-1"><i class="fa fa-check"></i>模型预测</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#习题答案-5"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#案例背景-1"><i class="fa fa-check"></i>案例背景</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#题目-7.2"><i class="fa fa-check"></i>题目 7.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html"><i class="fa fa-check"></i>第8章：降维分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#案例引入-6"><i class="fa fa-check"></i>案例引入</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#主成分分析"><i class="fa fa-check"></i>8.1 主成分分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#读入数据并绘制相关系数矩阵"><i class="fa fa-check"></i>读入数据并绘制相关系数矩阵</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#选择主成分个数"><i class="fa fa-check"></i>选择主成分个数</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#提取主成分与结果解读"><i class="fa fa-check"></i>提取主成分与结果解读</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#计算主成分得分"><i class="fa fa-check"></i>计算主成分得分</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#因子分析"><i class="fa fa-check"></i>8.2 因子分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#选择合适的公共因子数目"><i class="fa fa-check"></i>选择合适的公共因子数目</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#提取公共因子"><i class="fa fa-check"></i>提取公共因子</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#正交旋转"><i class="fa fa-check"></i>正交旋转</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#计算因子得分"><i class="fa fa-check"></i>计算因子得分</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#因子分析结果可视化选做"><i class="fa fa-check"></i>因子分析结果可视化（选做）</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#习题答案-6"><i class="fa fa-check"></i>习题答案</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.1"><i class="fa fa-check"></i>题目 8.1</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.2"><i class="fa fa-check"></i>题目 8.2</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#题目-8.3"><i class="fa fa-check"></i>题目 8.3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">统计分析（以R语言为工具）：辅助材料</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch7" class="section level1 unnumbered">
<h1>第7章：逻辑回归</h1>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="ch7.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 数据准备 </span><span class="al">###</span></span>
<span id="cb506-2"><a href="ch7.html#cb506-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 清空工作空间</span></span>
<span id="cb506-3"><a href="ch7.html#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div id="案例引入-5" class="section level2 unnumbered">
<h2>案例引入</h2>
<p>近十年来，出国留学已经列入越来越多的同学的“未来规划清单”，根据教育部数据，2018年在我国出国留学人数66.21万人，同比增长8.83%。其中，自费留学人数占比最多，达59.63万人，占总留学人数的90%，国家公派3.02万人，单位公派3.56万人。从留学生选择留学国家/地区来看，留学目的地选择多样化，美国依旧是留学人群最喜欢的留学国家，英国增幅明显。数据显示，2019年留学生选择美国的人数占比下滑，为43%。而选择英国的群体占比在2019年大幅上升，占比41%，同美国差距正在缩小。但是，留学申请本身不是一件容易的事——不仅需要准备文书、英文考试，还要从上百个学校列表中选出合适自己的高校。若能最有效地提升背景，就更有可能获得“dream school”录取。</p>
<p>本章使用一个留学申请数据集，该数据来自某留学申请论坛的录取汇报结果，包含了15908条申请者的申请学校及录取与否信息。变量数据说明表如下所示：</p>
<table>
<thead>
<tr class="header">
<th align="left">变量类型</th>
<th align="left"></th>
<th align="left">变量名</th>
<th align="left">详细说明</th>
<th align="left">取值范围</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">因变量</td>
<td align="left"></td>
<td align="left">申请结果</td>
<td align="left">定性变量</td>
<td align="left">3个水平：拒绝(rej)、录取(offer/ad)、候补(waiting list)</td>
</tr>
<tr class="even">
<td align="left">自变量</td>
<td align="left">基础信息</td>
<td align="left">编号</td>
<td align="left">连续变量</td>
<td align="left">[14, 38183]</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">作者</td>
<td align="left">文本数据</td>
<td align="left">例：leucocyte, yycenty</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">时间</td>
<td align="left">连续变量</td>
<td align="left">[2010, 2019]</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">申请信息</td>
<td align="left">申请学校所属国家和地区</td>
<td align="left">定性变量</td>
<td align="left">8个水平：美国、澳洲、欧洲等</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">申请季节</td>
<td align="left">定性变量</td>
<td align="left">2个水平：fall（秋季）、spring（春季）</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">申请类型</td>
<td align="left">定性变量</td>
<td align="left">3个水平：PhD（博士）、MS（硕士）、混合</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">申请院校</td>
<td align="left">定性变量</td>
<td align="left">2431个水平：Yale University、Duke University等</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">申请专业</td>
<td align="left">定性变量</td>
<td align="left">34个水平：Accounting、Bio、CS等</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">学校-专业录取率</td>
<td align="left">连续变量</td>
<td align="left">[0, 1]</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">申请学校是否为top 50</td>
<td align="left">定性变量</td>
<td align="left">2个水平：0为否，1为是</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">原学校信息</td>
<td align="left">申请前是否研究生毕业</td>
<td align="left">定性变量</td>
<td align="left">2个水平：0为否，1为是</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">原院校</td>
<td align="left">定性变量</td>
<td align="left">1359个水平：青岛大学、北京大学等</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">原专业</td>
<td align="left">定性变量</td>
<td align="left">1915个水平：自动化、信息工程等</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">是否转专业</td>
<td align="left">定性变量</td>
<td align="left">2个水平：0为否，1为是</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">其它背景</td>
<td align="left">文本数据</td>
<td align="left">例：4篇sci论文</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">成绩信息</td>
<td align="left">托福成绩</td>
<td align="left">连续变量</td>
<td align="left">[70, 119]</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">GRE总成绩</td>
<td align="left">连续变量</td>
<td align="left">新：[208, 340]，老：[512, 760]</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">GRE Verbal成绩</td>
<td align="left">连续变量</td>
<td align="left">新：[135, 170]，老：[370, 760]</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">GRE Quantitative成绩</td>
<td align="left">连续变量</td>
<td align="left">新：[147, 180]，老：[730, 800]</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">GRE 写作成绩</td>
<td align="left">连续变量</td>
<td align="left">新：[1.5, 8]，老：[170, 1190]</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">GRE sub分数</td>
<td align="left">文本数据</td>
<td align="left">例：Math 880 (94%)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">GPA</td>
<td align="left">连续变量</td>
<td align="left">[1, 95]</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">GPA算法</td>
<td align="left">定性变量</td>
<td align="left">3个水平：100、4.3、4</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">拓展信息</td>
<td align="left">是否有牛推</td>
<td align="left">定性变量</td>
<td align="left">2个水平：0为否，1为是</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">是否有实习</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">是否有科研</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">是否有发表论文</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">是否以第一作者发表论文</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">是否有SCI论文</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">是否有交流经历</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="ch7.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 设置绘图主题</span></span>
<span id="cb507-2"><a href="ch7.html#cb507-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb507-3"><a href="ch7.html#cb507-3" aria-hidden="true" tabindex="-1"></a>plot_theme_pie <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-4"><a href="ch7.html#cb507-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-5"><a href="ch7.html#cb507-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">236</span>, <span class="dv">241</span>, <span class="dv">249</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-6"><a href="ch7.html#cb507-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">236</span>, <span class="dv">241</span>, <span class="dv">249</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-7"><a href="ch7.html#cb507-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">236</span>, <span class="dv">241</span>, <span class="dv">249</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-8"><a href="ch7.html#cb507-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb507-9"><a href="ch7.html#cb507-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>,<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb507-10"><a href="ch7.html#cb507-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>,<span class="at">size =</span> <span class="dv">11</span>))   <span class="co"># 饼图绘制主题</span></span>
<span id="cb507-11"><a href="ch7.html#cb507-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 设置绘图主题</span></span>
<span id="cb507-12"><a href="ch7.html#cb507-12" aria-hidden="true" tabindex="-1"></a>plot_theme <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-13"><a href="ch7.html#cb507-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-14"><a href="ch7.html#cb507-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,<span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>),</span>
<span id="cb507-15"><a href="ch7.html#cb507-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>) ,</span>
<span id="cb507-16"><a href="ch7.html#cb507-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>) ,</span>
<span id="cb507-17"><a href="ch7.html#cb507-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">236</span>, <span class="dv">241</span>, <span class="dv">249</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-18"><a href="ch7.html#cb507-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>),</span>
<span id="cb507-19"><a href="ch7.html#cb507-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb507-20"><a href="ch7.html#cb507-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="fu">rgb</span>(<span class="dv">236</span>, <span class="dv">241</span>, <span class="dv">249</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)),</span>
<span id="cb507-21"><a href="ch7.html#cb507-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb507-22"><a href="ch7.html#cb507-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>,<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb507-23"><a href="ch7.html#cb507-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>,<span class="at">size =</span> <span class="dv">11</span>))   <span class="co"># 其他图形绘制主题</span></span></code></pre></div>
<div id="申请结果分布" class="section level3 unnumbered">
<h3>申请结果分布</h3>
<p>读入数据<code>Data_Cleaning.csv</code>，命名为<code>descriptive</code>，将数据按照变量 index_origin（原始编号）由小到大排序。查看变量 offertype（录取结果） 的类型。为简化研究，将录取类型”AD小奖”、“Offer”、“AD无奖”统一为 “Admitted”，将录取类型”Rej”修改为”Rejected”，并删去缺失录取结果的样本。根据录取结果绘制饼状图，描述你观察到的结果。</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="ch7.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 读入数据</span></span>
<span id="cb508-2"><a href="ch7.html#cb508-2" aria-hidden="true" tabindex="-1"></a>descriptive <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/Data_Cleaning.csv&quot;</span>, <span class="at">header =</span> T, <span class="at">stringsAsFactors =</span> F) <span class="co"># 读取原始数据</span></span>
<span id="cb508-3"><a href="ch7.html#cb508-3" aria-hidden="true" tabindex="-1"></a>descriptive <span class="ot">&lt;-</span> descriptive[<span class="fu">order</span>(descriptive<span class="sc">$</span>index_origin),]  <span class="co"># 将数据按照变量index_origin（原始编号）排序</span></span>
<span id="cb508-4"><a href="ch7.html#cb508-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-5"><a href="ch7.html#cb508-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 调整变量类型</span></span>
<span id="cb508-6"><a href="ch7.html#cb508-6" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>offertype[descriptive<span class="sc">$</span>offertype <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AD小奖&quot;</span>, <span class="st">&quot;Offer&quot;</span>, <span class="st">&quot;AD无奖&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Admitted&quot;</span>    <span class="co"># 不考虑奖学金，均归入“Admitted“（录取）</span></span>
<span id="cb508-7"><a href="ch7.html#cb508-7" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>offertype[descriptive<span class="sc">$</span>offertype <span class="sc">==</span> <span class="st">&quot;Rej&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Rejected&quot;</span>   </span>
<span id="cb508-8"><a href="ch7.html#cb508-8" aria-hidden="true" tabindex="-1"></a>descriptive <span class="ot">&lt;-</span> descriptive[ <span class="sc">-</span> <span class="fu">which</span>(descriptive<span class="sc">$</span>offertype <span class="sc">==</span> <span class="st">&quot;&quot;</span>),]   <span class="co"># 删去缺失录取结果的样本</span></span></code></pre></div>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="ch7.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 绘制饼状图</span></span>
<span id="cb509-2"><a href="ch7.html#cb509-2" aria-hidden="true" tabindex="-1"></a>(piechart1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(descriptive, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">fill =</span> <span class="fu">factor</span>(descriptive<span class="sc">$</span>offertype))) <span class="sc">+</span></span>
<span id="cb509-3"><a href="ch7.html#cb509-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb509-4"><a href="ch7.html#cb509-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;申请结果&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;skyblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb509-5"><a href="ch7.html#cb509-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb509-6"><a href="ch7.html#cb509-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">title =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">录取类型&quot;</span>) <span class="sc">+</span></span>
<span id="cb509-7"><a href="ch7.html#cb509-7" aria-hidden="true" tabindex="-1"></a>    plot_theme_pie)</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6lq25o9j311c0qotay.jpg" /></p>
<p>数据中，录取的案例占一半以上，其中包括无奖录取、小奖录取和全奖录取，拒绝的申请占比为27.6%，还有少部分申请结果为Waiting List。在后续的建模中，将把Waiting List划分为拒绝类别。</p>
</div>
<div id="最热门的top10申请学校" class="section level3 unnumbered">
<h3>最热门的top10申请学校</h3>
<p>我们先来看热门的申请学校（college_apply）。由于数据存在错误，我们需要对申请学校这一变量进行简单修正：将学校名”Texas A”、“M University”替换”Texas A&amp;M University”，将”Washington University in St”、” Louis”替换为”Washington University in St. Louis”。随后，为了统一申请学校名称，我们要将学校缩写替换为全称，得到的新变量<code>College_apply_new</code> 并入原数据（注意：不考虑缩写字母的大小写差异，需要借助文件<code>美国大学缩写汇总.txt</code>）。根据统一后的学校名称，找出申请人数最多的10所热门学校。</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="ch7.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 修正数据</span></span>
<span id="cb510-2"><a href="ch7.html#cb510-2" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>college_apply[descriptive<span class="sc">$</span>college_apply <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Texas A&quot;</span>, <span class="st">&quot;M University&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Texas A&amp;M University&quot;</span></span>
<span id="cb510-3"><a href="ch7.html#cb510-3" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>college_apply[descriptive<span class="sc">$</span>college_apply <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Washington University in St&quot;</span>, <span class="st">&quot; Louis&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Washington University in St. Louis&quot;</span></span>
<span id="cb510-4"><a href="ch7.html#cb510-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-5"><a href="ch7.html#cb510-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 统一学校名称</span></span>
<span id="cb510-6"><a href="ch7.html#cb510-6" aria-hidden="true" tabindex="-1"></a>SuoXie <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;./data/美国大学缩写汇总.txt&quot;</span>, <span class="at">header =</span> T)  <span class="co"># 读入常见的美国大学缩写汇总</span></span>
<span id="cb510-7"><a href="ch7.html#cb510-7" aria-hidden="true" tabindex="-1"></a>college_apply_new <span class="ot">&lt;-</span> <span class="cn">NULL</span>                                 <span class="co"># 设置初始值</span></span>
<span id="cb510-8"><a href="ch7.html#cb510-8" aria-hidden="true" tabindex="-1"></a>college_low <span class="ot">&lt;-</span> <span class="fu">tolower</span>(descriptive<span class="sc">$</span>college_apply)         <span class="co"># 不考虑大小写差异（下同）</span></span>
<span id="cb510-9"><a href="ch7.html#cb510-9" aria-hidden="true" tabindex="-1"></a>suoxie_low <span class="ot">&lt;-</span> <span class="fu">tolower</span>(SuoXie<span class="sc">$</span>ysuoxie)</span>
<span id="cb510-10"><a href="ch7.html#cb510-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(descriptive)[<span class="dv">1</span>]){                          <span class="co"># 统一全称和缩写</span></span>
<span id="cb510-11"><a href="ch7.html#cb510-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (college_low[i] <span class="sc">%in%</span> suoxie_low) {</span>
<span id="cb510-12"><a href="ch7.html#cb510-12" aria-hidden="true" tabindex="-1"></a>    college_apply_new[i] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(SuoXie<span class="sc">$</span>yquancheng[suoxie_low <span class="sc">%in%</span> college_low[i]]) </span>
<span id="cb510-13"><a href="ch7.html#cb510-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> college_apply_new[i] <span class="ot">&lt;-</span> descriptive<span class="sc">$</span>college_apply[i]</span>
<span id="cb510-14"><a href="ch7.html#cb510-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb510-15"><a href="ch7.html#cb510-15" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>College_apply_new <span class="ot">&lt;-</span> college_apply_new        <span class="co"># 统一学校名称后的新变量</span></span>
<span id="cb510-16"><a href="ch7.html#cb510-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-17"><a href="ch7.html#cb510-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 找出10大热门学校</span></span>
<span id="cb510-18"><a href="ch7.html#cb510-18" aria-hidden="true" tabindex="-1"></a>(top10_college_apply <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(descriptive<span class="sc">$</span>College_apply_new),</span>
<span id="cb510-19"><a href="ch7.html#cb510-19" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">decreasing =</span> T)[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)]))</span></code></pre></div>
<pre><code>##  [1] &quot;University of California&quot;                   &quot;Carnegie Mellon University&quot;                
##  [3] &quot;University of Southern California&quot;          &quot;Columbia University&quot;                       
##  [5] &quot;University of Pennsylvania&quot;                 &quot;Northeastern University&quot;                   
##  [7] &quot;University of Illinois at Urbana-Champaign&quot; &quot;University of Michigan&quot;                    
##  [9] &quot;Cornell University&quot;                         &quot;Texas A&amp;M University&quot;</code></pre>
</div>
<div id="申请gpa对于结果的影响" class="section level3 unnumbered">
<h3>申请GPA对于结果的影响</h3>
<p>找到10所热门学校后，下一步探究这些学校的录取情况。注意：为简化后续分析，<strong>删掉所有录取结果为 WaitingList 的样本，只保留15908条数据</strong>。</p>
<p>GPA（标准化考试成绩）是申请的关键之一。用变量<code>gpa</code>除以分制变量<code>gpa_measure</code>，再乘以4.0，可以将GPA标准化为四分制，得到新变量<code>Standardgap</code>并入原数据。考虑到不同排名的学校对学生成绩的要求差异，对申请学校进行排名划分。读入“QS大学排名前百（美国）.txt”，数据集前19所学校是世界前五十名的美国名校，据此将所有申请学校划分为”Top50”和”Others”两类，得到因子型的新变量<code>CollegeRankTop50</code>并入原数据。</p>
<p>接着，考查学业成绩<code>Standardgap</code>和学校排名<code>CollegeRankTop50</code>对录取结果的影响。绘制成绩与申请结果箱线图，并谈谈你的发现。注意，从现实出发，<strong>只画出Standardgap&gt;2.0的样本</strong>。</p>
<p>最后，将成绩划分为”&lt;=3.4”, “3.4-3.55”, “3.55-3.7”, “&gt;3.7”四类，得到新变量<code>gpa_dis</code>并入原数据。</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="ch7.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 为简化后续分析，删掉录取结果为 WaitingList 的样本</span></span>
<span id="cb512-2"><a href="ch7.html#cb512-2" aria-hidden="true" tabindex="-1"></a>descriptive <span class="ot">&lt;-</span> descriptive[<span class="sc">-</span><span class="fu">which</span>(descriptive<span class="sc">$</span>offertype <span class="sc">==</span> <span class="st">&quot;WaitingList&quot;</span>),]</span>
<span id="cb512-3"><a href="ch7.html#cb512-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-4"><a href="ch7.html#cb512-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 按学校名称匹配大学排名</span></span>
<span id="cb512-5"><a href="ch7.html#cb512-5" aria-hidden="true" tabindex="-1"></a>universities <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;./data/QS大学排名前百（美国）.txt&quot;</span>,<span class="at">header =</span> F, <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">$</span>V1     <span class="co"># 读入QS世界大学排名</span></span>
<span id="cb512-6"><a href="ch7.html#cb512-6" aria-hidden="true" tabindex="-1"></a>top50university <span class="ot">&lt;-</span> <span class="cn">NULL</span>   <span class="co"># 变量初始化</span></span>
<span id="cb512-7"><a href="ch7.html#cb512-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(descriptive)[<span class="dv">1</span>]){                      </span>
<span id="cb512-8"><a href="ch7.html#cb512-8" aria-hidden="true" tabindex="-1"></a>  top50university[i] <span class="ot">&lt;-</span> descriptive<span class="sc">$</span>College_apply_new[i] <span class="sc">%in%</span> universities[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]  <span class="co"># 共19所美国名校进入世界前五十名</span></span>
<span id="cb512-9"><a href="ch7.html#cb512-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb512-10"><a href="ch7.html#cb512-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-11"><a href="ch7.html#cb512-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 整理变量</span></span>
<span id="cb512-12"><a href="ch7.html#cb512-12" aria-hidden="true" tabindex="-1"></a>collegerank <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;Others&quot;</span>,<span class="fu">dim</span>(descriptive)[<span class="dv">1</span>])     </span>
<span id="cb512-13"><a href="ch7.html#cb512-13" aria-hidden="true" tabindex="-1"></a>collegerank[top50university] <span class="ot">&lt;-</span> <span class="st">&quot;Top50&quot;</span>                      <span class="co"># 大学排名前50</span></span>
<span id="cb512-14"><a href="ch7.html#cb512-14" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>CollegeRankTop50 <span class="ot">&lt;-</span> collegerank                  <span class="co"># 并入原数据</span></span>
<span id="cb512-15"><a href="ch7.html#cb512-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-16"><a href="ch7.html#cb512-16" aria-hidden="true" tabindex="-1"></a><span class="do">## gpa标准化</span></span>
<span id="cb512-17"><a href="ch7.html#cb512-17" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>Standardgap <span class="ot">&lt;-</span> (descriptive<span class="sc">$</span>gpa<span class="sc">/</span>descriptive<span class="sc">$</span>gpa_measure)<span class="sc">*</span><span class="dv">4</span>      <span class="co"># 将gpa统一整理为4分制</span></span>
<span id="cb512-18"><a href="ch7.html#cb512-18" aria-hidden="true" tabindex="-1"></a>gpa_offertype <span class="ot">&lt;-</span> descriptive[, <span class="fu">c</span>(<span class="st">&quot;Standardgap&quot;</span>, <span class="st">&quot;offertype&quot;</span>, <span class="st">&quot;CollegeRankTop50&quot;</span>)]  </span>
<span id="cb512-19"><a href="ch7.html#cb512-19" aria-hidden="true" tabindex="-1"></a>gpa_offertype<span class="sc">$</span>offertype <span class="ot">&lt;-</span> <span class="fu">factor</span>(gpa_offertype<span class="sc">$</span>offertype, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Admitted&quot;</span>, <span class="st">&quot;Rejected&quot;</span>),</span>
<span id="cb512-20"><a href="ch7.html#cb512-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;录取&quot;</span>,<span class="st">&quot;被拒&quot;</span>))                 <span class="co">#  调整因子水平</span></span>
<span id="cb512-21"><a href="ch7.html#cb512-21" aria-hidden="true" tabindex="-1"></a>gpa_offertype<span class="sc">$</span>CollegeRankTop50 <span class="ot">&lt;-</span> <span class="fu">factor</span>(gpa_offertype<span class="sc">$</span>CollegeRankTop50, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Top50&quot;</span>,<span class="st">&quot;Others&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="ch7.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 画图</span></span>
<span id="cb513-2"><a href="ch7.html#cb513-2" aria-hidden="true" tabindex="-1"></a>(boxplot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_offertype, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(CollegeRankTop50), <span class="at">y =</span> Standardgap, <span class="at">fill =</span> <span class="fu">factor</span>(offertype))) <span class="sc">+</span></span>
<span id="cb513-3"><a href="ch7.html#cb513-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> T, <span class="at">varwidth =</span> T) <span class="sc">+</span></span>
<span id="cb513-4"><a href="ch7.html#cb513-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">&quot;申请结果&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;gold&quot;</span>)) <span class="sc">+</span>    <span class="co"># 按照申请结果填色 </span></span>
<span id="cb513-5"><a href="ch7.html#cb513-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.2</span>))<span class="sc">+</span>     <span class="co"># 不考虑gpa&lt;2.0的样本</span></span>
<span id="cb513-6"><a href="ch7.html#cb513-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;申请学校的世界排名&quot;</span>, <span class="at">y =</span> <span class="st">&quot;GPA&quot;</span>, <span class="at">title =</span> <span class="st">&quot;成绩与申请结果&quot;</span>) <span class="sc">+</span></span>
<span id="cb513-7"><a href="ch7.html#cb513-7" aria-hidden="true" tabindex="-1"></a>    plot_theme)</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6lpwxtgj311c0qo0uw.jpg" /></p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="ch7.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 成绩分段</span></span>
<span id="cb514-2"><a href="ch7.html#cb514-2" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>gpa_dis <span class="ot">&lt;-</span> <span class="fu">cut</span>(descriptive<span class="sc">$</span>Standardgap, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.4</span>, <span class="fl">3.55</span>, <span class="fl">3.7</span>, <span class="cn">Inf</span>),</span>
<span id="cb514-3"><a href="ch7.html#cb514-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=3.4&quot;</span>, <span class="st">&quot;3.4~3.55&quot;</span>, <span class="st">&quot;3.55~3.7&quot;</span>, <span class="st">&quot;&gt;3.7&quot;</span>))</span></code></pre></div>
<p>结论：申请 Top50 学校时，录取的学生平均GPA（中位数）较高。申请其他学校时，GPA差异不明显。而从波动程度来看，无论是申请Top50还是其他学校，录取同学的GPA的差异都比未录取的GPA差异大，说明高GPA不一定是录取的必要因素。</p>
</div>
<div id="托福成绩对于申请结果的影响" class="section level3 unnumbered">
<h3>托福成绩对于申请结果的影响</h3>
<p>托福成绩也是申请时至关重要的一环。将变量<code>toefl</code>转化为数值变量，随后划分为”&lt;=98”, “98-102”, “102-106”, “&gt;106”四个分数段，得到因子型的新变量<code>toefl_dis</code>并入数据。计算不同排名的学校在各分数段的录取率，绘制复式条形图。注意标注出录取率百分数，并添加一条平均录取率作为参考线。从图中你能得到什么结论？</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="ch7.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 整理托福成绩</span></span>
<span id="cb515-2"><a href="ch7.html#cb515-2" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>toefl <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(descriptive<span class="sc">$</span>toefl)    <span class="co"># 将托福成绩信息变为数值型</span></span>
<span id="cb515-3"><a href="ch7.html#cb515-3" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>toefl_dis <span class="ot">&lt;-</span> <span class="fu">cut</span>(descriptive<span class="sc">$</span>toefl, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">98</span>, <span class="dv">102</span>, <span class="dv">106</span>, <span class="cn">Inf</span>),</span>
<span id="cb515-4"><a href="ch7.html#cb515-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=98&quot;</span>, <span class="st">&quot;98~102&quot;</span>, <span class="st">&quot;102~106&quot;</span>, <span class="st">&quot;&gt;106&quot;</span>))</span>
<span id="cb515-5"><a href="ch7.html#cb515-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-6"><a href="ch7.html#cb515-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 计算录取率</span></span>
<span id="cb515-7"><a href="ch7.html#cb515-7" aria-hidden="true" tabindex="-1"></a>ifadmitted <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(descriptive<span class="sc">$</span>offertype <span class="sc">==</span> <span class="st">&quot;Admitted&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb515-8"><a href="ch7.html#cb515-8" aria-hidden="true" tabindex="-1"></a>admittedPct <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ifadmitted, <span class="fu">list</span>(descriptive<span class="sc">$</span>toefl_dis, descriptive<span class="sc">$</span>CollegeRankTop50), mean)</span>
<span id="cb515-9"><a href="ch7.html#cb515-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(admittedPct) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TOEFL&quot;</span>,<span class="st">&quot;学校排名&quot;</span>,<span class="st">&quot;admittedpct&quot;</span>)</span>
<span id="cb515-10"><a href="ch7.html#cb515-10" aria-hidden="true" tabindex="-1"></a>admittedPct<span class="sc">$</span>学校排名 <span class="ot">&lt;-</span> <span class="fu">factor</span>(admittedPct<span class="sc">$</span>学校排名,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Top50&quot;</span>,<span class="st">&quot;Others&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="ch7.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 画图</span></span>
<span id="cb516-2"><a href="ch7.html#cb516-2" aria-hidden="true" tabindex="-1"></a>(barplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(admittedPct, <span class="fu">aes</span>(TOEFL, admittedpct, <span class="at">fill =</span> 学校排名)) <span class="sc">+</span> </span>
<span id="cb516-3"><a href="ch7.html#cb516-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="at">position=</span><span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb516-4"><a href="ch7.html#cb516-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;学校排名&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;gold&quot;</span>)) <span class="sc">+</span>    <span class="co"># 按照申请结果填色 </span></span>
<span id="cb516-5"><a href="ch7.html#cb516-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">title=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">不同托福成绩的平均录取率&quot;</span>) <span class="sc">+</span></span>
<span id="cb516-6"><a href="ch7.html#cb516-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(admittedPct[<span class="fu">order</span>(admittedPct<span class="sc">$</span>TOEFL), <span class="dv">3</span>], <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>, <span class="at">sep=</span><span class="st">&#39;&#39;</span>), </span>
<span id="cb516-7"><a href="ch7.html#cb516-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="dv">1</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span> <span class="fl">0.8</span>)  <span class="sc">+</span></span>
<span id="cb516-8"><a href="ch7.html#cb516-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(ifadmitted)), <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb516-9"><a href="ch7.html#cb516-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">mean</span>(ifadmitted), <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>, <span class="at">sep=</span><span class="st">&#39;&#39;</span>), </span>
<span id="cb516-10"><a href="ch7.html#cb516-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&quot;orange&quot;</span>,<span class="at">x =</span> <span class="fl">5.4</span>, <span class="at">y =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">5.7</span>, <span class="at">vjust =</span>  <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb516-11"><a href="ch7.html#cb516-11" aria-hidden="true" tabindex="-1"></a>  plot_theme)</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6lpmeelj311c0qomyy.jpg" /></p>
<p>结论：对于排名靠前的学校来说，托福成绩越高，平均录取率越高。</p>
</div>
<div id="硬件条件对于不同学位申请的影响" class="section level3 unnumbered">
<h3>硬件条件对于不同学位申请的影响</h3>
<p>申请博士与硕士需要做哪些准备呢？我们来探究硬件条件对于不同学位（type）申请的影响。硬件条件共包括6个变量：“research”、“paper”、“first”、“sci”、“rl”、“intern”和”exchange”，依次代表科研、论文、一作、 SCI论文、牛推、实习和交换。对这些变量取绝对值后，得到6个0-1变量，0代表不具备某种硬件条件，反之为1。</p>
<p>下面，绘制出硬件条件与申请学位的矩阵图。矩阵的每个元素代表对应学位的所有申请者中，提到自己具备对应硬件条件的人数比例。以（1, 1）元素为例，表示硕士申请者中，提到自己有过交换出国经历的比例为2.8%。注意：利用R包<code>data.table</code>和<code>reshape</code>能够简化矩阵计算；横纵坐标各水平的先后顺序与下图保持一致。从图中你能得到什么结论？</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="ch7.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb517-2"><a href="ch7.html#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 预处理</span></span>
<span id="cb517-3"><a href="ch7.html#cb517-3" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>first <span class="ot">&lt;-</span> <span class="fu">abs</span>(descriptive<span class="sc">$</span>first)</span>
<span id="cb517-4"><a href="ch7.html#cb517-4" aria-hidden="true" tabindex="-1"></a>descriptive<span class="sc">$</span>sci <span class="ot">&lt;-</span> <span class="fu">abs</span>(descriptive<span class="sc">$</span>sci)</span>
<span id="cb517-5"><a href="ch7.html#cb517-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-6"><a href="ch7.html#cb517-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 录取情况与硬件条件</span></span>
<span id="cb517-7"><a href="ch7.html#cb517-7" aria-hidden="true" tabindex="-1"></a>extra_offertype <span class="ot">&lt;-</span> descriptive[, <span class="fu">c</span>(<span class="st">&quot;rl&quot;</span>, <span class="st">&quot;intern&quot;</span>, <span class="st">&quot;research&quot;</span>, <span class="st">&quot;paper&quot;</span>,</span>
<span id="cb517-8"><a href="ch7.html#cb517-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;first&quot;</span>, <span class="st">&quot;sci&quot;</span>, <span class="st">&quot;exchange&quot;</span>, <span class="st">&quot;type&quot;</span>)]</span>
<span id="cb517-9"><a href="ch7.html#cb517-9" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">table</span>(extra_offertype<span class="sc">$</span>type) </span>
<span id="cb517-10"><a href="ch7.html#cb517-10" aria-hidden="true" tabindex="-1"></a>extra_offertype <span class="ot">&lt;-</span> <span class="fu">melt</span>(extra_offertype, <span class="at">id =</span> <span class="st">&quot;type&quot;</span>)      <span class="co"># 短表变长表</span></span>
<span id="cb517-11"><a href="ch7.html#cb517-11" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="fu">subset</span>(extra_offertype, extra_offertype<span class="sc">$</span>value <span class="sc">==</span> <span class="dv">1</span>)  </span>
<span id="cb517-12"><a href="ch7.html#cb517-12" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">table</span>(count<span class="sc">$</span>type, count<span class="sc">$</span>variable)                  <span class="co"># 申请硕博拥有某硬件条件的情况</span></span>
<span id="cb517-13"><a href="ch7.html#cb517-13" aria-hidden="true" tabindex="-1"></a>count_plot <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">rbind</span>(tab2[<span class="dv">1</span>, ]<span class="sc">/</span>tab1[<span class="dv">1</span>], tab2[<span class="dv">2</span>, ]<span class="sc">/</span>tab1[<span class="dv">2</span>],  tab2[<span class="dv">3</span>, ]<span class="sc">/</span>tab1[<span class="dv">3</span>]))  <span class="co"># 学位×硬件条件</span></span>
<span id="cb517-14"><a href="ch7.html#cb517-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(count_plot)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>)</span>
<span id="cb517-15"><a href="ch7.html#cb517-15" aria-hidden="true" tabindex="-1"></a>count_plot<span class="sc">$</span>X1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(count_plot<span class="sc">$</span>X1, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),        <span class="co"># 调整变量因子水平</span></span>
<span id="cb517-16"><a href="ch7.html#cb517-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;混合&quot;</span>, <span class="st">&quot;MS&quot;</span>, <span class="st">&quot;PhD&quot;</span>))</span>
<span id="cb517-17"><a href="ch7.html#cb517-17" aria-hidden="true" tabindex="-1"></a>count_plot<span class="sc">$</span>X2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(count_plot<span class="sc">$</span>X2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;research&quot;</span>,<span class="st">&quot;paper&quot;</span>,<span class="st">&quot;first&quot;</span>,</span>
<span id="cb517-18"><a href="ch7.html#cb517-18" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">&quot;sci&quot;</span>,<span class="st">&quot;rl&quot;</span>,<span class="st">&quot;intern&quot;</span>,<span class="st">&quot;exchange&quot;</span>),</span>
<span id="cb517-19"><a href="ch7.html#cb517-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;科研&quot;</span>, <span class="st">&quot;论文&quot;</span>, <span class="st">&quot;一作&quot;</span>, <span class="st">&quot;SCI论文&quot;</span>, <span class="st">&quot;牛推&quot;</span>, <span class="st">&quot;实习&quot;</span>, <span class="st">&quot;交换&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="ch7.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 绘制硬件条件与申请学位的矩阵图</span></span>
<span id="cb518-2"><a href="ch7.html#cb518-2" aria-hidden="true" tabindex="-1"></a>(matrix1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(count_plot, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> value, <span class="at">fill =</span> value)) <span class="sc">+</span> <span class="co"># 画图</span></span>
<span id="cb518-3"><a href="ch7.html#cb518-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span>    </span>
<span id="cb518-4"><a href="ch7.html#cb518-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">round</span>(count_plot<span class="sc">$</span>value, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>),</span>
<span id="cb518-5"><a href="ch7.html#cb518-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">family =</span> <span class="st">&quot;STHeiti&quot;</span>, <span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb518-6"><a href="ch7.html#cb518-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="st">&quot;count&quot;</span>, <span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;lightCoral&quot;</span>) <span class="sc">+</span></span>
<span id="cb518-7"><a href="ch7.html#cb518-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;申请学位&quot;</span>, <span class="at">y =</span> <span class="st">&quot;硬件条件&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> plot_theme)</span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6lpeqabj311c0qo416.jpg" /></p>
<p>结论：申请硕士实习更加重要，申请博士论文更加重要，而混合申请介于两者之间。</p>
</div>
</div>
<div id="实例分析-1" class="section level2 unnumbered">
<h2>7.5 实例分析</h2>
<div id="模型建立与选择" class="section level3 unnumbered">
<h3>模型建立与选择</h3>
<p>最后，我们将申请结果<code>offertype</code>作为因变量（录取=1，被拒=0），在训练集上建立逻辑回归模型，选取的变量如下：</p>
<pre><code>## [1] &quot;offertype ~ season + type + cross + rl + intern + research + paper + first + sci + exchange + CollegeRankTop50 + gpa_dis + toefl_dis&quot;</code></pre>
<p>对数据进行训练集与测试集的划分（0.8: 0.2）。以上述方程在训练集数据上建立逻辑回归模型，对模型进行变量选择（使用AIC准则），并对模型结果给出合理的解读。</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="ch7.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 抽取训练集</span></span>
<span id="cb520-2"><a href="ch7.html#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)    <span class="co"># 随机数种子</span></span>
<span id="cb520-3"><a href="ch7.html#cb520-3" aria-hidden="true" tabindex="-1"></a>nsample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">dim</span>(descriptive)[<span class="dv">1</span>], <span class="at">size =</span> <span class="fu">dim</span>(descriptive)[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">5</span>, <span class="at">replace =</span> F)</span>
<span id="cb520-4"><a href="ch7.html#cb520-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-5"><a href="ch7.html#cb520-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 重新划分训练集和测试集</span></span>
<span id="cb520-6"><a href="ch7.html#cb520-6" aria-hidden="true" tabindex="-1"></a>descriptive_train <span class="ot">&lt;-</span> descriptive[<span class="sc">-</span>nsample, ]  </span>
<span id="cb520-7"><a href="ch7.html#cb520-7" aria-hidden="true" tabindex="-1"></a>descriptive_test <span class="ot">&lt;-</span> descriptive[nsample, ]   </span>
<span id="cb520-8"><a href="ch7.html#cb520-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-9"><a href="ch7.html#cb520-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 建立逻辑回归模型</span></span>
<span id="cb520-10"><a href="ch7.html#cb520-10" aria-hidden="true" tabindex="-1"></a>myglm0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(formula, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> descriptive_train)  <span class="co"># 逻辑回归</span></span>
<span id="cb520-11"><a href="ch7.html#cb520-11" aria-hidden="true" tabindex="-1"></a>myglm <span class="ot">&lt;-</span> <span class="fu">step</span>(myglm0, <span class="at">trace =</span> F)     <span class="co"># AIC准则逐步回归</span></span>
<span id="cb520-12"><a href="ch7.html#cb520-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myglm)    <span class="co"># 查看回归结果</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = offertype ~ season + type + cross + intern + research + 
##     paper + sci + exchange + CollegeRankTop50 + gpa_dis + toefl_dis, 
##     family = binomial(), data = descriptive_train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1342  -1.3457   0.7548   0.8532   1.2424  
## 
## Coefficients:
##                       Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            1.13736    0.20887   5.445 5.17e-08 ***
## seasonSpring           0.60585    0.17403   3.481 0.000499 ***
## typeMS                -0.20011    0.20368  -0.982 0.325855    
## typePhD               -0.32947    0.21078  -1.563 0.118021    
## cross                 -0.16464    0.05809  -2.834 0.004594 ** 
## intern                -0.09656    0.06055  -1.595 0.110782    
## research              -0.20227    0.06707  -3.016 0.002564 ** 
## paper                  0.19493    0.08362   2.331 0.019748 *  
## sci                    0.19950    0.09938   2.008 0.044692 *  
## exchange               0.73152    0.14850   4.926 8.39e-07 ***
## CollegeRankTop50Top50 -0.56726    0.04850 -11.695  &lt; 2e-16 ***
## gpa_dis3.4~3.55        0.01246    0.05856   0.213 0.831454    
## gpa_dis3.55~3.7        0.23086    0.06219   3.712 0.000205 ***
## gpa_dis&gt;3.7            0.40755    0.06966   5.850 4.90e-09 ***
## toefl_dis98~102       -0.05808    0.06240  -0.931 0.351984    
## toefl_dis102~106       0.01725    0.06343   0.272 0.785626    
## toefl_dis&gt;106          0.18947    0.07032   2.695 0.007048 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 12122  on 9976  degrees of freedom
## Residual deviance: 11871  on 9960  degrees of freedom
##   (2750 observations deleted due to missingness)
## AIC: 11905
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>经过AIC准则选择后，模型留下了对申请结果影响显著的变量。根据模型形式的理解，逻辑回归模型的系数体现了因变量分别取1和0的可能性大小。例如，对于申请类型而言，其基准组为只申请硕士（MS），在控制其他变量不变的情况下，申请PhD的同学被录取的可能性比只申请硕士的同学录取可能性大；同样地，控制其他变量不变的情况下，有一作论文发表、海外交流经历的同学比没有相关经验的同学更易获得录取；从GPA和托福成绩这两个硬性指标来看，随着成绩区间档位的上升，获得录取的可能性增大，因此提高提高英语考试成绩是申请季稳中求胜的“法宝”。</p>
</div>
<div id="模型预测-1" class="section level3 unnumbered">
<h3>模型预测</h3>
<p>用逐步回归后的模型对测试集的申请结果进行预测，并利用R包pROC绘制出ROC曲线图，根据曲线对模型进行评价。</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="ch7.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb522-2"><a href="ch7.html#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 进行预测</span></span>
<span id="cb522-3"><a href="ch7.html#cb522-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(myglm, descriptive_test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="ch7.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family=</span><span class="st">&#39;STHeiti&#39;</span>)</span>
<span id="cb523-2"><a href="ch7.html#cb523-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制ROC曲线</span></span>
<span id="cb523-3"><a href="ch7.html#cb523-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(descriptive_test<span class="sc">$</span>offertype, pred, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb523-4"><a href="ch7.html#cb523-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">auc.polygon=</span><span class="cn">TRUE</span>, <span class="at">auc.polygon.col=</span><span class="st">&quot;#f6f6f6&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;FPR&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;TPR&quot;</span>, <span class="at">main =</span> <span class="st">&quot;预测ROC曲线&quot;</span>)  </span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gpb0rc7faoj30ih0bfglu.jpg" /></p>
<p>根据曲线的结果，AUC值（即ROC曲线下的面积）为0.585，说明该模型对数据的预测效果适中。</p>
</div>
</div>
<div id="习题答案-5" class="section level2 unnumbered">
<h2>习题答案</h2>
<div id="案例背景-1" class="section level3 unnumbered">
<h3>案例背景</h3>
<p>社交电商在运营中有一个非常重要的工作是留存客户，通过社交电商平台获取用户和积累了大量的老客户以后，可以专门针对会员建立会员群，以提升这部分群体的粘性和复购率，帮助社交电商平台提升销量。为了探究影响客户流失的因素，以客户是否流失为因变量，建立一套系统的客户流失预警模型，数据来自国内某社交电商平台。建模时使用sampledata.csv，预测时使用preddata.csv，所有的自变量来自当月，因变量（是否流失）来自下一个月，具体的变量介绍如下表所示。</p>
<p><img src="pics/HW_dataintro.png" /></p>
</div>
<div id="题目-7.2" class="section level3 unnumbered">
<h3>题目 7.2</h3>
<div id="数据读入与概览" class="section level4 unnumbered">
<h4>数据读入与概览</h4>
<p>读入数据<code>sampledata.csv</code>和<code>preddata.csv</code>，分别命名为<code>trainset</code>和<code>testset</code>，并用<code>summary</code>函数展示训练集数据的情况。</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="ch7.html#cb524-1" aria-hidden="true" tabindex="-1"></a>trainset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/sampledata.csv&quot;</span>, <span class="at">fileEncoding =</span> <span class="st">&quot;utf-8&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb524-2"><a href="ch7.html#cb524-2" aria-hidden="true" tabindex="-1"></a>testset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/preddata.csv&quot;</span>, <span class="at">fileEncoding =</span> <span class="st">&quot;utf-8&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb524-3"><a href="ch7.html#cb524-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-4"><a href="ch7.html#cb524-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trainset)  <span class="do">## 数据概览</span></span></code></pre></div>
<pre><code>##        ID            tenure          expense            degree           tightness         entropy         chgexpense      
##  Min.   :    1   Min.   : 163.0   Min.   : -3.378   Min.   : -0.4319   Min.   :-2.583   Min.   :0.4846   Min.   :-0.79261  
##  1st Qu.:12088   1st Qu.: 535.4   1st Qu.: 97.076   1st Qu.: 31.2269   1st Qu.: 5.397   1st Qu.:2.4177   1st Qu.:-0.07968  
##  Median :24281   Median : 990.1   Median :134.250   Median : 54.6392   Median : 7.964   Median :3.0005   Median : 0.00000  
##  Mean   :24224   Mean   :1256.1   Mean   :157.270   Mean   : 64.8805   Mean   : 9.231   Mean   :2.9491   Mean   :-0.01584  
##  3rd Qu.:36348   3rd Qu.:1634.4   3rd Qu.:201.157   3rd Qu.: 88.6146   3rd Qu.:11.645   3rd Qu.:3.5461   3rd Qu.: 0.03222  
##  Max.   :48393   Max.   :4475.9   Max.   :437.791   Max.   :214.9449   Max.   :32.255   Max.   :5.0324   Max.   : 0.79717  
##    chgdegree             churn        
##  Min.   :-0.992063   Min.   :0.00000  
##  1st Qu.:-0.159091   1st Qu.:0.00000  
##  Median :-0.009615   Median :0.00000  
##  Mean   : 0.011054   Mean   :0.03147  
##  3rd Qu.: 0.153846   3rd Qu.:0.00000  
##  Max.   : 1.187500   Max.   :1.00000</code></pre>
</div>
<div id="模型建立与解读" class="section level4 unnumbered">
<h4>模型建立与解读</h4>
<p>将因变量<code>churn</code>转换为因子型变量，建立逻辑回归模型，输出模型的结果并对结果进行解读。</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="ch7.html#cb526-1" aria-hidden="true" tabindex="-1"></a>trainset<span class="sc">$</span>churn <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(trainset<span class="sc">$</span>churn)  <span class="do">## 因变量转换为因子型</span></span>
<span id="cb526-2"><a href="ch7.html#cb526-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(churn <span class="sc">~</span> tenure<span class="sc">+</span>expense<span class="sc">+</span>degree<span class="sc">+</span>tightness<span class="sc">+</span>entropy<span class="sc">+</span>chgdegree<span class="sc">+</span>chgexpense, </span>
<span id="cb526-3"><a href="ch7.html#cb526-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), <span class="at">data =</span> trainset)  <span class="do">## 拟合逻辑回归模型</span></span>
<span id="cb526-4"><a href="ch7.html#cb526-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)  <span class="do">## 输出模型估计结果</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = churn ~ tenure + expense + degree + tightness + 
##     entropy + chgdegree + chgexpense, family = binomial(link = logit), 
##     data = trainset)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.5980  -0.2725  -0.2387  -0.2096   3.0885  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.958e+00  1.604e-01 -12.212  &lt; 2e-16 ***
## tenure      -1.263e-04  3.350e-05  -3.770 0.000163 ***
## expense     -8.968e-04  3.696e-04  -2.427 0.015235 *  
## degree       7.288e-05  1.274e-03   0.057 0.954397    
## tightness   -2.460e-02  5.377e-03  -4.575 4.76e-06 ***
## entropy     -3.471e-01  6.306e-02  -5.504 3.71e-08 ***
## chgdegree   -6.191e-01  9.919e-02  -6.241 4.34e-10 ***
## chgexpense  -3.163e-01  1.399e-01  -2.261 0.023768 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 12449  on 44516  degrees of freedom
## Residual deviance: 12207  on 44509  degrees of freedom
## AIC: 12223
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>根据建模的结果，可以看出，在保持其他变量不变的情况下，用户的在网时长越长，其流失的可能性就越低；当月的花费越高，流失的可能性越低；用户的联系强度越高，流失的可能性也越低。</p>
</div>
<div id="模型预测与评估" class="section level4 unnumbered">
<h4>模型预测与评估</h4>
<p>将任务二中的参数估计结果应用到<code>predata</code>中，给出<code>predata</code>中每个用户预测的流失概率值，绘制预测的ROC曲线，并计算对应的AUC值。</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="ch7.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb528-2"><a href="ch7.html#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 将模型结果应用到新的数据集上</span></span>
<span id="cb528-3"><a href="ch7.html#cb528-3" aria-hidden="true" tabindex="-1"></a>fitted.results <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit,<span class="at">newdata =</span> testset, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb528-4"><a href="ch7.html#cb528-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 绘制ROC曲线 &amp; 计算AUC值</span></span>
<span id="cb528-5"><a href="ch7.html#cb528-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb528-6"><a href="ch7.html#cb528-6" aria-hidden="true" tabindex="-1"></a>testset<span class="sc">$</span>churn <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testset<span class="sc">$</span>churn)</span></code></pre></div>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="ch7.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family=</span><span class="st">&#39;STHeiti&#39;</span>)</span>
<span id="cb529-2"><a href="ch7.html#cb529-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(testset<span class="sc">$</span>churn, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb529-3"><a href="ch7.html#cb529-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">auc.polygon=</span><span class="cn">TRUE</span>, <span class="at">auc.polygon.col=</span><span class="st">&quot;#f6f6f6&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;特异度&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;敏感度&quot;</span>,</span>
<span id="cb529-4"><a href="ch7.html#cb529-4" aria-hidden="true" tabindex="-1"></a>         fitted.results, <span class="at">main =</span> <span class="st">&quot;预测ROC曲线&quot;</span>)  </span></code></pre></div>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gky6lp77kpj311c0qoq4v.jpg" /></p>
<p>绘制ROC曲线如上所示，计算得到AUC值为0.617，模型在测试集上的预测表现较好。</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-ch7.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
