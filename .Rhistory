knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
### 1.创建数据框 ###
# 读入一个txt,csv等格式数据,即自成一个数据框
movie <- read.csv("./data/top250.csv", fileEncoding = "gbk", stringsAsFactors = F)
class(movie)
# 自己创建
director <- c("陈凯歌", "宫崎骏", "李廷香","詹姆斯·卡梅隆", "刘镇伟", "周星驰", "李安", "姜文", "张艺谋", "吴宇森","岩井俊二", "王家卫", "陈可辛"  )
birthyear <- c(1952,1941,1964,1954,1952,1962,1954,1963,1950,1946,1963,1958,1962)
gender <- c("男", "男", "女", "男", "男", "男", "男", "男", "男", "男", "男", "男", "男")
directors <- data.frame(director, birthyear, gender); head(directors)
### 2.变形--长宽表互换 ###
# install.packages(reshape)
library(reshape)
# install.packages(reshape2)
library(reshape2)
## (1) 宽表变长表 ##
mWide = data.frame(Name = c("A", "B"), Type = c("喜剧", "动作"),
GF2018 = c(6.5, 8.0), GF2019 = c(7.0, 7.5), GF2020 = c(8.1, 7.3))
# 由于构造数据框时列名不可以为纯数字，在数字前添加GF
# 将列名中的GF去掉
colnames(mWide)[3:5] = gsub("GF", "", colnames(mWide)[3:5])
mWide #查看原表
(mLong = melt(mWide, id.vars = c("Name", "Type"), variable_name = "Year"))
## (2) 长表变宽表 ##
# 将列Year从字符型变成数值型
#mLong$Year = as.numeric(mLong$Year)
# 长表变宽表
dcast(mLong, Name + Type ~ Year)
?melt
(mLong = melt(mWide, id.vars = c("Name", "Type"), variable_name = "Year"))
(mLong = melt(mWide, id.vars = c("Name", "Type"), variable.name = "Year"))
